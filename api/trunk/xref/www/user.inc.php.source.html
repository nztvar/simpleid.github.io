<!DOCTYPE html>
<html>
<head>
    <title>PHPXRef 0.7.1 : SimpleID : /www/user.inc.php source</title>
    <link rel="stylesheet" href="../xref.css" type="text/css">
    <link rel="stylesheet" href="../xref-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
</head>
<body>
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of SimpleID</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Mon Apr  6 15:06:20 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='www';
filename='user.inc.php.source.html';
cookiekey='simpleid';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/www/</a> -> <a href="user.inc.php.html">user.inc.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="user.inc.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="user.inc.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  <span class="comment">/*</span>
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment"> * SimpleID</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> *</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * Copyright (C) Kelvin Mo 2007-8</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> *</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> * Includes code Drupal OpenID module (http://drupal.org/project/openid)</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * Rowan Kerr &lt;rowan@standardinteractive.com&gt;</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * James Walker &lt;james@bryght.com&gt;</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> *</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * Copyright (C) Rowan Kerr and James Walker</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> *</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * This program is free software; you can redistribute it and/or</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> * modify it under the terms of the GNU General Public</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> * License as published by the Free Software Foundation; either</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> * version 2 of the License, or (at your option) any later version.</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> *</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> * General Public License for more details.</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> *</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> * You should have received a copy of the GNU General Public</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> * License along with this program; if not, write to the Free</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> * Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * </span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> * $Id$</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> */</span>
<a name="l29"><span class="linenum">  29</span></a>  
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment">/**</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * User functions.</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> *</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * @package simpleid</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * @filesource</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> */</span>
<a name="l36"><span class="linenum">  36</span></a>   
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment">/**</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> * The time the nonce used in the login process will last.</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> */</span>
<a name="l40"><span class="linenum">  40</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SIMPLEID_LOGIN_NONCE_EXPIRES_IN')" href="../_constants/SIMPLEID_LOGIN_NONCE_EXPIRES_IN.html" onMouseOver="constPopup(event,'SIMPLEID_LOGIN_NONCE_EXPIRES_IN')">SIMPLEID_LOGIN_NONCE_EXPIRES_IN</a>', 3600);
<a name="l41"><span class="linenum">  41</span></a>  
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">/**</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> * The time (in seconds) the auto login cookie will last.  This is currently</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment"> * set as 2 weeks.</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment"> */</span>
<a name="l46"><span class="linenum">  46</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('<a class="constant" onClick="logConstant('SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN')" href="../_constants/SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN.html" onMouseOver="constPopup(event,'SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN')">SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN</a>', 1209600);
<a name="l47"><span class="linenum">  47</span></a>  
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">/**</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment"> * This variable holds data on the currently logged-in user.  If the user is</span>
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment"> * not logged in, this variable is NULL.</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment"> *</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment"> * @global array $user</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment"> */</span>
<a name="l54"><span class="linenum">  54</span></a>  <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = NULL;
<a name="l55"><span class="linenum">  55</span></a>  
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment">/**</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment"> * Initialises the user system.  Loads data for the currently logged-in user,</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment"> * if any.</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment"> *</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment"> * @param string $q the SimpleID command, if any</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment"> */</span>
<a name="l62"><span class="linenum">  62</span></a>  function <a class="function" onClick="logFunction('user_init')" href="../_functions/user_init.html" onMouseOver="funcPopup(event,'user_init')">user_init</a>(<a class="var it146" onMouseOver="hilite(146)" onMouseOut="lolite()" onClick="logVariable('q')" href="../_variables/q.html">$q</a> = NULL) {
<a name="l63"><span class="linenum">  63</span></a>      global <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l64"><span class="linenum">  64</span></a>      global <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>;
<a name="l65"><span class="linenum">  65</span></a>      
<a name="l66"><span class="linenum">  66</span></a>      <a class="function" onClick="logFunction('log_debug')" href="../_functions/log_debug.html" onMouseOver="funcPopup(event,'log_debug')">log_debug</a>('user_init');
<a name="l67"><span class="linenum">  67</span></a>      
<a name="l68"><span class="linenum">  68</span></a>      <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = NULL;
<a name="l69"><span class="linenum">  69</span></a>      
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment">    // session_name() has to be called before session_set_cookie_params()</span>
<a name="l71"><span class="linenum">  71</span></a>      <a class="phpfunction" onClick="logFunction('session_name')" href="../_functions/session_name.html" onMouseOver="phpfuncPopup(event,'session_name')">session_name</a>(<a class="function" onClick="logFunction('simpleid_cookie_name')" href="../_functions/simpleid_cookie_name.html" onMouseOver="funcPopup(event,'simpleid_cookie_name')">simpleid_cookie_name</a>('sess'));
<a name="l72"><span class="linenum">  72</span></a>      
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment">    // Note the last parameter (httponly) requires PHP 5.2</span>
<a name="l74"><span class="linenum">  74</span></a>      <a class="phpfunction" onClick="logFunction('session_set_cookie_params')" href="../_functions/session_set_cookie_params.html" onMouseOver="phpfuncPopup(event,'session_set_cookie_params')">session_set_cookie_params</a>(0, <a class="function" onClick="logFunction('get_base_path')" href="../_functions/get_base_path.html" onMouseOver="funcPopup(event,'get_base_path')">get_base_path</a>(), <a class="phpfunction" onClick="logFunction('ini_get')" href="../_functions/ini_get.html" onMouseOver="phpfuncPopup(event,'ini_get')">ini_get</a>('session.cookie_domain'), false, true);
<a name="l75"><span class="linenum">  75</span></a>      <a class="phpfunction" onClick="logFunction('session_start')" href="../_functions/session_start.html" onMouseOver="phpfuncPopup(event,'session_start')">session_start</a>();
<a name="l76"><span class="linenum">  76</span></a>      
<a name="l77"><span class="linenum">  77</span></a>      if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['user']) &amp;&amp; (<a class="function" onClick="logFunction('cache_get')" href="../_functions/cache_get.html" onMouseOver="funcPopup(event,'cache_get')">cache_get</a>('user', <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['user']) == <a class="phpfunction" onClick="logFunction('session_id')" href="../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>())) {
<a name="l78"><span class="linenum">  78</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('user_load')" href="../_functions/user_load.html" onMouseOver="funcPopup(event,'user_load')">user_load</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['user']);
<a name="l79"><span class="linenum">  79</span></a>          
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment">        // If user has just been actively been authenticated in the previous request, then we</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment">        // make it as actively authenticated in this request.</span>
<a name="l82"><span class="linenum">  82</span></a>          if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['user_auth_active']) &amp;&amp; <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['user_auth_active']) {
<a name="l83"><span class="linenum">  83</span></a>              <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['auth_active'] = true;
<a name="l84"><span class="linenum">  84</span></a>              <a class="phpfunction" onClick="logFunction('unset')" href="../_functions/unset.html" onMouseOver="phpfuncPopup(event,'unset')">unset</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['user_auth_active']);
<a name="l85"><span class="linenum">  85</span></a>          }
<a name="l86"><span class="linenum">  86</span></a>      } else {
<a name="l87"><span class="linenum">  87</span></a>          if ((<a class="var it146" onMouseOver="hilite(146)" onMouseOut="lolite()" onClick="logVariable('q')" href="../_variables/q.html">$q</a> == 'login') || (<a class="var it146" onMouseOver="hilite(146)" onMouseOut="lolite()" onClick="logVariable('q')" href="../_variables/q.html">$q</a> == 'logout')) return;
<a name="l88"><span class="linenum">  88</span></a>          <a class="function" onClick="logFunction('user_auto_login')" href="../_functions/user_auto_login.html" onMouseOver="funcPopup(event,'user_auto_login')">user_auto_login</a>();
<a name="l89"><span class="linenum">  89</span></a>      }
<a name="l90"><span class="linenum">  90</span></a>  }
<a name="l91"><span class="linenum">  91</span></a>  
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment">/**</span>
<a name="l93"><span class="linenum">  93</span></a>  <span class="comment"> * Attempts to automatically login using credentials presented by the user agent.</span>
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment"> *</span>
<a name="l95"><span class="linenum">  95</span></a>  <span class="comment"> * The user agent may present various credentials as part of its request.  These</span>
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment"> * may include cookies and SSL client certificates.  This function calls the</span>
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment"> * {@link hook_user_auto_login()} hook of enabled extensions to see if any</span>
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment"> * of these credentials can be used to automatically login a user.</span>
<a name="l99"><span class="linenum">  99</span></a>  <span class="comment"> */</span>
<a name="l100"><span class="linenum"> 100</span></a>  function <a class="function" onClick="logFunction('user_auto_login')" href="../_functions/user_auto_login.html" onMouseOver="funcPopup(event,'user_auto_login')">user_auto_login</a>() {
<a name="l101"><span class="linenum"> 101</span></a>      global <a class="var it168" onMouseOver="hilite(168)" onMouseOut="lolite()" onClick="logVariable('simpleid_extensions')" href="../_variables/simpleid_extensions.html">$simpleid_extensions</a>;
<a name="l102"><span class="linenum"> 102</span></a>      
<a name="l103"><span class="linenum"> 103</span></a>      <a class="var it169" onMouseOver="hilite(169)" onMouseOut="lolite()" onClick="logVariable('extensions')" href="../_variables/extensions.html">$extensions</a> = <a class="var it168" onMouseOver="hilite(168)" onMouseOut="lolite()" onClick="logVariable('simpleid_extensions')" href="../_variables/simpleid_extensions.html">$simpleid_extensions</a>;
<a name="l104"><span class="linenum"> 104</span></a>      
<a name="l105"><span class="linenum"> 105</span></a>      if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>('user_cookieauth', <a class="var it169" onMouseOver="hilite(169)" onMouseOut="lolite()" onClick="logVariable('extensions')" href="../_variables/extensions.html">$extensions</a>)) <a class="var it169" onMouseOver="hilite(169)" onMouseOut="lolite()" onClick="logVariable('extensions')" href="../_variables/extensions.html">$extensions</a>[] = 'user_cookieauth';
<a name="l106"><span class="linenum"> 106</span></a>      
<a name="l107"><span class="linenum"> 107</span></a>      foreach (<a class="var it169" onMouseOver="hilite(169)" onMouseOut="lolite()" onClick="logVariable('extensions')" href="../_variables/extensions.html">$extensions</a> as <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('extension')" href="../_variables/extension.html">$extension</a>) {
<a name="l108"><span class="linenum"> 108</span></a>          <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a> = <a class="function" onClick="logFunction('extension_invoke')" href="../_functions/extension_invoke.html" onMouseOver="funcPopup(event,'extension_invoke')">extension_invoke</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('extension')" href="../_variables/extension.html">$extension</a>, 'user_auto_login');
<a name="l109"><span class="linenum"> 109</span></a>          if (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a> != NULL) {
<a name="l110"><span class="linenum"> 110</span></a>              <a class="function" onClick="logFunction('_user_login')" href="../_functions/_user_login.html" onMouseOver="funcPopup(event,'_user_login')">_user_login</a>(<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>);
<a name="l111"><span class="linenum"> 111</span></a>          }
<a name="l112"><span class="linenum"> 112</span></a>      }
<a name="l113"><span class="linenum"> 113</span></a>  }
<a name="l114"><span class="linenum"> 114</span></a>  
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment">/**</span>
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment"> * Loads user data for a specified user name.</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment"> *</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment"> * @param string $uid the name of the user to load</span>
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment"> * @return mixed data for the specified user, or NULL if the user name does not</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment"> * exist</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment"> * @see user_load_from_identity()</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment"> */</span>
<a name="l123"><span class="linenum"> 123</span></a>  function <a class="function" onClick="logFunction('user_load')" href="../_functions/user_load.html" onMouseOver="funcPopup(event,'user_load')">user_load</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>) {
<a name="l124"><span class="linenum"> 124</span></a>      if (<a class="function" onClick="logFunction('store_user_exists')" href="../_functions/store_user_exists.html" onMouseOver="funcPopup(event,'store_user_exists')">store_user_exists</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>)) {
<a name="l125"><span class="linenum"> 125</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('store_user_load')" href="../_functions/store_user_load.html" onMouseOver="funcPopup(event,'store_user_load')">store_user_load</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>);
<a name="l126"><span class="linenum"> 126</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;uid&quot;] = <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>;
<a name="l127"><span class="linenum"> 127</span></a>          
<a name="l128"><span class="linenum"> 128</span></a>          if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;identity&quot;])) {
<a name="l129"><span class="linenum"> 129</span></a>              <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;local_identity&quot;] = true;
<a name="l130"><span class="linenum"> 130</span></a>          } else {
<a name="l131"><span class="linenum"> 131</span></a>              <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;identity&quot;] = <a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>('user/' . <a class="phpfunction" onClick="logFunction('rawurlencode')" href="../_functions/rawurlencode.html" onMouseOver="phpfuncPopup(event,'rawurlencode')">rawurlencode</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>));
<a name="l132"><span class="linenum"> 132</span></a>              <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;local_identity&quot;] = false;
<a name="l133"><span class="linenum"> 133</span></a>          }
<a name="l134"><span class="linenum"> 134</span></a>          
<a name="l135"><span class="linenum"> 135</span></a>          return <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l136"><span class="linenum"> 136</span></a>      } else {
<a name="l137"><span class="linenum"> 137</span></a>          return NULL;
<a name="l138"><span class="linenum"> 138</span></a>      }
<a name="l139"><span class="linenum"> 139</span></a>  }
<a name="l140"><span class="linenum"> 140</span></a>  
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment">/**</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment"> * Loads user data for a specified OpenID Identity URI.</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment"> *</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment"> * @param string $identity the Identity URI of the user to load</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment"> * @return mixed data for the specified user, or NULL if the user name does not</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment"> * exist</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment"> * @see user_load()</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment"> */</span>
<a name="l149"><span class="linenum"> 149</span></a>  function <a class="function" onClick="logFunction('user_load_from_identity')" href="../_functions/user_load_from_identity.html" onMouseOver="funcPopup(event,'user_load_from_identity')">user_load_from_identity</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('identity')" href="../_variables/identity.html">$identity</a>) {
<a name="l150"><span class="linenum"> 150</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a> = <a class="function" onClick="logFunction('store_get_uid')" href="../_functions/store_get_uid.html" onMouseOver="funcPopup(event,'store_get_uid')">store_get_uid</a>(<a class="var it3" onMouseOver="hilite(3)" onMouseOut="lolite()" onClick="logVariable('identity')" href="../_variables/identity.html">$identity</a>);
<a name="l151"><span class="linenum"> 151</span></a>      if (<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a> !== NULL) return <a class="function" onClick="logFunction('user_load')" href="../_functions/user_load.html" onMouseOver="funcPopup(event,'user_load')">user_load</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>);
<a name="l152"><span class="linenum"> 152</span></a>      
<a name="l153"><span class="linenum"> 153</span></a>      return NULL;
<a name="l154"><span class="linenum"> 154</span></a>  }
<a name="l155"><span class="linenum"> 155</span></a>  
<a name="l156"><span class="linenum"> 156</span></a>  <span class="comment">/**</span>
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment"> * Stores user data for a specified user name.</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment"> *</span>
<a name="l159"><span class="linenum"> 159</span></a>  <span class="comment"> * @param array $user the user to save</span>
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment"> */</span>
<a name="l161"><span class="linenum"> 161</span></a>  function <a class="function" onClick="logFunction('user_save')" href="../_functions/user_save.html" onMouseOver="funcPopup(event,'user_save')">user_save</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>) {
<a name="l162"><span class="linenum"> 162</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a> = <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['uid'];
<a name="l163"><span class="linenum"> 163</span></a>      <a class="function" onClick="logFunction('store_user_save')" href="../_functions/store_user_save.html" onMouseOver="funcPopup(event,'store_user_save')">store_user_save</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>, <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('uid', 'identity', 'pass'));
<a name="l164"><span class="linenum"> 164</span></a>  }
<a name="l165"><span class="linenum"> 165</span></a>  
<a name="l166"><span class="linenum"> 166</span></a>  <span class="comment">/**</span>
<a name="l167"><span class="linenum"> 167</span></a>  <span class="comment"> * Attempts to log in a user, using the user name and password specified in the</span>
<a name="l168"><span class="linenum"> 168</span></a>  <span class="comment"> * HTTP request.</span>
<a name="l169"><span class="linenum"> 169</span></a>  <span class="comment"> */</span>
<a name="l170"><span class="linenum"> 170</span></a>  function <a class="function" onClick="logFunction('user_login')" href="../_functions/user_login.html" onMouseOver="funcPopup(event,'user_login')">user_login</a>() {
<a name="l171"><span class="linenum"> 171</span></a>      global <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>;
<a name="l172"><span class="linenum"> 172</span></a>      
<a name="l173"><span class="linenum"> 173</span></a>  <span class="comment">    // If the user is already logged in, return</span>
<a name="l174"><span class="linenum"> 174</span></a>      if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['uid'])) <a class="function" onClick="logFunction('openid_indirect_response')" href="../_functions/openid_indirect_response.html" onMouseOver="funcPopup(event,'openid_indirect_response')">openid_indirect_response</a>(<a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>(), '');
<a name="l175"><span class="linenum"> 175</span></a>      
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment">    // Require HTTPS or return an error</span>
<a name="l177"><span class="linenum"> 177</span></a>      <a class="function" onClick="logFunction('check_https')" href="../_functions/check_https.html" onMouseOver="funcPopup(event,'check_https')">check_https</a>('error', true);
<a name="l178"><span class="linenum"> 178</span></a>      
<a name="l179"><span class="linenum"> 179</span></a>      <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a> = (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>['destination'])) ? <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>['destination'] : '';
<a name="l180"><span class="linenum"> 180</span></a>      <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a> = (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>['s'])) ? <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>['s'] : '';
<a name="l181"><span class="linenum"> 181</span></a>      <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a> = (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['fixed_uid'])) ? <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['name'] : NULL;
<a name="l182"><span class="linenum"> 182</span></a>      <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a> = <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['mode'];
<a name="l183"><span class="linenum"> 183</span></a>      
<a name="l184"><span class="linenum"> 184</span></a>      <a class="var it55" onMouseOver="hilite(55)" onMouseOut="lolite()" onClick="logVariable('query')" href="../_variables/query.html">$query</a> = (<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>) ? 's=' . <a class="phpfunction" onClick="logFunction('rawurlencode')" href="../_functions/rawurlencode.html" onMouseOver="phpfuncPopup(event,'rawurlencode')">rawurlencode</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>) : '';
<a name="l185"><span class="linenum"> 185</span></a>      
<a name="l186"><span class="linenum"> 186</span></a>      if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['op']) &amp;&amp; <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['op'] == <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Cancel')) {
<a name="l187"><span class="linenum"> 187</span></a>          global <a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('version')" href="../_variables/version.html">$version</a>;
<a name="l188"><span class="linenum"> 188</span></a>          
<a name="l189"><span class="linenum"> 189</span></a>          <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('request')" href="../_variables/request.html">$request</a> = <a class="function" onClick="logFunction('unpickle')" href="../_functions/unpickle.html" onMouseOver="funcPopup(event,'unpickle')">unpickle</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>);
<a name="l190"><span class="linenum"> 190</span></a>          <a class="var it41" onMouseOver="hilite(41)" onMouseOut="lolite()" onClick="logVariable('version')" href="../_variables/version.html">$version</a> = <a class="function" onClick="logFunction('openid_get_version')" href="../_functions/openid_get_version.html" onMouseOver="funcPopup(event,'openid_get_version')">openid_get_version</a>(<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('request')" href="../_variables/request.html">$request</a>);
<a name="l191"><span class="linenum"> 191</span></a>          
<a name="l192"><span class="linenum"> 192</span></a>          if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('request')" href="../_variables/request.html">$request</a>['openid.return_to'])) {
<a name="l193"><span class="linenum"> 193</span></a>              <a class="var it73" onMouseOver="hilite(73)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../_variables/return_to.html">$return_to</a> = <a class="var it2" onMouseOver="hilite(2)" onMouseOut="lolite()" onClick="logVariable('request')" href="../_variables/request.html">$request</a>['openid.return_to'];
<a name="l194"><span class="linenum"> 194</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('response')" href="../_variables/response.html">$response</a> = <a class="function" onClick="logFunction('simpleid_checkid_error')" href="../_functions/simpleid_checkid_error.html" onMouseOver="funcPopup(event,'simpleid_checkid_error')">simpleid_checkid_error</a>(FALSE);
<a name="l195"><span class="linenum"> 195</span></a>              <a class="function" onClick="logFunction('simpleid_assertion_response')" href="../_functions/simpleid_assertion_response.html" onMouseOver="funcPopup(event,'simpleid_assertion_response')">simpleid_assertion_response</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('response')" href="../_variables/response.html">$response</a>, <a class="var it73" onMouseOver="hilite(73)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../_variables/return_to.html">$return_to</a>);
<a name="l196"><span class="linenum"> 196</span></a>          } else {
<a name="l197"><span class="linenum"> 197</span></a>              <a class="function" onClick="logFunction('indirect_fatal_error')" href="../_functions/indirect_fatal_error.html" onMouseOver="funcPopup(event,'indirect_fatal_error')">indirect_fatal_error</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Login cancelled without a proper OpenID request.'));
<a name="l198"><span class="linenum"> 198</span></a>          }
<a name="l199"><span class="linenum"> 199</span></a>          return;
<a name="l200"><span class="linenum"> 200</span></a>      }
<a name="l201"><span class="linenum"> 201</span></a>  
<a name="l202"><span class="linenum"> 202</span></a>      if (!<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['mode']) || !<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['mode'], <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('credentials', 'otp'))) {
<a name="l203"><span class="linenum"> 203</span></a>          <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('SimpleID detected a potential security attack on your log in.  Please log in again.'));
<a name="l204"><span class="linenum"> 204</span></a>          <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a>);
<a name="l205"><span class="linenum"> 205</span></a>          return;
<a name="l206"><span class="linenum"> 206</span></a>      }
<a name="l207"><span class="linenum"> 207</span></a>  
<a name="l208"><span class="linenum"> 208</span></a>      if (!<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce'])) {
<a name="l209"><span class="linenum"> 209</span></a>          if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['destination'])) {
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">            // User came from a log in form.</span>
<a name="l211"><span class="linenum"> 211</span></a>              <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('You seem to be attempting to log in from another web page.  You must use this page to log in.'));
<a name="l212"><span class="linenum"> 212</span></a>          }
<a name="l213"><span class="linenum"> 213</span></a>          <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a>, <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>);
<a name="l214"><span class="linenum"> 214</span></a>          return;
<a name="l215"><span class="linenum"> 215</span></a>      }
<a name="l216"><span class="linenum"> 216</span></a>  
<a name="l217"><span class="linenum"> 217</span></a>      <a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> = <a class="phpfunction" onClick="logFunction('strtotime')" href="../_functions/strtotime.html" onMouseOver="phpfuncPopup(event,'strtotime')">strtotime</a>(<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce'], 0, 20));
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">    // Some old versions of PHP does not recognise the T in the ISO 8601 date.  We may need to convert the T to a space</span>
<a name="l219"><span class="linenum"> 219</span></a>      if ((<a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> == -1) || (<a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> === FALSE)) <a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> = <a class="phpfunction" onClick="logFunction('strtotime')" href="../_functions/strtotime.html" onMouseOver="phpfuncPopup(event,'strtotime')">strtotime</a>(<a class="phpfunction" onClick="logFunction('strtr')" href="../_functions/strtr.html" onMouseOver="phpfuncPopup(event,'strtr')">strtr</a>(<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce'], 0, 20), 'T', ' '));
<a name="l220"><span class="linenum"> 220</span></a>      <a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a> = <a class="function" onClick="logFunction('cache_get')" href="../_functions/cache_get.html" onMouseOver="funcPopup(event,'cache_get')">cache_get</a>('user-nonce', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce']);
<a name="l221"><span class="linenum"> 221</span></a>      
<a name="l222"><span class="linenum"> 222</span></a>      if (!<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a>) {
<a name="l223"><span class="linenum"> 223</span></a>          <a class="function" onClick="logFunction('log_warn')" href="../_functions/log_warn.html" onMouseOver="funcPopup(event,'log_warn')">log_warn</a>('Login attempt: Nonce ' . <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce'] . ' not issued or is being reused.');
<a name="l224"><span class="linenum"> 224</span></a>          <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('SimpleID detected a potential security attack on your log in.  Please log in again.'));
<a name="l225"><span class="linenum"> 225</span></a>          <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a>, <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>);
<a name="l226"><span class="linenum"> 226</span></a>          return;
<a name="l227"><span class="linenum"> 227</span></a>      } elseif (<a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> &lt; <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - <a class="constant" onClick="logConstant('SIMPLEID_LOGIN_NONCE_EXPIRES_IN')" href="../_constants/SIMPLEID_LOGIN_NONCE_EXPIRES_IN.html" onMouseOver="constPopup(event,'SIMPLEID_LOGIN_NONCE_EXPIRES_IN')">SIMPLEID_LOGIN_NONCE_EXPIRES_IN</a>) {
<a name="l228"><span class="linenum"> 228</span></a>          <a class="function" onClick="logFunction('log_notice')" href="../_functions/log_notice.html" onMouseOver="funcPopup(event,'log_notice')">log_notice</a>('Login attempt: Nonce ' . <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce'] . ' expired.');
<a name="l229"><span class="linenum"> 229</span></a>          <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('The log in page has expired.  Please log in again.'));
<a name="l230"><span class="linenum"> 230</span></a>          <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a>, <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>);
<a name="l231"><span class="linenum"> 231</span></a>          return;
<a name="l232"><span class="linenum"> 232</span></a>      } elseif (<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a>['mode'] != <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>) {
<a name="l233"><span class="linenum"> 233</span></a>          <a class="function" onClick="logFunction('log_warn')" href="../_functions/log_warn.html" onMouseOver="funcPopup(event,'log_warn')">log_warn</a>('Login attempt: Mode saved with nonce ' . <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce'] . ' (' . <a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a>['mode'] . ') does not match ' . <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>);
<a name="l234"><span class="linenum"> 234</span></a>          <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('SimpleID detected a potential security attack on your log in.  Please log in again.'));
<a name="l235"><span class="linenum"> 235</span></a>          <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a>, <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>);
<a name="l236"><span class="linenum"> 236</span></a>      } else {
<a name="l237"><span class="linenum"> 237</span></a>          <a class="function" onClick="logFunction('cache_delete')" href="../_functions/cache_delete.html" onMouseOver="funcPopup(event,'cache_delete')">cache_delete</a>('user-nonce', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce']);
<a name="l238"><span class="linenum"> 238</span></a>      }
<a name="l239"><span class="linenum"> 239</span></a>  
<a name="l240"><span class="linenum"> 240</span></a>      switch (<a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>) {
<a name="l241"><span class="linenum"> 241</span></a>          case 'credentials':
<a name="l242"><span class="linenum"> 242</span></a>              if (!<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['name'])) <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['name'] = '';
<a name="l243"><span class="linenum"> 243</span></a>              if (!<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['pass'])) <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['pass'] = '';
<a name="l244"><span class="linenum"> 244</span></a>              
<a name="l245"><span class="linenum"> 245</span></a>              if ((<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['name'] == '') || (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['pass'] == '')) {
<a name="l246"><span class="linenum"> 246</span></a>                  if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['destination'])) {
<a name="l247"><span class="linenum"> 247</span></a>  <span class="comment">                    // User came from a log in form.</span>
<a name="l248"><span class="linenum"> 248</span></a>                      <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('You need to supply the user name and the password in order to log in.'));
<a name="l249"><span class="linenum"> 249</span></a>                  }
<a name="l250"><span class="linenum"> 250</span></a>                  if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce'])) <a class="function" onClick="logFunction('cache_delete')" href="../_functions/cache_delete.html" onMouseOver="funcPopup(event,'cache_delete')">cache_delete</a>('user-nonce', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce']);
<a name="l251"><span class="linenum"> 251</span></a>                  <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a>);
<a name="l252"><span class="linenum"> 252</span></a>                  return;
<a name="l253"><span class="linenum"> 253</span></a>              }
<a name="l254"><span class="linenum"> 254</span></a>  
<a name="l255"><span class="linenum"> 255</span></a>              if (<a class="function" onClick="logFunction('user_verify_credentials')" href="../_functions/user_verify_credentials.html" onMouseOver="funcPopup(event,'user_verify_credentials')">user_verify_credentials</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['name'], <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>) === false) {
<a name="l256"><span class="linenum"> 256</span></a>                  <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('The user name or password is not correct.'));
<a name="l257"><span class="linenum"> 257</span></a>                  <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a>);
<a name="l258"><span class="linenum"> 258</span></a>                  return;
<a name="l259"><span class="linenum"> 259</span></a>              }
<a name="l260"><span class="linenum"> 260</span></a>  
<a name="l261"><span class="linenum"> 261</span></a>              <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a> = <a class="function" onClick="logFunction('user_load')" href="../_functions/user_load.html" onMouseOver="funcPopup(event,'user_load')">user_load</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['name']);
<a name="l262"><span class="linenum"> 262</span></a>              if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>['otp']) &amp;&amp; (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>['otp']['type'] != 'recovery')) {
<a name="l263"><span class="linenum"> 263</span></a>                  <a class="function" onClick="logFunction('log_info')" href="../_functions/log_info.html" onMouseOver="funcPopup(event,'log_info')">log_info</a>('One time password required');
<a name="l264"><span class="linenum"> 264</span></a>                  <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>['uid'], 'otp');
<a name="l265"><span class="linenum"> 265</span></a>                  return;
<a name="l266"><span class="linenum"> 266</span></a>              }
<a name="l267"><span class="linenum"> 267</span></a>              break;
<a name="l268"><span class="linenum"> 268</span></a>          case 'otp':
<a name="l269"><span class="linenum"> 269</span></a>              if (!<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['otp']) || (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['otp'] == '')) {
<a name="l270"><span class="linenum"> 270</span></a>                  <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('You need to enter the verification code in order to log in.'));
<a name="l271"><span class="linenum"> 271</span></a>                  if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce'])) <a class="function" onClick="logFunction('cache_delete')" href="../_functions/cache_delete.html" onMouseOver="funcPopup(event,'cache_delete')">cache_delete</a>('user-nonce', <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['nonce']);
<a name="l272"><span class="linenum"> 272</span></a>                  <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a>['uid'], 'otp');
<a name="l273"><span class="linenum"> 273</span></a>                  return;
<a name="l274"><span class="linenum"> 274</span></a>              }
<a name="l275"><span class="linenum"> 275</span></a>  
<a name="l276"><span class="linenum"> 276</span></a>              <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a> = <a class="function" onClick="logFunction('user_load')" href="../_functions/user_load.html" onMouseOver="funcPopup(event,'user_load')">user_load</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a>['uid']);
<a name="l277"><span class="linenum"> 277</span></a>  
<a name="l278"><span class="linenum"> 278</span></a>              if (<a class="function" onClick="logFunction('user_verify_otp')" href="../_functions/user_verify_otp.html" onMouseOver="funcPopup(event,'user_verify_otp')">user_verify_otp</a>(<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>['otp'], <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['otp']) === false) {
<a name="l279"><span class="linenum"> 279</span></a>                  <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('The verification code is not correct.'));
<a name="l280"><span class="linenum"> 280</span></a>                  <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, <a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a>['uid'], 'otp');
<a name="l281"><span class="linenum"> 281</span></a>                  return;
<a name="l282"><span class="linenum"> 282</span></a>              }
<a name="l283"><span class="linenum"> 283</span></a>              <a class="function" onClick="logFunction('user_save')" href="../_functions/user_save.html" onMouseOver="funcPopup(event,'user_save')">user_save</a>(<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>); <span class="comment">// Save the drift</span>
<a name="l284"><span class="linenum"> 284</span></a>  
<a name="l285"><span class="linenum"> 285</span></a>              break;
<a name="l286"><span class="linenum"> 286</span></a>      }
<a name="l287"><span class="linenum"> 287</span></a>      
<a name="l288"><span class="linenum"> 288</span></a>      <a class="function" onClick="logFunction('_user_login')" href="../_functions/_user_login.html" onMouseOver="funcPopup(event,'_user_login')">_user_login</a>(<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>, true);
<a name="l289"><span class="linenum"> 289</span></a>      
<a name="l290"><span class="linenum"> 290</span></a>      <a class="function" onClick="logFunction('openid_indirect_response')" href="../_functions/openid_indirect_response.html" onMouseOver="funcPopup(event,'openid_indirect_response')">openid_indirect_response</a>(<a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it55" onMouseOver="hilite(55)" onMouseOut="lolite()" onClick="logVariable('query')" href="../_variables/query.html">$query</a>), '');
<a name="l291"><span class="linenum"> 291</span></a>  }
<a name="l292"><span class="linenum"> 292</span></a>  
<a name="l293"><span class="linenum"> 293</span></a>  <span class="comment">/**</span>
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment"> * Verifies a set of credentials for a specified user.</span>
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment"> *</span>
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment"> * A set of credentials comprises:</span>
<a name="l297"><span class="linenum"> 297</span></a>  <span class="comment"> *</span>
<a name="l298"><span class="linenum"> 298</span></a>  <span class="comment"> * - A user name</span>
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment"> * - Some kind of verifying information, such as a plaintext password, a hashed</span>
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment"> *   password (e.g. digest) or some other kind of identifying information.</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment"> *</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment"> * The user name is passed to this function using the $uid parameter.  The user</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment"> * name may or may not exist.  If the user name does not exist, this function</span>
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment"> * &lt;strong&gt;must&lt;/strong&gt; return false.</span>
<a name="l305"><span class="linenum"> 305</span></a>  <span class="comment"> *</span>
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment"> * The credentials are supplied as an array using the $credentials parameter.</span>
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment"> * Typically this array will be a subset of the $_POST superglobal passed to the</span>
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment"> * {@link user_login()} function.  Thus it will generally contain the keys 'pass' and</span>
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment"> * 'digest'.</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment"> *</span>
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment"> * This function calls the {@link hook_user_verify_credentials()} hook to </span>
<a name="l312"><span class="linenum"> 312</span></a>  <span class="comment"> * check whether the credentials supplied matches the credentials</span>
<a name="l313"><span class="linenum"> 313</span></a>  <span class="comment"> * for the specified user in the store.</span>
<a name="l314"><span class="linenum"> 314</span></a>  <span class="comment"> *</span>
<a name="l315"><span class="linenum"> 315</span></a>  <span class="comment"> * @param string $uid the name of the user to verify</span>
<a name="l316"><span class="linenum"> 316</span></a>  <span class="comment"> * @param array $credentials the credentials supplied by the browser</span>
<a name="l317"><span class="linenum"> 317</span></a>  <span class="comment"> * @return bool whether the credentials supplied matches those for the specified</span>
<a name="l318"><span class="linenum"> 318</span></a>  <span class="comment"> * user</span>
<a name="l319"><span class="linenum"> 319</span></a>  <span class="comment"> */</span>
<a name="l320"><span class="linenum"> 320</span></a>  function <a class="function" onClick="logFunction('user_verify_credentials')" href="../_functions/user_verify_credentials.html" onMouseOver="funcPopup(event,'user_verify_credentials')">user_verify_credentials</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>, <a class="var it33" onMouseOver="hilite(33)" onMouseOut="lolite()" onClick="logVariable('credentials')" href="../_variables/credentials.html">$credentials</a>) {
<a name="l321"><span class="linenum"> 321</span></a>      global <a class="var it168" onMouseOver="hilite(168)" onMouseOut="lolite()" onClick="logVariable('simpleid_extensions')" href="../_variables/simpleid_extensions.html">$simpleid_extensions</a>;
<a name="l322"><span class="linenum"> 322</span></a>      
<a name="l323"><span class="linenum"> 323</span></a>      <a class="var it169" onMouseOver="hilite(169)" onMouseOut="lolite()" onClick="logVariable('extensions')" href="../_variables/extensions.html">$extensions</a> = <a class="var it168" onMouseOver="hilite(168)" onMouseOut="lolite()" onClick="logVariable('simpleid_extensions')" href="../_variables/simpleid_extensions.html">$simpleid_extensions</a>;
<a name="l324"><span class="linenum"> 324</span></a>      
<a name="l325"><span class="linenum"> 325</span></a>      if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>('user_passauth', <a class="var it169" onMouseOver="hilite(169)" onMouseOut="lolite()" onClick="logVariable('extensions')" href="../_variables/extensions.html">$extensions</a>)) <a class="var it169" onMouseOver="hilite(169)" onMouseOut="lolite()" onClick="logVariable('extensions')" href="../_variables/extensions.html">$extensions</a>[] = 'user_passauth';
<a name="l326"><span class="linenum"> 326</span></a>      
<a name="l327"><span class="linenum"> 327</span></a>      foreach (<a class="var it169" onMouseOver="hilite(169)" onMouseOut="lolite()" onClick="logVariable('extensions')" href="../_variables/extensions.html">$extensions</a> as <a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('extension')" href="../_variables/extension.html">$extension</a>) {
<a name="l328"><span class="linenum"> 328</span></a>          <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = <a class="function" onClick="logFunction('extension_invoke')" href="../_functions/extension_invoke.html" onMouseOver="funcPopup(event,'extension_invoke')">extension_invoke</a>(<a class="var it170" onMouseOver="hilite(170)" onMouseOut="lolite()" onClick="logVariable('extension')" href="../_variables/extension.html">$extension</a>, 'user_verify_credentials', <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>, <a class="var it33" onMouseOver="hilite(33)" onMouseOut="lolite()" onClick="logVariable('credentials')" href="../_variables/credentials.html">$credentials</a>);
<a name="l329"><span class="linenum"> 329</span></a>          if (<a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> === true) {
<a name="l330"><span class="linenum"> 330</span></a>              return true;
<a name="l331"><span class="linenum"> 331</span></a>          }
<a name="l332"><span class="linenum"> 332</span></a>      }
<a name="l333"><span class="linenum"> 333</span></a>      
<a name="l334"><span class="linenum"> 334</span></a>      return false;
<a name="l335"><span class="linenum"> 335</span></a>  }
<a name="l336"><span class="linenum"> 336</span></a>  
<a name="l337"><span class="linenum"> 337</span></a>  <span class="comment">/**</span>
<a name="l338"><span class="linenum"> 338</span></a>  <span class="comment"> * Verifies a one time password (OTP) specified by the user.</span>
<a name="l339"><span class="linenum"> 339</span></a>  <span class="comment"> *</span>
<a name="l340"><span class="linenum"> 340</span></a>  <span class="comment"> * This function compares an OTP supplied by a user with the OTP</span>
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment"> * calculated based on the current time and the parameters of the</span>
<a name="l342"><span class="linenum"> 342</span></a>  <span class="comment"> * algorithm.  The parameters, such as the secret key, are supplied</span>
<a name="l343"><span class="linenum"> 343</span></a>  <span class="comment"> * using in $params.  These parameters are typically stored for each</span>
<a name="l344"><span class="linenum"> 344</span></a>  <span class="comment"> * user in the user store.</span>
<a name="l345"><span class="linenum"> 345</span></a>  <span class="comment"> *</span>
<a name="l346"><span class="linenum"> 346</span></a>  <span class="comment"> * To allow for clocks going out of sync, the current time will be</span>
<a name="l347"><span class="linenum"> 347</span></a>  <span class="comment"> * by a number (in time steps) specified in $params['drift'].  If</span>
<a name="l348"><span class="linenum"> 348</span></a>  <span class="comment"> * the OTP supplied by the user is accepted, $params['drift'] will</span>
<a name="l349"><span class="linenum"> 349</span></a>  <span class="comment"> * be also be updated with the latest difference.</span>
<a name="l350"><span class="linenum"> 350</span></a>  <span class="comment"> *</span>
<a name="l351"><span class="linenum"> 351</span></a>  <span class="comment"> * To allow for network delay, the function will accepts OTPs which</span>
<a name="l352"><span class="linenum"> 352</span></a>  <span class="comment"> * is a number of time steps away from the OTP calculated from the</span>
<a name="l353"><span class="linenum"> 353</span></a>  <span class="comment"> * adjusted time.  The maximum number of time steps is specified in</span>
<a name="l354"><span class="linenum"> 354</span></a>  <span class="comment"> * the $max_drift parameter.</span>
<a name="l355"><span class="linenum"> 355</span></a>  <span class="comment"> *</span>
<a name="l356"><span class="linenum"> 356</span></a>  <span class="comment"> * @param array &amp;$params the OTP parameters stored</span>
<a name="l357"><span class="linenum"> 357</span></a>  <span class="comment"> * @param string $code the OTP supplied by the user</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment"> * @param int $max_drift the maximum drift allowed for network delay, in</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment"> * time steps</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment"> * @return bool whether the OTP supplied matches the OTP generated based on</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment"> * the specified parameters, within the maximum drift</span>
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment"> */</span>
<a name="l363"><span class="linenum"> 363</span></a>  function <a class="function" onClick="logFunction('user_verify_otp')" href="../_functions/user_verify_otp.html" onMouseOver="funcPopup(event,'user_verify_otp')">user_verify_otp</a>(&amp;<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>, <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('code')" href="../_variables/code.html">$code</a>, <a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('max_drift')" href="../_variables/max_drift.html">$max_drift</a> = 1) {
<a name="l364"><span class="linenum"> 364</span></a>      switch (<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['type']) {
<a name="l365"><span class="linenum"> 365</span></a>          case 'totp':
<a name="l366"><span class="linenum"> 366</span></a>              <a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l367"><span class="linenum"> 367</span></a>  
<a name="l368"><span class="linenum"> 368</span></a>              <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('test_code')" href="../_variables/test_code.html">$test_code</a> = <a class="function" onClick="logFunction('user_totp')" href="../_functions/user_totp.html" onMouseOver="funcPopup(event,'user_totp')">user_totp</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['secret'], <a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a>, <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['period'], <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['drift'], <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['algorithm'], <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['digits']);
<a name="l369"><span class="linenum"> 369</span></a>              
<a name="l370"><span class="linenum"> 370</span></a>              if (<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('test_code')" href="../_variables/test_code.html">$test_code</a> == <a class="phpfunction" onClick="logFunction('intval')" href="../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('code')" href="../_variables/code.html">$code</a>)) return true;
<a name="l371"><span class="linenum"> 371</span></a>  
<a name="l372"><span class="linenum"> 372</span></a>              for (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = -<a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('max_drift')" href="../_variables/max_drift.html">$max_drift</a>; <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt;= <a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('max_drift')" href="../_variables/max_drift.html">$max_drift</a>; <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l373"><span class="linenum"> 373</span></a>                  <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('test_code')" href="../_variables/test_code.html">$test_code</a> = <a class="function" onClick="logFunction('user_totp')" href="../_functions/user_totp.html" onMouseOver="funcPopup(event,'user_totp')">user_totp</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['secret'], <a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a>, <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['period'], <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['drift'] + <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>, <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['algorithm'], <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['digits']);
<a name="l374"><span class="linenum"> 374</span></a>                  if (<a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('test_code')" href="../_variables/test_code.html">$test_code</a> == <a class="phpfunction" onClick="logFunction('intval')" href="../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('code')" href="../_variables/code.html">$code</a>)) {
<a name="l375"><span class="linenum"> 375</span></a>                      <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['drift'] = <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>;
<a name="l376"><span class="linenum"> 376</span></a>                      return true;
<a name="l377"><span class="linenum"> 377</span></a>                  }
<a name="l378"><span class="linenum"> 378</span></a>              }
<a name="l379"><span class="linenum"> 379</span></a>              return false;
<a name="l380"><span class="linenum"> 380</span></a>              break;
<a name="l381"><span class="linenum"> 381</span></a>          default:
<a name="l382"><span class="linenum"> 382</span></a>              return false;
<a name="l383"><span class="linenum"> 383</span></a>      }
<a name="l384"><span class="linenum"> 384</span></a>  }
<a name="l385"><span class="linenum"> 385</span></a>  
<a name="l386"><span class="linenum"> 386</span></a>  
<a name="l387"><span class="linenum"> 387</span></a>  <span class="comment">/**</span>
<a name="l388"><span class="linenum"> 388</span></a>  <span class="comment"> * Sets the user specified by the parameter as the active user.</span>
<a name="l389"><span class="linenum"> 389</span></a>  <span class="comment"> *</span>
<a name="l390"><span class="linenum"> 390</span></a>  <span class="comment"> * @param array $login_user the user to log in</span>
<a name="l391"><span class="linenum"> 391</span></a>  <span class="comment"> * @param bool $auth_active whether the user has been actively authenticated</span>
<a name="l392"><span class="linenum"> 392</span></a>  <span class="comment"> * in this session</span>
<a name="l393"><span class="linenum"> 393</span></a>  <span class="comment"> *</span>
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment"> */</span>
<a name="l395"><span class="linenum"> 395</span></a>  function <a class="function" onClick="logFunction('_user_login')" href="../_functions/_user_login.html" onMouseOver="funcPopup(event,'_user_login')">_user_login</a>(<a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('login_user')" href="../_variables/login_user.html">$login_user</a>, <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('auth_active')" href="../_variables/auth_active.html">$auth_active</a> = false) {
<a name="l396"><span class="linenum"> 396</span></a>      global <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l397"><span class="linenum"> 397</span></a>  
<a name="l398"><span class="linenum"> 398</span></a>      if (<a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('auth_active')" href="../_variables/auth_active.html">$auth_active</a>) {
<a name="l399"><span class="linenum"> 399</span></a>  <span class="comment">        // Set the current authentication time</span>
<a name="l400"><span class="linenum"> 400</span></a>          <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('login_user')" href="../_variables/login_user.html">$login_user</a>['auth_time'] = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l401"><span class="linenum"> 401</span></a>          <a class="function" onClick="logFunction('user_save')" href="../_functions/user_save.html" onMouseOver="funcPopup(event,'user_save')">user_save</a>(<a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('login_user')" href="../_variables/login_user.html">$login_user</a>);
<a name="l402"><span class="linenum"> 402</span></a>      
<a name="l403"><span class="linenum"> 403</span></a>  <span class="comment">        // Set user has been actively authenticated this and the next request only</span>
<a name="l404"><span class="linenum"> 404</span></a>          <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('login_user')" href="../_variables/login_user.html">$login_user</a>['auth_active'] = true;
<a name="l405"><span class="linenum"> 405</span></a>          <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['user_auth_active'] = true;
<a name="l406"><span class="linenum"> 406</span></a>          <a class="function" onClick="logFunction('log_info')" href="../_functions/log_info.html" onMouseOver="funcPopup(event,'log_info')">log_info</a>('Login successful: ' . <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('login_user')" href="../_variables/login_user.html">$login_user</a>['uid'] . '['. <a class="phpfunction" onClick="logFunction('gmstrftime')" href="../_functions/gmstrftime.html" onMouseOver="phpfuncPopup(event,'gmstrftime')">gmstrftime</a>('%Y-%m-%dT%H:%M:%SZ', <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('login_user')" href="../_variables/login_user.html">$login_user</a>['auth_time']) . ']');
<a name="l407"><span class="linenum"> 407</span></a>  
<a name="l408"><span class="linenum"> 408</span></a>      }
<a name="l409"><span class="linenum"> 409</span></a>  
<a name="l410"><span class="linenum"> 410</span></a>      <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('login_user')" href="../_variables/login_user.html">$login_user</a>;
<a name="l411"><span class="linenum"> 411</span></a>      <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['user'] = <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('login_user')" href="../_variables/login_user.html">$login_user</a>['uid'];
<a name="l412"><span class="linenum"> 412</span></a>      <a class="function" onClick="logFunction('cache_set')" href="../_functions/cache_set.html" onMouseOver="funcPopup(event,'cache_set')">cache_set</a>('user', <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('login_user')" href="../_variables/login_user.html">$login_user</a>['uid'], <a class="phpfunction" onClick="logFunction('session_id')" href="../_functions/session_id.html" onMouseOver="phpfuncPopup(event,'session_id')">session_id</a>());
<a name="l413"><span class="linenum"> 413</span></a>  
<a name="l414"><span class="linenum"> 414</span></a>  
<a name="l415"><span class="linenum"> 415</span></a>      if (<a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('auth_active')" href="../_variables/auth_active.html">$auth_active</a>) {
<a name="l416"><span class="linenum"> 416</span></a>          if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['autologin']) &amp;&amp; (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['autologin'] == 1)) <a class="function" onClick="logFunction('user_cookieauth_create_cookie')" href="../_functions/user_cookieauth_create_cookie.html" onMouseOver="funcPopup(event,'user_cookieauth_create_cookie')">user_cookieauth_create_cookie</a>();
<a name="l417"><span class="linenum"> 417</span></a>      }
<a name="l418"><span class="linenum"> 418</span></a>  }
<a name="l419"><span class="linenum"> 419</span></a>  
<a name="l420"><span class="linenum"> 420</span></a>  <span class="comment">/**</span>
<a name="l421"><span class="linenum"> 421</span></a>  <span class="comment"> * Attempts to log out a user and returns to the login form.</span>
<a name="l422"><span class="linenum"> 422</span></a>  <span class="comment"> *</span>
<a name="l423"><span class="linenum"> 423</span></a>  <span class="comment"> * @param string $destination the destination value to be included in the</span>
<a name="l424"><span class="linenum"> 424</span></a>  <span class="comment"> * login form</span>
<a name="l425"><span class="linenum"> 425</span></a>  <span class="comment"> */</span>
<a name="l426"><span class="linenum"> 426</span></a>  function <a class="function" onClick="logFunction('user_logout')" href="../_functions/user_logout.html" onMouseOver="funcPopup(event,'user_logout')">user_logout</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a> = NULL) {
<a name="l427"><span class="linenum"> 427</span></a>      global <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>, <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>;
<a name="l428"><span class="linenum"> 428</span></a>      
<a name="l429"><span class="linenum"> 429</span></a>  <span class="comment">    // Require HTTPS, redirect if necessary</span>
<a name="l430"><span class="linenum"> 430</span></a>      <a class="function" onClick="logFunction('check_https')" href="../_functions/check_https.html" onMouseOver="funcPopup(event,'check_https')">check_https</a>('redirect', true);
<a name="l431"><span class="linenum"> 431</span></a>      
<a name="l432"><span class="linenum"> 432</span></a>      <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a> = (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>['s'])) ? <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>['s'] : '';
<a name="l433"><span class="linenum"> 433</span></a>      if (<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a> == NULL) {
<a name="l434"><span class="linenum"> 434</span></a>          if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>['destination'])) {
<a name="l435"><span class="linenum"> 435</span></a>              <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a> = <a class="var it145" onMouseOver="hilite(145)" onMouseOut="lolite()" onClick="logVariable('GETPOST')" href="../_variables/GETPOST.html">$GETPOST</a>['destination'];
<a name="l436"><span class="linenum"> 436</span></a>          } else {
<a name="l437"><span class="linenum"> 437</span></a>              <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a> = '';
<a name="l438"><span class="linenum"> 438</span></a>          }
<a name="l439"><span class="linenum"> 439</span></a>      }
<a name="l440"><span class="linenum"> 440</span></a>      
<a name="l441"><span class="linenum"> 441</span></a>      <a class="function" onClick="logFunction('_user_logout')" href="../_functions/_user_logout.html" onMouseOver="funcPopup(event,'_user_logout')">_user_logout</a>();
<a name="l442"><span class="linenum"> 442</span></a>      
<a name="l443"><span class="linenum"> 443</span></a>      <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('You have been logged out.'));
<a name="l444"><span class="linenum"> 444</span></a>      
<a name="l445"><span class="linenum"> 445</span></a>      <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>);
<a name="l446"><span class="linenum"> 446</span></a>  }
<a name="l447"><span class="linenum"> 447</span></a>  
<a name="l448"><span class="linenum"> 448</span></a>  <span class="comment">/**</span>
<a name="l449"><span class="linenum"> 449</span></a>  <span class="comment"> * Logs out the user by deleting the relevant session information.</span>
<a name="l450"><span class="linenum"> 450</span></a>  <span class="comment"> */</span>
<a name="l451"><span class="linenum"> 451</span></a>  function <a class="function" onClick="logFunction('_user_logout')" href="../_functions/_user_logout.html" onMouseOver="funcPopup(event,'_user_logout')">_user_logout</a>() {
<a name="l452"><span class="linenum"> 452</span></a>      global <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l453"><span class="linenum"> 453</span></a>  
<a name="l454"><span class="linenum"> 454</span></a>      <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a> = <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['uid'];
<a name="l455"><span class="linenum"> 455</span></a>      
<a name="l456"><span class="linenum"> 456</span></a>      <a class="function" onClick="logFunction('user_cookieauth_invalidate')" href="../_functions/user_cookieauth_invalidate.html" onMouseOver="funcPopup(event,'user_cookieauth_invalidate')">user_cookieauth_invalidate</a>();
<a name="l457"><span class="linenum"> 457</span></a>      <a class="phpfunction" onClick="logFunction('session_destroy')" href="../_functions/session_destroy.html" onMouseOver="phpfuncPopup(event,'session_destroy')">session_destroy</a>();
<a name="l458"><span class="linenum"> 458</span></a>      
<a name="l459"><span class="linenum"> 459</span></a>      <a class="function" onClick="logFunction('cache_delete')" href="../_functions/cache_delete.html" onMouseOver="funcPopup(event,'cache_delete')">cache_delete</a>('user', <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>);
<a name="l460"><span class="linenum"> 460</span></a>      <a class="phpfunction" onClick="logFunction('unset')" href="../_functions/unset.html" onMouseOver="phpfuncPopup(event,'unset')">unset</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['user']);
<a name="l461"><span class="linenum"> 461</span></a>      <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = NULL;
<a name="l462"><span class="linenum"> 462</span></a>  
<a name="l463"><span class="linenum"> 463</span></a>      <a class="function" onClick="logFunction('log_info')" href="../_functions/log_info.html" onMouseOver="funcPopup(event,'log_info')">log_info</a>('Logout successful: ' . <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>);
<a name="l464"><span class="linenum"> 464</span></a>  }
<a name="l465"><span class="linenum"> 465</span></a>  
<a name="l466"><span class="linenum"> 466</span></a>  <span class="comment">/**</span>
<a name="l467"><span class="linenum"> 467</span></a>  <span class="comment"> * Displays a user login or a login verification form.</span>
<a name="l468"><span class="linenum"> 468</span></a>  <span class="comment"> *</span>
<a name="l469"><span class="linenum"> 469</span></a>  <span class="comment"> * @param string $destination the SimpleID location to which the user is directed</span>
<a name="l470"><span class="linenum"> 470</span></a>  <span class="comment"> * if login is successful</span>
<a name="l471"><span class="linenum"> 471</span></a>  <span class="comment"> * @param string $state the current SimpleID state, if required by the location</span>
<a name="l472"><span class="linenum"> 472</span></a>  <span class="comment"> * @param string $fixed_uid the user name to be included in the login form; if NULL, the user</span>
<a name="l473"><span class="linenum"> 473</span></a>  <span class="comment"> * is asked to supply the user name.  If $mode is otp this cannot be null</span>
<a name="l474"><span class="linenum"> 474</span></a>  <span class="comment"> * @param string $mode either credentials (login form) or otp (login verification</span>
<a name="l475"><span class="linenum"> 475</span></a>  <span class="comment"> * form)</span>
<a name="l476"><span class="linenum"> 476</span></a>  <span class="comment"> */</span>
<a name="l477"><span class="linenum"> 477</span></a>  function <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a> = '', <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a> = NULL, <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a> = NULL, <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a> = 'credentials') {
<a name="l478"><span class="linenum"> 478</span></a>      global <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>;
<a name="l479"><span class="linenum"> 479</span></a>      
<a name="l480"><span class="linenum"> 480</span></a>  <span class="comment">    // Require HTTPS, redirect if necessary</span>
<a name="l481"><span class="linenum"> 481</span></a>      <a class="function" onClick="logFunction('check_https')" href="../_functions/check_https.html" onMouseOver="funcPopup(event,'check_https')">check_https</a>('redirect', true);
<a name="l482"><span class="linenum"> 482</span></a>  
<a name="l483"><span class="linenum"> 483</span></a>      if (<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>) {
<a name="l484"><span class="linenum"> 484</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('state', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>, ENT_QUOTES, 'UTF-8'));
<a name="l485"><span class="linenum"> 485</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('cancel_button', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Cancel'));
<a name="l486"><span class="linenum"> 486</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.login.state');
<a name="l487"><span class="linenum"> 487</span></a>      }
<a name="l488"><span class="linenum"> 488</span></a>      
<a name="l489"><span class="linenum"> 489</span></a>      <a class="function" onClick="logFunction('cache_expire')" href="../_functions/cache_expire.html" onMouseOver="funcPopup(event,'cache_expire')">cache_expire</a>(<a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('user-nonce' =&gt; <a class="constant" onClick="logConstant('SIMPLEID_LOGIN_NONCE_EXPIRES_IN')" href="../_constants/SIMPLEID_LOGIN_NONCE_EXPIRES_IN.html" onMouseOver="constPopup(event,'SIMPLEID_LOGIN_NONCE_EXPIRES_IN')">SIMPLEID_LOGIN_NONCE_EXPIRES_IN</a>));
<a name="l490"><span class="linenum"> 490</span></a>      <a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a> = <a class="function" onClick="logFunction('openid_nonce')" href="../_functions/openid_nonce.html" onMouseOver="funcPopup(event,'openid_nonce')">openid_nonce</a>();
<a name="l491"><span class="linenum"> 491</span></a>      <a class="function" onClick="logFunction('cache_set')" href="../_functions/cache_set.html" onMouseOver="funcPopup(event,'cache_set')">cache_set</a>('user-nonce', <a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a>, <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('mode' =&gt; <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>, 'uid' =&gt; <a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a>));
<a name="l492"><span class="linenum"> 492</span></a>      
<a name="l493"><span class="linenum"> 493</span></a>      <a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('base_path')" href="../_variables/base_path.html">$base_path</a> = <a class="function" onClick="logFunction('get_base_path')" href="../_functions/get_base_path.html" onMouseOver="funcPopup(event,'get_base_path')">get_base_path</a>();
<a name="l494"><span class="linenum"> 494</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('javascript', '&lt;script src=&quot;' . <a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('base_path')" href="../_variables/base_path.html">$base_path</a> . 'html/user-login.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;');
<a name="l495"><span class="linenum"> 495</span></a>  
<a name="l496"><span class="linenum"> 496</span></a>      <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('X-Frame-Options: DENY');
<a name="l497"><span class="linenum"> 497</span></a>  
<a name="l498"><span class="linenum"> 498</span></a>      switch (<a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>) {
<a name="l499"><span class="linenum"> 499</span></a>          case 'credentials':
<a name="l500"><span class="linenum"> 500</span></a>              <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('security_class')" href="../_variables/security_class.html">$security_class</a> = (SIMPLEID_ALLOW_AUTOCOMPLETE) ? 'allow-autocomplete ' : '';
<a name="l501"><span class="linenum"> 501</span></a>              if (<a class="function" onClick="logFunction('is_https')" href="../_functions/is_https.html" onMouseOver="funcPopup(event,'is_https')">is_https</a>()) {
<a name="l502"><span class="linenum"> 502</span></a>                  <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('security_class')" href="../_variables/security_class.html">$security_class</a> .= 'secure';
<a name="l503"><span class="linenum"> 503</span></a>                  <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('security_message', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Secure login using &lt;strong&gt;HTTPS&lt;/strong&gt;.'));
<a name="l504"><span class="linenum"> 504</span></a>              } elseif (SIMPLEID_ALLOW_PLAINTEXT) {
<a name="l505"><span class="linenum"> 505</span></a>                  <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('security_class')" href="../_variables/security_class.html">$security_class</a> .= 'unsecure';
<a name="l506"><span class="linenum"> 506</span></a>                  <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('security_message', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('&lt;strong&gt;WARNING:&lt;/strong&gt;  Your password will be sent to SimpleID as plain text.'));
<a name="l507"><span class="linenum"> 507</span></a>              }
<a name="l508"><span class="linenum"> 508</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('security_class', <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('security_class')" href="../_variables/security_class.html">$security_class</a>);
<a name="l509"><span class="linenum"> 509</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.login.login_security');
<a name="l510"><span class="linenum"> 510</span></a>  
<a name="l511"><span class="linenum"> 511</span></a>              <a class="function" onClick="logFunction('extension_invoke_all')" href="../_functions/extension_invoke_all.html" onMouseOver="funcPopup(event,'extension_invoke_all')">extension_invoke_all</a>('user_login_form', <a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, <a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>);
<a name="l512"><span class="linenum"> 512</span></a>  
<a name="l513"><span class="linenum"> 513</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('name_label', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('User name:'));
<a name="l514"><span class="linenum"> 514</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('pass_label', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Password:'));
<a name="l515"><span class="linenum"> 515</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('autologin_label', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Remember me on this computer for two weeks.'));
<a name="l516"><span class="linenum"> 516</span></a>  
<a name="l517"><span class="linenum"> 517</span></a>              if (<a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a> == NULL) {
<a name="l518"><span class="linenum"> 518</span></a>                  <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.login.credentials.input_uid');
<a name="l519"><span class="linenum"> 519</span></a>              } else {
<a name="l520"><span class="linenum"> 520</span></a>                  <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('uid', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it171" onMouseOver="hilite(171)" onMouseOut="lolite()" onClick="logVariable('fixed_uid')" href="../_variables/fixed_uid.html">$fixed_uid</a>, ENT_QUOTES, 'UTF-8'));
<a name="l521"><span class="linenum"> 521</span></a>                  <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.login.credentials.fixed_uid');
<a name="l522"><span class="linenum"> 522</span></a>              }
<a name="l523"><span class="linenum"> 523</span></a>  
<a name="l524"><span class="linenum"> 524</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.login.credentials');
<a name="l525"><span class="linenum"> 525</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('submit_button', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Log in'));
<a name="l526"><span class="linenum"> 526</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('title', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Log In'));
<a name="l527"><span class="linenum"> 527</span></a>              break;
<a name="l528"><span class="linenum"> 528</span></a>          case 'otp':
<a name="l529"><span class="linenum"> 529</span></a>  <span class="comment">            // Note this is called from user_login(), so $_POST is always filled</span>
<a name="l530"><span class="linenum"> 530</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('otp_instructions_label', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('To verify your identity, enter the verification code.'));
<a name="l531"><span class="linenum"> 531</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('otp_recovery_label', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('If you have lost your verification code, you can &lt;a href=&quot;!url&quot;&gt;recover your account&lt;/a&gt;.',
<a name="l532"><span class="linenum"> 532</span></a>                  <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('!url' =&gt; 'http://simpleid.koinic.net/documentation/troubleshooting/login-verification-recovery')
<a name="l533"><span class="linenum"> 533</span></a>              ));
<a name="l534"><span class="linenum"> 534</span></a>  
<a name="l535"><span class="linenum"> 535</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('otp_label', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Verification code:'));
<a name="l536"><span class="linenum"> 536</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('autologin', (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['autologin']) &amp;&amp; (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['autologin'] == 1)) ? '1' : '0');
<a name="l537"><span class="linenum"> 537</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.login.otp');
<a name="l538"><span class="linenum"> 538</span></a>              
<a name="l539"><span class="linenum"> 539</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('submit_button', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Verify'));
<a name="l540"><span class="linenum"> 540</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('title', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Enter Verification Code'));
<a name="l541"><span class="linenum"> 541</span></a>          default:
<a name="l542"><span class="linenum"> 542</span></a>      }
<a name="l543"><span class="linenum"> 543</span></a>  
<a name="l544"><span class="linenum"> 544</span></a>  
<a name="l545"><span class="linenum"> 545</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('mode', <a class="var it141" onMouseOver="hilite(141)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../_variables/mode.html">$mode</a>);
<a name="l546"><span class="linenum"> 546</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('page_class', 'dialog-page');
<a name="l547"><span class="linenum"> 547</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('destination', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it7" onMouseOver="hilite(7)" onMouseOut="lolite()" onClick="logVariable('destination')" href="../_variables/destination.html">$destination</a>, ENT_QUOTES, 'UTF-8'));
<a name="l548"><span class="linenum"> 548</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('nonce', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../_variables/nonce.html">$nonce</a>, ENT_QUOTES, 'UTF-8'));
<a name="l549"><span class="linenum"> 549</span></a>      
<a name="l550"><span class="linenum"> 550</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.login');
<a name="l551"><span class="linenum"> 551</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.framekiller');
<a name="l552"><span class="linenum"> 552</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main');
<a name="l553"><span class="linenum"> 553</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>('main');
<a name="l554"><span class="linenum"> 554</span></a>  }
<a name="l555"><span class="linenum"> 555</span></a>  
<a name="l556"><span class="linenum"> 556</span></a>  <span class="comment">/**</span>
<a name="l557"><span class="linenum"> 557</span></a>  <span class="comment"> * Displays the page used to set up login verification using one-time</span>
<a name="l558"><span class="linenum"> 558</span></a>  <span class="comment"> * passwords.</span>
<a name="l559"><span class="linenum"> 559</span></a>  <span class="comment"> */</span>
<a name="l560"><span class="linenum"> 560</span></a>  function <a class="function" onClick="logFunction('user_otp_page')" href="../_functions/user_otp_page.html" onMouseOver="funcPopup(event,'user_otp_page')">user_otp_page</a>() {
<a name="l561"><span class="linenum"> 561</span></a>      global <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>, <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l562"><span class="linenum"> 562</span></a>  
<a name="l563"><span class="linenum"> 563</span></a>  <span class="comment">    // Require HTTPS, redirect if necessary</span>
<a name="l564"><span class="linenum"> 564</span></a>      <a class="function" onClick="logFunction('check_https')" href="../_functions/check_https.html" onMouseOver="funcPopup(event,'check_https')">check_https</a>('redirect', true);
<a name="l565"><span class="linenum"> 565</span></a>      
<a name="l566"><span class="linenum"> 566</span></a>      if (<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> == NULL) {
<a name="l567"><span class="linenum"> 567</span></a>          <a class="function" onClick="logFunction('user_login_form')" href="../_functions/user_login_form.html" onMouseOver="funcPopup(event,'user_login_form')">user_login_form</a>('my/profile');
<a name="l568"><span class="linenum"> 568</span></a>          return;
<a name="l569"><span class="linenum"> 569</span></a>      }
<a name="l570"><span class="linenum"> 570</span></a>  
<a name="l571"><span class="linenum"> 571</span></a>      if (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['op'] == <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Disable')) {
<a name="l572"><span class="linenum"> 572</span></a>          if (!<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['tk']) || !<a class="function" onClick="logFunction('validate_form_token')" href="../_functions/validate_form_token.html" onMouseOver="funcPopup(event,'validate_form_token')">validate_form_token</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['tk'], 'dashboard_otp')) {
<a name="l573"><span class="linenum"> 573</span></a>              <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('SimpleID detected a potential security attack.  Please try again.'));
<a name="l574"><span class="linenum"> 574</span></a>              <a class="function" onClick="logFunction('page_dashboard')" href="../_functions/page_dashboard.html" onMouseOver="funcPopup(event,'page_dashboard')">page_dashboard</a>();
<a name="l575"><span class="linenum"> 575</span></a>              return;
<a name="l576"><span class="linenum"> 576</span></a>          }
<a name="l577"><span class="linenum"> 577</span></a>  
<a name="l578"><span class="linenum"> 578</span></a>          if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['otp'])) {
<a name="l579"><span class="linenum"> 579</span></a>              <a class="phpfunction" onClick="logFunction('unset')" href="../_functions/unset.html" onMouseOver="phpfuncPopup(event,'unset')">unset</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['otp']);
<a name="l580"><span class="linenum"> 580</span></a>              <a class="function" onClick="logFunction('user_save')" href="../_functions/user_save.html" onMouseOver="funcPopup(event,'user_save')">user_save</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l581"><span class="linenum"> 581</span></a>          }
<a name="l582"><span class="linenum"> 582</span></a>          <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>('Login verification has been disabled.');
<a name="l583"><span class="linenum"> 583</span></a>          <a class="function" onClick="logFunction('page_dashboard')" href="../_functions/page_dashboard.html" onMouseOver="funcPopup(event,'page_dashboard')">page_dashboard</a>();
<a name="l584"><span class="linenum"> 584</span></a>          return;
<a name="l585"><span class="linenum"> 585</span></a>      } elseif (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['op'] == <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Verify')) {
<a name="l586"><span class="linenum"> 586</span></a>          <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['otp_setup'];
<a name="l587"><span class="linenum"> 587</span></a>  
<a name="l588"><span class="linenum"> 588</span></a>          if (!<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['tk']) || !<a class="function" onClick="logFunction('validate_form_token')" href="../_functions/validate_form_token.html" onMouseOver="funcPopup(event,'validate_form_token')">validate_form_token</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['tk'], 'otp')) {
<a name="l589"><span class="linenum"> 589</span></a>              <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('SimpleID detected a potential security attack.  Please try again.'));
<a name="l590"><span class="linenum"> 590</span></a>              <a class="function" onClick="logFunction('page_dashboard')" href="../_functions/page_dashboard.html" onMouseOver="funcPopup(event,'page_dashboard')">page_dashboard</a>();
<a name="l591"><span class="linenum"> 591</span></a>              return;
<a name="l592"><span class="linenum"> 592</span></a>          } elseif (!<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['otp']) || (<a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['otp'] == '')) {
<a name="l593"><span class="linenum"> 593</span></a>              <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('You need to enter the verification code to complete enabling login verification.'));
<a name="l594"><span class="linenum"> 594</span></a>          } elseif (<a class="function" onClick="logFunction('user_verify_otp')" href="../_functions/user_verify_otp.html" onMouseOver="funcPopup(event,'user_verify_otp')">user_verify_otp</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>, <a class="var it70" onMouseOver="hilite(70)" onMouseOut="lolite()" onClick="logVariable('_POST')" href="../_variables/_POST.html">$_POST</a>['otp'], 10) === false) {
<a name="l595"><span class="linenum"> 595</span></a>              <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('The verification code is not correct.'));
<a name="l596"><span class="linenum"> 596</span></a>          } else {
<a name="l597"><span class="linenum"> 597</span></a>              <a class="phpfunction" onClick="logFunction('unset')" href="../_functions/unset.html" onMouseOver="phpfuncPopup(event,'unset')">unset</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['otp_setup']);
<a name="l598"><span class="linenum"> 598</span></a>              <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['otp'] = <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>;
<a name="l599"><span class="linenum"> 599</span></a>              <a class="function" onClick="logFunction('user_save')" href="../_functions/user_save.html" onMouseOver="funcPopup(event,'user_save')">user_save</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>);
<a name="l600"><span class="linenum"> 600</span></a>  
<a name="l601"><span class="linenum"> 601</span></a>              <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>('Login verification has been enabled.');
<a name="l602"><span class="linenum"> 602</span></a>              <a class="function" onClick="logFunction('page_dashboard')" href="../_functions/page_dashboard.html" onMouseOver="funcPopup(event,'page_dashboard')">page_dashboard</a>();
<a name="l603"><span class="linenum"> 603</span></a>              return;
<a name="l604"><span class="linenum"> 604</span></a>          }
<a name="l605"><span class="linenum"> 605</span></a>      } else {
<a name="l606"><span class="linenum"> 606</span></a>          <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a> = <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>(
<a name="l607"><span class="linenum"> 607</span></a>              'type' =&gt; 'totp',
<a name="l608"><span class="linenum"> 608</span></a>              'secret' =&gt; <a class="function" onClick="logFunction('random_bytes')" href="../_functions/random_bytes.html" onMouseOver="funcPopup(event,'random_bytes')">random_bytes</a>(10),
<a name="l609"><span class="linenum"> 609</span></a>              'algorithm' =&gt; 'sha1',
<a name="l610"><span class="linenum"> 610</span></a>              'digits' =&gt; 6,
<a name="l611"><span class="linenum"> 611</span></a>              'period' =&gt; 30,
<a name="l612"><span class="linenum"> 612</span></a>              'drift' =&gt; 0,
<a name="l613"><span class="linenum"> 613</span></a>          );
<a name="l614"><span class="linenum"> 614</span></a>          <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('_SESSION')" href="../_variables/_SESSION.html">$_SESSION</a>['otp_setup'] = <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>;
<a name="l615"><span class="linenum"> 615</span></a>      }
<a name="l616"><span class="linenum"> 616</span></a>  
<a name="l617"><span class="linenum"> 617</span></a>      <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('code')" href="../_variables/code.html">$code</a> = <a class="phpfunction" onClick="logFunction('strtr')" href="../_functions/strtr.html" onMouseOver="phpfuncPopup(event,'strtr')">strtr</a>(<a class="function" onClick="logFunction('bignum_val')" href="../_functions/bignum_val.html" onMouseOver="funcPopup(event,'bignum_val')">bignum_val</a>(<a class="function" onClick="logFunction('bignum_new')" href="../_functions/bignum_new.html" onMouseOver="funcPopup(event,'bignum_new')">bignum_new</a>(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['secret'], 256), 32), '0123456789abcdefghijklmnopqrstuv', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567');
<a name="l618"><span class="linenum"> 618</span></a>      for (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = 0; <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt; <a class="phpfunction" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="phpfuncPopup(event,'strlen')">strlen</a>(<a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('code')" href="../_variables/code.html">$code</a>); <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> += 4) {
<a name="l619"><span class="linenum"> 619</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('secret' . (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> + 1), <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(<a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('code')" href="../_variables/code.html">$code</a>, <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>, 4));
<a name="l620"><span class="linenum"> 620</span></a>      }
<a name="l621"><span class="linenum"> 621</span></a>  
<a name="l622"><span class="linenum"> 622</span></a>      <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a> = 'otpauth://totp/SimpleID?secret=' . <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('code')" href="../_variables/code.html">$code</a> . '&amp;digits=' . <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['digits'] . '&amp;period=' . <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('params')" href="../_variables/params.html">$params</a>['period'];
<a name="l623"><span class="linenum"> 623</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('qr', <a class="phpfunction" onClick="logFunction('addslashes')" href="../_functions/addslashes.html" onMouseOver="phpfuncPopup(event,'addslashes')">addslashes</a>(<a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>));
<a name="l624"><span class="linenum"> 624</span></a>  
<a name="l625"><span class="linenum"> 625</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('about_otp', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Login verification adds an extra layer of protection to your account. When enabled, you will need to enter an additional security code whenever you log into SimpleID.'));
<a name="l626"><span class="linenum"> 626</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('otp_warning', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('&lt;strong&gt;WARNING:&lt;/strong&gt; If you enable login verification and lose your authenticator app, you will need to &lt;a href=&quot;!url&quot;&gt;edit your identity file manually&lt;/a&gt; before you can log in again.',
<a name="l627"><span class="linenum"> 627</span></a>          <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('!url' =&gt; 'http://simpleid.koinic.net/documentation/troubleshooting/login-verification-recovery')
<a name="l628"><span class="linenum"> 628</span></a>      ));
<a name="l629"><span class="linenum"> 629</span></a>  
<a name="l630"><span class="linenum"> 630</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('setup_otp', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('To set up login verification, following these steps.'));
<a name="l631"><span class="linenum"> 631</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('download_app', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Download an authenticator app that supports TOTP for your smartphone, such as Google Authenticator.'));
<a name="l632"><span class="linenum"> 632</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('add_account', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Add your SimpleID account to authenticator app using this key.  If you are viewing this page on your smartphone you can use &lt;a href=&quot;!url&quot;&gt;this link&lt;/a&gt; or scan the QR code to add your account.',
<a name="l633"><span class="linenum"> 633</span></a>          <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('!url' =&gt; <a class="var it6" onMouseOver="hilite(6)" onMouseOut="lolite()" onClick="logVariable('url')" href="../_variables/url.html">$url</a>)
<a name="l634"><span class="linenum"> 634</span></a>      ));
<a name="l635"><span class="linenum"> 635</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('verify_code', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('To check that your account has been added properly, enter the verification code from your phone into the box below, and click Verify.'));
<a name="l636"><span class="linenum"> 636</span></a>  
<a name="l637"><span class="linenum"> 637</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('token', <a class="function" onClick="logFunction('get_form_token')" href="../_functions/get_form_token.html" onMouseOver="funcPopup(event,'get_form_token')">get_form_token</a>('otp'));
<a name="l638"><span class="linenum"> 638</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('otp_label', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Verification code:'));
<a name="l639"><span class="linenum"> 639</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('submit_button', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Verify'));
<a name="l640"><span class="linenum"> 640</span></a>  
<a name="l641"><span class="linenum"> 641</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('page_class', 'dialog-page');
<a name="l642"><span class="linenum"> 642</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('title', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Login Verification'));
<a name="l643"><span class="linenum"> 643</span></a>  
<a name="l644"><span class="linenum"> 644</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.otp');
<a name="l645"><span class="linenum"> 645</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.framekiller');
<a name="l646"><span class="linenum"> 646</span></a>      
<a name="l647"><span class="linenum"> 647</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main');
<a name="l648"><span class="linenum"> 648</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>('main');
<a name="l649"><span class="linenum"> 649</span></a>      
<a name="l650"><span class="linenum"> 650</span></a>  }
<a name="l651"><span class="linenum"> 651</span></a>  
<a name="l652"><span class="linenum"> 652</span></a>  
<a name="l653"><span class="linenum"> 653</span></a>  <span class="comment">/**</span>
<a name="l654"><span class="linenum"> 654</span></a>  <span class="comment"> * Returns the user's public page.</span>
<a name="l655"><span class="linenum"> 655</span></a>  <span class="comment"> * </span>
<a name="l656"><span class="linenum"> 656</span></a>  <span class="comment"> * @param string $uid the user ID</span>
<a name="l657"><span class="linenum"> 657</span></a>  <span class="comment"> */</span>
<a name="l658"><span class="linenum"> 658</span></a>  function <a class="function" onClick="logFunction('user_public_page')" href="../_functions/user_public_page.html" onMouseOver="funcPopup(event,'user_public_page')">user_public_page</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a> = NULL) {
<a name="l659"><span class="linenum"> 659</span></a>      global <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>, <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l660"><span class="linenum"> 660</span></a>      
<a name="l661"><span class="linenum"> 661</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('title', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('User Page'));
<a name="l662"><span class="linenum"> 662</span></a>      if (<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a> == NULL) {
<a name="l663"><span class="linenum"> 663</span></a>          <a class="function" onClick="logFunction('header_response_code')" href="../_functions/header_response_code.html" onMouseOver="funcPopup(event,'header_response_code')">header_response_code</a>('400 Bad Request');
<a name="l664"><span class="linenum"> 664</span></a>          <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('No user specified.'));
<a name="l665"><span class="linenum"> 665</span></a>      } else {
<a name="l666"><span class="linenum"> 666</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('user_load')" href="../_functions/user_load.html" onMouseOver="funcPopup(event,'user_load')">user_load</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>);
<a name="l667"><span class="linenum"> 667</span></a>          
<a name="l668"><span class="linenum"> 668</span></a>          if (<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> == NULL) {
<a name="l669"><span class="linenum"> 669</span></a>              <a class="function" onClick="logFunction('header_response_code')" href="../_functions/header_response_code.html" onMouseOver="funcPopup(event,'header_response_code')">header_response_code</a>('404 Not Found');
<a name="l670"><span class="linenum"> 670</span></a>              <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('User %uid not found.', <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('%uid' =&gt; <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>)));
<a name="l671"><span class="linenum"> 671</span></a>          } else {
<a name="l672"><span class="linenum"> 672</span></a>              <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Vary: Accept');
<a name="l673"><span class="linenum"> 673</span></a>              
<a name="l674"><span class="linenum"> 674</span></a>              <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('content_type')" href="../_variables/content_type.html">$content_type</a> = <a class="function" onClick="logFunction('negotiate_content_type')" href="../_functions/negotiate_content_type.html" onMouseOver="funcPopup(event,'negotiate_content_type')">negotiate_content_type</a>(<a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('text/html', 'application/xml', 'application/xhtml+xml', 'application/xrds+xml'));
<a name="l675"><span class="linenum"> 675</span></a>              
<a name="l676"><span class="linenum"> 676</span></a>              if (<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('content_type')" href="../_variables/content_type.html">$content_type</a> == 'application/xrds+xml') {
<a name="l677"><span class="linenum"> 677</span></a>                  <a class="function" onClick="logFunction('user_xrds')" href="../_functions/user_xrds.html" onMouseOver="funcPopup(event,'user_xrds')">user_xrds</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>);
<a name="l678"><span class="linenum"> 678</span></a>                  return;
<a name="l679"><span class="linenum"> 679</span></a>              } else {
<a name="l680"><span class="linenum"> 680</span></a>                  <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('X-XRDS-Location: ' . <a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>('xrds/' . <a class="phpfunction" onClick="logFunction('rawurlencode')" href="../_functions/rawurlencode.html" onMouseOver="phpfuncPopup(event,'rawurlencode')">rawurlencode</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>)));
<a name="l681"><span class="linenum"> 681</span></a>                  
<a name="l682"><span class="linenum"> 682</span></a>                  <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('This is the user %uid\'s SimpleID page.  It contains hidden information for the use by OpenID consumers.', <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('%uid' =&gt; <a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>)));
<a name="l683"><span class="linenum"> 683</span></a>                  
<a name="l684"><span class="linenum"> 684</span></a>                  <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('title', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>, ENT_QUOTES, 'UTF-8'));
<a name="l685"><span class="linenum"> 685</span></a>                  <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('provider', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>(), ENT_QUOTES, 'UTF-8'));
<a name="l686"><span class="linenum"> 686</span></a>                  <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('xrds', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>('xrds/' . <a class="phpfunction" onClick="logFunction('rawurlencode')" href="../_functions/rawurlencode.html" onMouseOver="phpfuncPopup(event,'rawurlencode')">rawurlencode</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>)), ENT_QUOTES, 'UTF-8'));
<a name="l687"><span class="linenum"> 687</span></a>                  if (<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;local_identity&quot;]) {
<a name="l688"><span class="linenum"> 688</span></a>                      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('local_id', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;identity&quot;], ENT_QUOTES, 'UTF-8'));
<a name="l689"><span class="linenum"> 689</span></a>                  }
<a name="l690"><span class="linenum"> 690</span></a>              }
<a name="l691"><span class="linenum"> 691</span></a>          }
<a name="l692"><span class="linenum"> 692</span></a>      }
<a name="l693"><span class="linenum"> 693</span></a>      
<a name="l694"><span class="linenum"> 694</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.provider');
<a name="l695"><span class="linenum"> 695</span></a>      if (<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;local_identity&quot;]) <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.local_id');
<a name="l696"><span class="linenum"> 696</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main');
<a name="l697"><span class="linenum"> 697</span></a>      <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>('main');
<a name="l698"><span class="linenum"> 698</span></a>  }
<a name="l699"><span class="linenum"> 699</span></a>  
<a name="l700"><span class="linenum"> 700</span></a>  <span class="comment">/**</span>
<a name="l701"><span class="linenum"> 701</span></a>  <span class="comment"> * Returns the public page for a private personal ID.</span>
<a name="l702"><span class="linenum"> 702</span></a>  <span class="comment"> *</span>
<a name="l703"><span class="linenum"> 703</span></a>  <span class="comment"> * @param string $ppid the PPID</span>
<a name="l704"><span class="linenum"> 704</span></a>  <span class="comment"> */</span>
<a name="l705"><span class="linenum"> 705</span></a>  function <a class="function" onClick="logFunction('user_ppid_page')" href="../_functions/user_ppid_page.html" onMouseOver="funcPopup(event,'user_ppid_page')">user_ppid_page</a>(<a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('ppid')" href="../_variables/ppid.html">$ppid</a> = NULL) {
<a name="l706"><span class="linenum"> 706</span></a>      global <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>;
<a name="l707"><span class="linenum"> 707</span></a>      
<a name="l708"><span class="linenum"> 708</span></a>      <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Vary: Accept');
<a name="l709"><span class="linenum"> 709</span></a>              
<a name="l710"><span class="linenum"> 710</span></a>      <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('content_type')" href="../_variables/content_type.html">$content_type</a> = <a class="function" onClick="logFunction('negotiate_content_type')" href="../_functions/negotiate_content_type.html" onMouseOver="funcPopup(event,'negotiate_content_type')">negotiate_content_type</a>(<a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('text/html', 'application/xml', 'application/xhtml+xml', 'application/xrds+xml'));
<a name="l711"><span class="linenum"> 711</span></a>              
<a name="l712"><span class="linenum"> 712</span></a>      if ((<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('content_type')" href="../_variables/content_type.html">$content_type</a> == 'application/xrds+xml') || (<a class="var it66" onMouseOver="hilite(66)" onMouseOut="lolite()" onClick="logVariable('_GET')" href="../_variables/_GET.html">$_GET</a>['format'] == 'xrds')) {
<a name="l713"><span class="linenum"> 713</span></a>          <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Content-Type: application/xrds+xml');
<a name="l714"><span class="linenum"> 714</span></a>          <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Content-Disposition: inline; filename=yadis.xml');
<a name="l715"><span class="linenum"> 715</span></a>      
<a name="l716"><span class="linenum"> 716</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('simpleid_base_url', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>(), ENT_QUOTES, 'UTF-8'));
<a name="l717"><span class="linenum"> 717</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('xrds.user_xrds');
<a name="l718"><span class="linenum"> 718</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('xrds');
<a name="l719"><span class="linenum"> 719</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>('xrds');
<a name="l720"><span class="linenum"> 720</span></a>          return;
<a name="l721"><span class="linenum"> 721</span></a>      } else {
<a name="l722"><span class="linenum"> 722</span></a>          <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('X-XRDS-Location: ' . <a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>('ppid/' . <a class="phpfunction" onClick="logFunction('rawurlencode')" href="../_functions/rawurlencode.html" onMouseOver="phpfuncPopup(event,'rawurlencode')">rawurlencode</a>(<a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('ppid')" href="../_variables/ppid.html">$ppid</a>), 'format=xrds'));
<a name="l723"><span class="linenum"> 723</span></a>                  
<a name="l724"><span class="linenum"> 724</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('title', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Private Personal Identifier'));
<a name="l725"><span class="linenum"> 725</span></a>                  
<a name="l726"><span class="linenum"> 726</span></a>          <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>(<a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('This is a private personal identifier.'));
<a name="l727"><span class="linenum"> 727</span></a>          
<a name="l728"><span class="linenum"> 728</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main');
<a name="l729"><span class="linenum"> 729</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>('main');
<a name="l730"><span class="linenum"> 730</span></a>      }   
<a name="l731"><span class="linenum"> 731</span></a>  }
<a name="l732"><span class="linenum"> 732</span></a>  
<a name="l733"><span class="linenum"> 733</span></a>  <span class="comment">/**</span>
<a name="l734"><span class="linenum"> 734</span></a>  <span class="comment"> * Returns the user's public XRDS page.</span>
<a name="l735"><span class="linenum"> 735</span></a>  <span class="comment"> * </span>
<a name="l736"><span class="linenum"> 736</span></a>  <span class="comment"> * @param string $uid the user ID</span>
<a name="l737"><span class="linenum"> 737</span></a>  <span class="comment"> */</span>
<a name="l738"><span class="linenum"> 738</span></a>  function <a class="function" onClick="logFunction('user_xrds')" href="../_functions/user_xrds.html" onMouseOver="funcPopup(event,'user_xrds')">user_xrds</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>) {
<a name="l739"><span class="linenum"> 739</span></a>      global <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>;
<a name="l740"><span class="linenum"> 740</span></a>      
<a name="l741"><span class="linenum"> 741</span></a>      <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> = <a class="function" onClick="logFunction('user_load')" href="../_functions/user_load.html" onMouseOver="funcPopup(event,'user_load')">user_load</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>);
<a name="l742"><span class="linenum"> 742</span></a>      
<a name="l743"><span class="linenum"> 743</span></a>      if (<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> != NULL) {
<a name="l744"><span class="linenum"> 744</span></a>          <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Content-Type: application/xrds+xml');
<a name="l745"><span class="linenum"> 745</span></a>          <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Content-Disposition: inline; filename=yadis.xml');
<a name="l746"><span class="linenum"> 746</span></a>      
<a name="l747"><span class="linenum"> 747</span></a>          if ((<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> != NULL) &amp;&amp; (<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;local_identity&quot;])) {
<a name="l748"><span class="linenum"> 748</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('local_id', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>[&quot;identity&quot;], ENT_QUOTES, 'UTF-8'));
<a name="l749"><span class="linenum"> 749</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('xrds.user_xrds.local_id');
<a name="l750"><span class="linenum"> 750</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('xrds.user_xrds.local_id2');
<a name="l751"><span class="linenum"> 751</span></a>          }
<a name="l752"><span class="linenum"> 752</span></a>      
<a name="l753"><span class="linenum"> 753</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('simpleid_base_url', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>(), ENT_QUOTES, 'UTF-8'));
<a name="l754"><span class="linenum"> 754</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('xrds.user_xrds');
<a name="l755"><span class="linenum"> 755</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('xrds');
<a name="l756"><span class="linenum"> 756</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>('xrds');
<a name="l757"><span class="linenum"> 757</span></a>      } else {
<a name="l758"><span class="linenum"> 758</span></a>          if (<a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>(PHP_SAPI, 0,3) === 'cgi') {
<a name="l759"><span class="linenum"> 759</span></a>              <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>('Status: 404 Not Found');
<a name="l760"><span class="linenum"> 760</span></a>          } else {
<a name="l761"><span class="linenum"> 761</span></a>              <a class="phpfunction" onClick="logFunction('header')" href="../_functions/header.html" onMouseOver="phpfuncPopup(event,'header')">header</a>(<a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['SERVER_PROTOCOL'] . ' 404 Not Found');
<a name="l762"><span class="linenum"> 762</span></a>          }
<a name="l763"><span class="linenum"> 763</span></a>          
<a name="l764"><span class="linenum"> 764</span></a>          <a class="function" onClick="logFunction('set_message')" href="../_functions/set_message.html" onMouseOver="funcPopup(event,'set_message')">set_message</a>('User &lt;strong&gt;' . <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>, ENT_QUOTES, 'UTF-8') . '&lt;/strong&gt; not found.');
<a name="l765"><span class="linenum"> 765</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main');
<a name="l766"><span class="linenum"> 766</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('out')" href="../_functions/out.html" onMouseOver="funcPopup(event,'out')">out</a>('main');
<a name="l767"><span class="linenum"> 767</span></a>      }
<a name="l768"><span class="linenum"> 768</span></a>  }
<a name="l769"><span class="linenum"> 769</span></a>  
<a name="l770"><span class="linenum"> 770</span></a>  <span class="comment">/**</span>
<a name="l771"><span class="linenum"> 771</span></a>  <span class="comment"> * Returns a block containing OpenID Connect user information.</span>
<a name="l772"><span class="linenum"> 772</span></a>  <span class="comment"> *</span>
<a name="l773"><span class="linenum"> 773</span></a>  <span class="comment"> * @return array the OpenID Connect user information block</span>
<a name="l774"><span class="linenum"> 774</span></a>  <span class="comment"> */</span>
<a name="l775"><span class="linenum"> 775</span></a>  function <a class="function" onClick="logFunction('_user_page_profile')" href="../_functions/_user_page_profile.html" onMouseOver="funcPopup(event,'_user_page_profile')">_user_page_profile</a>() {
<a name="l776"><span class="linenum"> 776</span></a>      global <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l777"><span class="linenum"> 777</span></a>      
<a name="l778"><span class="linenum"> 778</span></a>      <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> = '&lt;p&gt;' . <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('SimpleID may, with your consent, send the following information to sites which supports OpenID Connect.') . '&lt;/p&gt;';    
<a name="l779"><span class="linenum"> 779</span></a>      <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= '&lt;p&gt;' . <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('To change these, &lt;a href=&quot;!url&quot;&gt;edit your identity file&lt;/a&gt;.', <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('!url' =&gt; 'http://simpleid.koinic.net/documentation/getting-started/setting-identity/identity-files')) . '&lt;/p&gt;';
<a name="l780"><span class="linenum"> 780</span></a>      
<a name="l781"><span class="linenum"> 781</span></a>      <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= &quot;&lt;table&gt;&lt;tr&gt;&lt;th&gt;&quot; . <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Member') . &quot;&lt;/th&gt;&lt;th&gt;&quot; . <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Value') . &quot;&lt;/th&gt;&lt;/tr&gt;&quot;;
<a name="l782"><span class="linenum"> 782</span></a>      
<a name="l783"><span class="linenum"> 783</span></a>      if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['user_info'])) {
<a name="l784"><span class="linenum"> 784</span></a>          foreach (<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['user_info'] as <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('member')" href="../_variables/member.html">$member</a> =&gt; <a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>) {
<a name="l785"><span class="linenum"> 785</span></a>              if (<a class="phpfunction" onClick="logFunction('is_array')" href="../_functions/is_array.html" onMouseOver="phpfuncPopup(event,'is_array')">is_array</a>(<a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>)) {
<a name="l786"><span class="linenum"> 786</span></a>                  foreach (<a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a> as <a class="var it186" onMouseOver="hilite(186)" onMouseOut="lolite()" onClick="logVariable('submember')" href="../_variables/submember.html">$submember</a> =&gt; <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('subvalue')" href="../_variables/subvalue.html">$subvalue</a>) {
<a name="l787"><span class="linenum"> 787</span></a>                      <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= &quot;&lt;tr&gt;&lt;td&gt;&quot; . <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('member')" href="../_variables/member.html">$member</a>, ENT_QUOTES, 'UTF-8') . &quot; (&quot; .<a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it186" onMouseOver="hilite(186)" onMouseOut="lolite()" onClick="logVariable('submember')" href="../_variables/submember.html">$submember</a>, ENT_QUOTES, 'UTF-8') . &quot;)&lt;/td&gt;&lt;td&gt;&quot; . <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('subvalue')" href="../_variables/subvalue.html">$subvalue</a>, ENT_QUOTES, 'UTF-8') . &quot;&lt;/td&gt;&lt;/tr&gt;&quot;;
<a name="l788"><span class="linenum"> 788</span></a>                  }
<a name="l789"><span class="linenum"> 789</span></a>              } else {
<a name="l790"><span class="linenum"> 790</span></a>                  <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= &quot;&lt;tr&gt;&lt;td&gt;&quot; . <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('member')" href="../_variables/member.html">$member</a>, ENT_QUOTES, 'UTF-8') . &quot;&lt;/td&gt;&lt;td&gt;&quot; . <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it32" onMouseOver="hilite(32)" onMouseOut="lolite()" onClick="logVariable('value')" href="../_variables/value.html">$value</a>, ENT_QUOTES, 'UTF-8') . &quot;&lt;/td&gt;&lt;/tr&gt;&quot;;
<a name="l791"><span class="linenum"> 791</span></a>              }
<a name="l792"><span class="linenum"> 792</span></a>          }
<a name="l793"><span class="linenum"> 793</span></a>      }
<a name="l794"><span class="linenum"> 794</span></a>      
<a name="l795"><span class="linenum"> 795</span></a>      <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a> .= &quot;&lt;/table&gt;&quot;;
<a name="l796"><span class="linenum"> 796</span></a>      
<a name="l797"><span class="linenum"> 797</span></a>      return <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>(<a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>(
<a name="l798"><span class="linenum"> 798</span></a>          'id' =&gt; 'userinfo',
<a name="l799"><span class="linenum"> 799</span></a>          'title' =&gt; <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('OpenID Connect'),
<a name="l800"><span class="linenum"> 800</span></a>          'content' =&gt; <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('html')" href="../_variables/html.html">$html</a>
<a name="l801"><span class="linenum"> 801</span></a>      ));
<a name="l802"><span class="linenum"> 802</span></a>  }
<a name="l803"><span class="linenum"> 803</span></a>  
<a name="l804"><span class="linenum"> 804</span></a>  <span class="comment">/**</span>
<a name="l805"><span class="linenum"> 805</span></a>  <span class="comment"> * Set up the user section in the header, showing the currently logged in user.</span>
<a name="l806"><span class="linenum"> 806</span></a>  <span class="comment"> *</span>
<a name="l807"><span class="linenum"> 807</span></a>  <span class="comment"> * @param string $state the SimpleID state to retain once the user has logged out,</span>
<a name="l808"><span class="linenum"> 808</span></a>  <span class="comment"> * if required.</span>
<a name="l809"><span class="linenum"> 809</span></a>  <span class="comment"> */</span>
<a name="l810"><span class="linenum"> 810</span></a>  function <a class="function" onClick="logFunction('user_header')" href="../_functions/user_header.html" onMouseOver="funcPopup(event,'user_header')">user_header</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a> = NULL) {
<a name="l811"><span class="linenum"> 811</span></a>      global <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l812"><span class="linenum"> 812</span></a>      global <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>;
<a name="l813"><span class="linenum"> 813</span></a>      
<a name="l814"><span class="linenum"> 814</span></a>      if (<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a> != NULL) {
<a name="l815"><span class="linenum"> 815</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('uid', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['uid'], ENT_QUOTES, 'UTF-8'));
<a name="l816"><span class="linenum"> 816</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('identity', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['identity'], ENT_QUOTES, 'UTF-8'));
<a name="l817"><span class="linenum"> 817</span></a>          if (<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a> != NULL) {
<a name="l818"><span class="linenum"> 818</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('url', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>('logout', 'destination=continue&amp;s=' . <a class="phpfunction" onClick="logFunction('rawurlencode')" href="../_functions/rawurlencode.html" onMouseOver="phpfuncPopup(event,'rawurlencode')">rawurlencode</a>(<a class="var it8" onMouseOver="hilite(8)" onMouseOut="lolite()" onClick="logVariable('state')" href="../_variables/state.html">$state</a>), true)));
<a name="l819"><span class="linenum"> 819</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('logout', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Log out and log in as a different user'));
<a name="l820"><span class="linenum"> 820</span></a>          } else {
<a name="l821"><span class="linenum"> 821</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('url', <a class="phpfunction" onClick="logFunction('htmlspecialchars')" href="../_functions/htmlspecialchars.html" onMouseOver="phpfuncPopup(event,'htmlspecialchars')">htmlspecialchars</a>(<a class="function" onClick="logFunction('simpleid_url')" href="../_functions/simpleid_url.html" onMouseOver="funcPopup(event,'simpleid_url')">simpleid_url</a>('logout', '', true)));
<a name="l822"><span class="linenum"> 822</span></a>              <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('assign')" href="../_functions/assign.html" onMouseOver="funcPopup(event,'assign')">assign</a>('logout', <a class="function" onClick="logFunction('t')" href="../_functions/t.html" onMouseOver="funcPopup(event,'t')">t</a>('Log out'));
<a name="l823"><span class="linenum"> 823</span></a>          }
<a name="l824"><span class="linenum"> 824</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.user.logout');
<a name="l825"><span class="linenum"> 825</span></a>          <a class="var it132" onMouseOver="hilite(132)" onMouseOut="lolite()" onClick="logVariable('xtpl')" href="../_variables/xtpl.html">$xtpl</a>-&gt;<a class="function" onClick="logFunction('parse')" href="../_functions/parse.html" onMouseOver="funcPopup(event,'parse')">parse</a>('main.user');
<a name="l826"><span class="linenum"> 826</span></a>      }
<a name="l827"><span class="linenum"> 827</span></a>  }
<a name="l828"><span class="linenum"> 828</span></a>  
<a name="l829"><span class="linenum"> 829</span></a>  <span class="comment">/**</span>
<a name="l830"><span class="linenum"> 830</span></a>  <span class="comment"> * Verifies a set of credentials using the default user name-password authentication</span>
<a name="l831"><span class="linenum"> 831</span></a>  <span class="comment"> * method.</span>
<a name="l832"><span class="linenum"> 832</span></a>  <span class="comment"> *</span>
<a name="l833"><span class="linenum"> 833</span></a>  <span class="comment"> * @param string $uid the name of the user to verify</span>
<a name="l834"><span class="linenum"> 834</span></a>  <span class="comment"> * @param array $credentials the credentials supplied by the browser</span>
<a name="l835"><span class="linenum"> 835</span></a>  <span class="comment"> * @return bool whether the credentials supplied matches those for the specified</span>
<a name="l836"><span class="linenum"> 836</span></a>  <span class="comment"> * user</span>
<a name="l837"><span class="linenum"> 837</span></a>  <span class="comment"> */</span>
<a name="l838"><span class="linenum"> 838</span></a>  function <a class="function" onClick="logFunction('user_passauth_user_verify_credentials')" href="../_functions/user_passauth_user_verify_credentials.html" onMouseOver="funcPopup(event,'user_passauth_user_verify_credentials')">user_passauth_user_verify_credentials</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>, <a class="var it33" onMouseOver="hilite(33)" onMouseOut="lolite()" onClick="logVariable('credentials')" href="../_variables/credentials.html">$credentials</a>) {
<a name="l839"><span class="linenum"> 839</span></a>      <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('allowed_algorithms')" href="../_variables/allowed_algorithms.html">$allowed_algorithms</a> = <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('md5', 'sha1');
<a name="l840"><span class="linenum"> 840</span></a>      if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('hash_algos')) <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('allowed_algorithms')" href="../_variables/allowed_algorithms.html">$allowed_algorithms</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('allowed_algorithms')" href="../_variables/allowed_algorithms.html">$allowed_algorithms</a>, <a class="phpfunction" onClick="logFunction('hash_algos')" href="../_functions/hash_algos.html" onMouseOver="phpfuncPopup(event,'hash_algos')">hash_algos</a>());
<a name="l841"><span class="linenum"> 841</span></a>      if (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('hash_pbkdf2')) <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('allowed_algorithms')" href="../_variables/allowed_algorithms.html">$allowed_algorithms</a>[] = 'pbkdf2';
<a name="l842"><span class="linenum"> 842</span></a>      
<a name="l843"><span class="linenum"> 843</span></a>      <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a> = <a class="function" onClick="logFunction('user_load')" href="../_functions/user_load.html" onMouseOver="funcPopup(event,'user_load')">user_load</a>(<a class="var it12" onMouseOver="hilite(12)" onMouseOut="lolite()" onClick="logVariable('uid')" href="../_variables/uid.html">$uid</a>);
<a name="l844"><span class="linenum"> 844</span></a>      
<a name="l845"><span class="linenum"> 845</span></a>      if (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a> == NULL) return false;
<a name="l846"><span class="linenum"> 846</span></a>      
<a name="l847"><span class="linenum"> 847</span></a>      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('hash_function_salt')" href="../_variables/hash_function_salt.html">$hash_function_salt</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>['pass'], 3);
<a name="l848"><span class="linenum"> 848</span></a>      
<a name="l849"><span class="linenum"> 849</span></a>      <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../_variables/hash.html">$hash</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('hash_function_salt')" href="../_variables/hash_function_salt.html">$hash_function_salt</a>[0];
<a name="l850"><span class="linenum"> 850</span></a>      <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> = (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('hash_function_salt')" href="../_variables/hash_function_salt.html">$hash_function_salt</a>[1])) ? <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('hash_function_salt')" href="../_variables/hash_function_salt.html">$hash_function_salt</a>[1] : 'md5';    
<a name="l851"><span class="linenum"> 851</span></a>      if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>, <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('allowed_algorithms')" href="../_variables/allowed_algorithms.html">$allowed_algorithms</a>)) <a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a> = 'md5';
<a name="l852"><span class="linenum"> 852</span></a>      <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('salt_suffix')" href="../_variables/salt_suffix.html">$salt_suffix</a> = (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('hash_function_salt')" href="../_variables/hash_function_salt.html">$hash_function_salt</a>[2])) ? ':' . <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('hash_function_salt')" href="../_variables/hash_function_salt.html">$hash_function_salt</a>[2] : '';
<a name="l853"><span class="linenum"> 853</span></a>  
<a name="l854"><span class="linenum"> 854</span></a>      switch (<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>) {
<a name="l855"><span class="linenum"> 855</span></a>          case 'pbkdf2':
<a name="l856"><span class="linenum"> 856</span></a>              <a class="phpfunction" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="phpfuncPopup(event,'list')">list</a> (<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('algo')" href="../_variables/algo.html">$algo</a>, <a class="var it193" onMouseOver="hilite(193)" onMouseOut="lolite()" onClick="logVariable('iterations')" href="../_variables/iterations.html">$iterations</a>, <a class="var it194" onMouseOver="hilite(194)" onMouseOut="lolite()" onClick="logVariable('salt')" href="../_variables/salt.html">$salt</a>) = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('hash_function_salt')" href="../_variables/hash_function_salt.html">$hash_function_salt</a>[2]);
<a name="l857"><span class="linenum"> 857</span></a>              <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a> = (<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('hash')) ? <a class="phpfunction" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="phpfuncPopup(event,'strlen')">strlen</a>(<a class="phpfunction" onClick="logFunction('hash')" href="../_functions/hash.html" onMouseOver="phpfuncPopup(event,'hash')">hash</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('algo')" href="../_variables/algo.html">$algo</a>, '')) : 0;
<a name="l858"><span class="linenum"> 858</span></a>              <a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('test_hash')" href="../_variables/test_hash.html">$test_hash</a> = <a class="function" onClick="logFunction('hash_pbkdf2')" href="../_functions/hash_pbkdf2.html" onMouseOver="funcPopup(event,'hash_pbkdf2')">hash_pbkdf2</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('algo')" href="../_variables/algo.html">$algo</a>, <a class="var it33" onMouseOver="hilite(33)" onMouseOut="lolite()" onClick="logVariable('credentials')" href="../_variables/credentials.html">$credentials</a>['pass'], <a class="var it194" onMouseOver="hilite(194)" onMouseOut="lolite()" onClick="logVariable('salt')" href="../_variables/salt.html">$salt</a>, <a class="var it193" onMouseOver="hilite(193)" onMouseOut="lolite()" onClick="logVariable('iterations')" href="../_variables/iterations.html">$iterations</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a>);
<a name="l859"><span class="linenum"> 859</span></a>              break;
<a name="l860"><span class="linenum"> 860</span></a>          case 'md5':
<a name="l861"><span class="linenum"> 861</span></a>          case 'sha1':
<a name="l862"><span class="linenum"> 862</span></a>              <a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('test_hash')" href="../_variables/test_hash.html">$test_hash</a> = <a class="phpfunction" onClick="logFunction('call_user_func')" href="../_functions/call_user_func.html" onMouseOver="phpfuncPopup(event,'call_user_func')">call_user_func</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>, <a class="var it33" onMouseOver="hilite(33)" onMouseOut="lolite()" onClick="logVariable('credentials')" href="../_variables/credentials.html">$credentials</a>['pass'] . <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('salt_suffix')" href="../_variables/salt_suffix.html">$salt_suffix</a>);
<a name="l863"><span class="linenum"> 863</span></a>              break;
<a name="l864"><span class="linenum"> 864</span></a>          default:
<a name="l865"><span class="linenum"> 865</span></a>              <a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('test_hash')" href="../_variables/test_hash.html">$test_hash</a> = <a class="phpfunction" onClick="logFunction('hash')" href="../_functions/hash.html" onMouseOver="phpfuncPopup(event,'hash')">hash</a>(<a class="var it151" onMouseOver="hilite(151)" onMouseOut="lolite()" onClick="logVariable('function')" href="../_variables/function.html">$function</a>, <a class="var it33" onMouseOver="hilite(33)" onMouseOut="lolite()" onClick="logVariable('credentials')" href="../_variables/credentials.html">$credentials</a>['pass'] . <a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('salt_suffix')" href="../_variables/salt_suffix.html">$salt_suffix</a>);
<a name="l866"><span class="linenum"> 866</span></a>      }
<a name="l867"><span class="linenum"> 867</span></a>  
<a name="l868"><span class="linenum"> 868</span></a>      return <a class="function" onClick="logFunction('secure_compare')" href="../_functions/secure_compare.html" onMouseOver="funcPopup(event,'secure_compare')">secure_compare</a>(<a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('test_hash')" href="../_variables/test_hash.html">$test_hash</a>, <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('hash')" href="../_variables/hash.html">$hash</a>);
<a name="l869"><span class="linenum"> 869</span></a>  }
<a name="l870"><span class="linenum"> 870</span></a>  
<a name="l871"><span class="linenum"> 871</span></a>  <span class="comment">/**</span>
<a name="l872"><span class="linenum"> 872</span></a>  <span class="comment"> * Creates a auto login cookie.  The login cookie will be based on the</span>
<a name="l873"><span class="linenum"> 873</span></a>  <span class="comment"> * current log in user.</span>
<a name="l874"><span class="linenum"> 874</span></a>  <span class="comment"> *</span>
<a name="l875"><span class="linenum"> 875</span></a>  <span class="comment"> * @param string $id the ID of the series of auto login cookies,  Cookies</span>
<a name="l876"><span class="linenum"> 876</span></a>  <span class="comment"> * belonging to the same user and computer have the same ID.  If none is specified,</span>
<a name="l877"><span class="linenum"> 877</span></a>  <span class="comment"> * one will be generated</span>
<a name="l878"><span class="linenum"> 878</span></a>  <span class="comment"> * @param int $expires the time at which the cookie will expire.  If none is specified</span>
<a name="l879"><span class="linenum"> 879</span></a>  <span class="comment"> * the time specified in {@link SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN} will be</span>
<a name="l880"><span class="linenum"> 880</span></a>  <span class="comment"> * used</span>
<a name="l881"><span class="linenum"> 881</span></a>  <span class="comment"> *</span>
<a name="l882"><span class="linenum"> 882</span></a>  <span class="comment"> */</span>
<a name="l883"><span class="linenum"> 883</span></a>  function <a class="function" onClick="logFunction('user_cookieauth_create_cookie')" href="../_functions/user_cookieauth_create_cookie.html" onMouseOver="funcPopup(event,'user_cookieauth_create_cookie')">user_cookieauth_create_cookie</a>(<a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a> = NULL, <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('expires')" href="../_variables/expires.html">$expires</a> = NULL) {
<a name="l884"><span class="linenum"> 884</span></a>      global <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>;
<a name="l885"><span class="linenum"> 885</span></a>      
<a name="l886"><span class="linenum"> 886</span></a>      if (<a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('expires')" href="../_variables/expires.html">$expires</a> == NULL) {
<a name="l887"><span class="linenum"> 887</span></a>          <a class="function" onClick="logFunction('log_debug')" href="../_functions/log_debug.html" onMouseOver="funcPopup(event,'log_debug')">log_debug</a>('Automatic login token created for ' . <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['uid']);
<a name="l888"><span class="linenum"> 888</span></a>      } else {
<a name="l889"><span class="linenum"> 889</span></a>          <a class="function" onClick="logFunction('log_debug')" href="../_functions/log_debug.html" onMouseOver="funcPopup(event,'log_debug')">log_debug</a>('Automatic login token renewed for ' . <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['uid']);
<a name="l890"><span class="linenum"> 890</span></a>      }
<a name="l891"><span class="linenum"> 891</span></a>      
<a name="l892"><span class="linenum"> 892</span></a>      if (<a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a> == NULL) <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a> = <a class="function" onClick="logFunction('random_id')" href="../_functions/random_id.html" onMouseOver="funcPopup(event,'random_id')">random_id</a>();
<a name="l893"><span class="linenum"> 893</span></a>      if (<a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('expires')" href="../_variables/expires.html">$expires</a> == NULL) <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('expires')" href="../_variables/expires.html">$expires</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() + <a class="constant" onClick="logConstant('SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN')" href="../_constants/SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN.html" onMouseOver="constPopup(event,'SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN')">SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN</a>;
<a name="l894"><span class="linenum"> 894</span></a>      <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('token')" href="../_variables/token.html">$token</a> = <a class="function" onClick="logFunction('random_secret')" href="../_functions/random_secret.html" onMouseOver="funcPopup(event,'random_secret')">random_secret</a>();
<a name="l895"><span class="linenum"> 895</span></a>      <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a> = <a class="function" onClick="logFunction('get_form_token')" href="../_functions/get_form_token.html" onMouseOver="funcPopup(event,'get_form_token')">get_form_token</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['uid'], FALSE);
<a name="l896"><span class="linenum"> 896</span></a>  
<a name="l897"><span class="linenum"> 897</span></a>      <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a> = <a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>(
<a name="l898"><span class="linenum"> 898</span></a>          'uid' =&gt; <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('user')" href="../_variables/user.html">$user</a>['uid'],
<a name="l899"><span class="linenum"> 899</span></a>          'token' =&gt; <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('token')" href="../_variables/token.html">$token</a>,
<a name="l900"><span class="linenum"> 900</span></a>          'expires' =&gt; <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('expires')" href="../_variables/expires.html">$expires</a>,
<a name="l901"><span class="linenum"> 901</span></a>          'uaid' =&gt; <a class="function" onClick="logFunction('get_user_agent_id')" href="../_functions/get_user_agent_id.html" onMouseOver="funcPopup(event,'get_user_agent_id')">get_user_agent_id</a>(),
<a name="l902"><span class="linenum"> 902</span></a>          'ip' =&gt; <a class="var it53" onMouseOver="hilite(53)" onMouseOut="lolite()" onClick="logVariable('_SERVER')" href="../_variables/_SERVER.html">$_SERVER</a>['REMOTE_ADDR']
<a name="l903"><span class="linenum"> 903</span></a>      );
<a name="l904"><span class="linenum"> 904</span></a>      
<a name="l905"><span class="linenum"> 905</span></a>      <a class="function" onClick="logFunction('cache_set')" href="../_functions/cache_set.html" onMouseOver="funcPopup(event,'cache_set')">cache_set</a>('autologin-'. <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a>, <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>, <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>);
<a name="l906"><span class="linenum"> 906</span></a>      
<a name="l907"><span class="linenum"> 907</span></a>  <span class="comment">    // Note the last parameter (httponly) requires PHP 5.2</span>
<a name="l908"><span class="linenum"> 908</span></a>      <a class="phpfunction" onClick="logFunction('setcookie')" href="../_functions/setcookie.html" onMouseOver="phpfuncPopup(event,'setcookie')">setcookie</a>(<a class="function" onClick="logFunction('simpleid_cookie_name')" href="../_functions/simpleid_cookie_name.html" onMouseOver="funcPopup(event,'simpleid_cookie_name')">simpleid_cookie_name</a>('auth'), 'cookieauth:' . <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a> . ':' . <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a> . ':' . <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('token')" href="../_variables/token.html">$token</a>, <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('expires')" href="../_variables/expires.html">$expires</a>, <a class="function" onClick="logFunction('get_base_path')" href="../_functions/get_base_path.html" onMouseOver="funcPopup(event,'get_base_path')">get_base_path</a>(), '', false, true);
<a name="l909"><span class="linenum"> 909</span></a>  }
<a name="l910"><span class="linenum"> 910</span></a>  
<a name="l911"><span class="linenum"> 911</span></a>  <span class="comment">/**</span>
<a name="l912"><span class="linenum"> 912</span></a>  <span class="comment"> * Verifies a auto login cookie.  If valid, log in the user automatically.</span>
<a name="l913"><span class="linenum"> 913</span></a>  <span class="comment"> */</span>
<a name="l914"><span class="linenum"> 914</span></a>  function <a class="function" onClick="logFunction('user_cookieauth_user_auto_login')" href="../_functions/user_cookieauth_user_auto_login.html" onMouseOver="funcPopup(event,'user_cookieauth_user_auto_login')">user_cookieauth_user_auto_login</a>() {
<a name="l915"><span class="linenum"> 915</span></a>      if (!<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('_COOKIE')" href="../_variables/_COOKIE.html">$_COOKIE</a>[<a class="function" onClick="logFunction('simpleid_cookie_name')" href="../_functions/simpleid_cookie_name.html" onMouseOver="funcPopup(event,'simpleid_cookie_name')">simpleid_cookie_name</a>('auth')])) return NULL;
<a name="l916"><span class="linenum"> 916</span></a>          
<a name="l917"><span class="linenum"> 917</span></a>      <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('cookie')" href="../_variables/cookie.html">$cookie</a> = <a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('_COOKIE')" href="../_variables/_COOKIE.html">$_COOKIE</a>[<a class="function" onClick="logFunction('simpleid_cookie_name')" href="../_functions/simpleid_cookie_name.html" onMouseOver="funcPopup(event,'simpleid_cookie_name')">simpleid_cookie_name</a>('auth')];
<a name="l918"><span class="linenum"> 918</span></a>      
<a name="l919"><span class="linenum"> 919</span></a>      <a class="phpfunction" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="phpfuncPopup(event,'list')">list</a>(<a class="var it203" onMouseOver="hilite(203)" onMouseOut="lolite()" onClick="logVariable('authtype')" href="../_variables/authtype.html">$authtype</a>, <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a>, <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('token')" href="../_variables/token.html">$token</a>) = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('cookie')" href="../_variables/cookie.html">$cookie</a>);
<a name="l920"><span class="linenum"> 920</span></a>      if (<a class="var it203" onMouseOver="hilite(203)" onMouseOut="lolite()" onClick="logVariable('authtype')" href="../_variables/authtype.html">$authtype</a> != 'cookieauth') return NULL;
<a name="l921"><span class="linenum"> 921</span></a>  
<a name="l922"><span class="linenum"> 922</span></a>      <a class="function" onClick="logFunction('log_debug')" href="../_functions/log_debug.html" onMouseOver="funcPopup(event,'log_debug')">log_debug</a>('Automatic login token detected: ' . <a class="phpfunction" onClick="logFunction('implode')" href="../_functions/implode.html" onMouseOver="phpfuncPopup(event,'implode')">implode</a>(':', <a class="var it204" onMouseOver="hilite(204)" onMouseOut="lolite()" onClick="logVariable('cookieauth')" href="../_variables/cookieauth.html">$cookieauth</a>, <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a>, <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>));
<a name="l923"><span class="linenum"> 923</span></a>      
<a name="l924"><span class="linenum"> 924</span></a>      <a class="function" onClick="logFunction('cache_expire')" href="../_functions/cache_expire.html" onMouseOver="funcPopup(event,'cache_expire')">cache_expire</a>(<a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('autologin-' . <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a> =&gt; <a class="constant" onClick="logConstant('SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN')" href="../_constants/SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN.html" onMouseOver="constPopup(event,'SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN')">SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN</a>));
<a name="l925"><span class="linenum"> 925</span></a>      <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a> = <a class="function" onClick="logFunction('cache_get')" href="../_functions/cache_get.html" onMouseOver="funcPopup(event,'cache_get')">cache_get</a>('autologin-' . <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a>, <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>);
<a name="l926"><span class="linenum"> 926</span></a>      
<a name="l927"><span class="linenum"> 927</span></a>      if (!<a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>) {  // Cookie doesn't exist
<a name="l928"><span class="linenum"> 928</span></a>          <a class="function" onClick="logFunction('log_notice')" href="../_functions/log_notice.html" onMouseOver="funcPopup(event,'log_notice')">log_notice</a>('Automatic login: Token does not exist on server');
<a name="l929"><span class="linenum"> 929</span></a>          return NULL;
<a name="l930"><span class="linenum"> 930</span></a>      }
<a name="l931"><span class="linenum"> 931</span></a>      
<a name="l932"><span class="linenum"> 932</span></a>      if (<a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['expires'] &lt; <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) {  // Cookie expired
<a name="l933"><span class="linenum"> 933</span></a>          <a class="function" onClick="logFunction('log_notice')" href="../_functions/log_notice.html" onMouseOver="funcPopup(event,'log_notice')">log_notice</a>('Automatic login: Token on server expired');
<a name="l934"><span class="linenum"> 934</span></a>          return NULL;
<a name="l935"><span class="linenum"> 935</span></a>      }
<a name="l936"><span class="linenum"> 936</span></a>      
<a name="l937"><span class="linenum"> 937</span></a>      if (<a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['token'] != <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('token')" href="../_variables/token.html">$token</a>) {
<a name="l938"><span class="linenum"> 938</span></a>          <a class="function" onClick="logFunction('log_warn')" href="../_functions/log_warn.html" onMouseOver="funcPopup(event,'log_warn')">log_warn</a>('Automatic login: Token on server does not match');
<a name="l939"><span class="linenum"> 939</span></a>  <span class="comment">        // Token not the same - panic</span>
<a name="l940"><span class="linenum"> 940</span></a>          <a class="function" onClick="logFunction('cache_expire')" href="../_functions/cache_expire.html" onMouseOver="funcPopup(event,'cache_expire')">cache_expire</a>(<a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('autologin-' . <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a> =&gt; 0));
<a name="l941"><span class="linenum"> 941</span></a>          <a class="function" onClick="logFunction('user_cookieauth_invalidate')" href="../_functions/user_cookieauth_invalidate.html" onMouseOver="funcPopup(event,'user_cookieauth_invalidate')">user_cookieauth_invalidate</a>();
<a name="l942"><span class="linenum"> 942</span></a>          return NULL;
<a name="l943"><span class="linenum"> 943</span></a>      }
<a name="l944"><span class="linenum"> 944</span></a>  
<a name="l945"><span class="linenum"> 945</span></a>      if (<a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['uaid'] != <a class="function" onClick="logFunction('get_user_agent_id')" href="../_functions/get_user_agent_id.html" onMouseOver="funcPopup(event,'get_user_agent_id')">get_user_agent_id</a>()) {
<a name="l946"><span class="linenum"> 946</span></a>          <a class="function" onClick="logFunction('log_warn')" href="../_functions/log_warn.html" onMouseOver="funcPopup(event,'log_warn')">log_warn</a>('Automatic login: User agent ID does not match');
<a name="l947"><span class="linenum"> 947</span></a>  <span class="comment">        // Token not the same - panic</span>
<a name="l948"><span class="linenum"> 948</span></a>          <a class="function" onClick="logFunction('cache_expire')" href="../_functions/cache_expire.html" onMouseOver="funcPopup(event,'cache_expire')">cache_expire</a>(<a class="phpfunction" onClick="logFunction('array')" href="../_functions/array.html" onMouseOver="phpfuncPopup(event,'array')">array</a>('autologin-' . <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a> =&gt; 0));
<a name="l949"><span class="linenum"> 949</span></a>          <a class="function" onClick="logFunction('user_cookieauth_invalidate')" href="../_functions/user_cookieauth_invalidate.html" onMouseOver="funcPopup(event,'user_cookieauth_invalidate')">user_cookieauth_invalidate</a>();
<a name="l950"><span class="linenum"> 950</span></a>          return NULL;
<a name="l951"><span class="linenum"> 951</span></a>      }
<a name="l952"><span class="linenum"> 952</span></a>      
<a name="l953"><span class="linenum"> 953</span></a>  <span class="comment">    // Load the user, tag it as an auto log in</span>
<a name="l954"><span class="linenum"> 954</span></a>      <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a> = <a class="function" onClick="logFunction('user_load')" href="../_functions/user_load.html" onMouseOver="funcPopup(event,'user_load')">user_load</a>(<a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['uid']);
<a name="l955"><span class="linenum"> 955</span></a>      
<a name="l956"><span class="linenum"> 956</span></a>      if (<a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a> != NULL) {
<a name="l957"><span class="linenum"> 957</span></a>          <a class="function" onClick="logFunction('log_debug')" href="../_functions/log_debug.html" onMouseOver="funcPopup(event,'log_debug')">log_debug</a>('Automatic login token accepted for ' . <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['uid']);
<a name="l958"><span class="linenum"> 958</span></a>          
<a name="l959"><span class="linenum"> 959</span></a>          <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>['autologin'] = TRUE;
<a name="l960"><span class="linenum"> 960</span></a>      
<a name="l961"><span class="linenum"> 961</span></a>  <span class="comment">        // Renew the token</span>
<a name="l962"><span class="linenum"> 962</span></a>          <a class="function" onClick="logFunction('user_cookieauth_create_cookie')" href="../_functions/user_cookieauth_create_cookie.html" onMouseOver="funcPopup(event,'user_cookieauth_create_cookie')">user_cookieauth_create_cookie</a>(<a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>, <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['expires']);
<a name="l963"><span class="linenum"> 963</span></a>          
<a name="l964"><span class="linenum"> 964</span></a>          return <a class="var it24" onMouseOver="hilite(24)" onMouseOut="lolite()" onClick="logVariable('test_user')" href="../_variables/test_user.html">$test_user</a>;
<a name="l965"><span class="linenum"> 965</span></a>      } else {
<a name="l966"><span class="linenum"> 966</span></a>          <a class="function" onClick="logFunction('log_warn')" href="../_functions/log_warn.html" onMouseOver="funcPopup(event,'log_warn')">log_warn</a>('Automatic login token accepted for ' . <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>['uid'] . ', but no such user exists');
<a name="l967"><span class="linenum"> 967</span></a>          return NULL;
<a name="l968"><span class="linenum"> 968</span></a>      }
<a name="l969"><span class="linenum"> 969</span></a>  }
<a name="l970"><span class="linenum"> 970</span></a>  
<a name="l971"><span class="linenum"> 971</span></a>  <span class="comment">/**</span>
<a name="l972"><span class="linenum"> 972</span></a>  <span class="comment"> * Removes the auto login cookie from the user agent and the SimpleID</span>
<a name="l973"><span class="linenum"> 973</span></a>  <span class="comment"> * cache.</span>
<a name="l974"><span class="linenum"> 974</span></a>  <span class="comment"> */</span>
<a name="l975"><span class="linenum"> 975</span></a>  function <a class="function" onClick="logFunction('user_cookieauth_invalidate')" href="../_functions/user_cookieauth_invalidate.html" onMouseOver="funcPopup(event,'user_cookieauth_invalidate')">user_cookieauth_invalidate</a>() {
<a name="l976"><span class="linenum"> 976</span></a>      if (<a class="phpfunction" onClick="logFunction('isset')" href="../_functions/isset.html" onMouseOver="phpfuncPopup(event,'isset')">isset</a>(<a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('_COOKIE')" href="../_variables/_COOKIE.html">$_COOKIE</a>[<a class="function" onClick="logFunction('simpleid_cookie_name')" href="../_functions/simpleid_cookie_name.html" onMouseOver="funcPopup(event,'simpleid_cookie_name')">simpleid_cookie_name</a>('auth')])) {
<a name="l977"><span class="linenum"> 977</span></a>          <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('cookie')" href="../_variables/cookie.html">$cookie</a> = <a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('_COOKIE')" href="../_variables/_COOKIE.html">$_COOKIE</a>[<a class="function" onClick="logFunction('simpleid_cookie_name')" href="../_functions/simpleid_cookie_name.html" onMouseOver="funcPopup(event,'simpleid_cookie_name')">simpleid_cookie_name</a>('auth')];
<a name="l978"><span class="linenum"> 978</span></a>          
<a name="l979"><span class="linenum"> 979</span></a>          <a class="phpfunction" onClick="logFunction('list')" href="../_functions/list.html" onMouseOver="phpfuncPopup(event,'list')">list</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a>, <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('token')" href="../_variables/token.html">$token</a>) = <a class="phpfunction" onClick="logFunction('explode')" href="../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(':', <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('cookie')" href="../_variables/cookie.html">$cookie</a>);
<a name="l980"><span class="linenum"> 980</span></a>          
<a name="l981"><span class="linenum"> 981</span></a>          <a class="function" onClick="logFunction('cache_delete')" href="../_functions/cache_delete.html" onMouseOver="funcPopup(event,'cache_delete')">cache_delete</a>('autologin-' . <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('uid_hash')" href="../_variables/uid_hash.html">$uid_hash</a>, <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('id')" href="../_variables/id.html">$id</a>);
<a name="l982"><span class="linenum"> 982</span></a>          
<a name="l983"><span class="linenum"> 983</span></a>          <a class="phpfunction" onClick="logFunction('setcookie')" href="../_functions/setcookie.html" onMouseOver="phpfuncPopup(event,'setcookie')">setcookie</a>(<a class="function" onClick="logFunction('simpleid_cookie_name')" href="../_functions/simpleid_cookie_name.html" onMouseOver="funcPopup(event,'simpleid_cookie_name')">simpleid_cookie_name</a>('auth'), &quot;&quot;, <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>() - 3600);
<a name="l984"><span class="linenum"> 984</span></a>      }
<a name="l985"><span class="linenum"> 985</span></a>  }
<a name="l986"><span class="linenum"> 986</span></a>  
<a name="l987"><span class="linenum"> 987</span></a>  <span class="comment">/**</span>
<a name="l988"><span class="linenum"> 988</span></a>  <span class="comment"> * Calculates a Time-Based One-Time Password (TOTP) based on RFC 6238.</span>
<a name="l989"><span class="linenum"> 989</span></a>  <span class="comment"> *</span>
<a name="l990"><span class="linenum"> 990</span></a>  <span class="comment"> * This function returns an integer calculated from the TOTP algorithm.</span>
<a name="l991"><span class="linenum"> 991</span></a>  <span class="comment"> * The returned integer may need to be zero-padded to return a string</span>
<a name="l992"><span class="linenum"> 992</span></a>  <span class="comment"> * with the required number of digits</span>
<a name="l993"><span class="linenum"> 993</span></a>  <span class="comment"> *</span>
<a name="l994"><span class="linenum"> 994</span></a>  <span class="comment"> * @param string $secret the shared secret as a binary string</span>
<a name="l995"><span class="linenum"> 995</span></a>  <span class="comment"> * @param int $time the time to use in the HOTP algorithm.  If NULL, the</span>
<a name="l996"><span class="linenum"> 996</span></a>  <span class="comment"> * current time is used</span>
<a name="l997"><span class="linenum"> 997</span></a>  <span class="comment"> * @param int $period the time step in seconds</span>
<a name="l998"><span class="linenum"> 998</span></a>  <span class="comment"> * @param int $drift the number of time steps to be added to the time to</span>
<a name="l999"><span class="linenum"> 999</span></a>  <span class="comment"> * adjust for transmission delay</span>
<a name="l1000"><span class="linenum">1000</span></a>  <span class="comment"> * @param string $algorithm the hashing algorithm as supported by</span>
<a name="l1001"><span class="linenum">1001</span></a>  <span class="comment"> * the hash_hmac() function</span>
<a name="l1002"><span class="linenum">1002</span></a>  <span class="comment"> * @param int $digits the number of digits in the one-time password</span>
<a name="l1003"><span class="linenum">1003</span></a>  <span class="comment"> * @return int the one-time password</span>
<a name="l1004"><span class="linenum">1004</span></a>  <span class="comment"> * @link http://tools.ietf.org/html/rfc6238</span>
<a name="l1005"><span class="linenum">1005</span></a>  <span class="comment"> */</span>
<a name="l1006"><span class="linenum">1006</span></a>  function <a class="function" onClick="logFunction('user_totp')" href="../_functions/user_totp.html" onMouseOver="funcPopup(event,'user_totp')">user_totp</a>(<a class="var it124" onMouseOver="hilite(124)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../_variables/secret.html">$secret</a>, <a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> = NULL, <a class="var it205" onMouseOver="hilite(205)" onMouseOut="lolite()" onClick="logVariable('period')" href="../_variables/period.html">$period</a> = 30, <a class="var it206" onMouseOver="hilite(206)" onMouseOut="lolite()" onClick="logVariable('drift')" href="../_variables/drift.html">$drift</a> = 0, <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('algorithm')" href="../_variables/algorithm.html">$algorithm</a> = 'sha1', <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('digits')" href="../_variables/digits.html">$digits</a> = 6) {
<a name="l1007"><span class="linenum">1007</span></a>      if (<a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> == NULL) <a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> = <a class="phpfunction" onClick="logFunction('time')" href="../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l1008"><span class="linenum">1008</span></a>      <a class="var it209" onMouseOver="hilite(209)" onMouseOut="lolite()" onClick="logVariable('counter')" href="../_variables/counter.html">$counter</a> = <a class="phpfunction" onClick="logFunction('floor')" href="../_functions/floor.html" onMouseOver="phpfuncPopup(event,'floor')">floor</a>(<a class="var it172" onMouseOver="hilite(172)" onMouseOut="lolite()" onClick="logVariable('time')" href="../_variables/time.html">$time</a> / <a class="var it205" onMouseOver="hilite(205)" onMouseOut="lolite()" onClick="logVariable('period')" href="../_variables/period.html">$period</a>) + <a class="var it206" onMouseOver="hilite(206)" onMouseOut="lolite()" onClick="logVariable('drift')" href="../_variables/drift.html">$drift</a>;
<a name="l1009"><span class="linenum">1009</span></a>      <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a> = <a class="phpfunction" onClick="logFunction('pack')" href="../_functions/pack.html" onMouseOver="phpfuncPopup(event,'pack')">pack</a>('NN', 0, <a class="var it209" onMouseOver="hilite(209)" onMouseOut="lolite()" onClick="logVariable('counter')" href="../_variables/counter.html">$counter</a>);
<a name="l1010"><span class="linenum">1010</span></a>      return <a class="function" onClick="logFunction('user_hotp')" href="../_functions/user_hotp.html" onMouseOver="funcPopup(event,'user_hotp')">user_hotp</a>(<a class="var it124" onMouseOver="hilite(124)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../_variables/secret.html">$secret</a>, <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('algorithm')" href="../_variables/algorithm.html">$algorithm</a>, <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('digits')" href="../_variables/digits.html">$digits</a>);
<a name="l1011"><span class="linenum">1011</span></a>  }
<a name="l1012"><span class="linenum">1012</span></a>  
<a name="l1013"><span class="linenum">1013</span></a>  <span class="comment">/**</span>
<a name="l1014"><span class="linenum">1014</span></a>  <span class="comment"> * Calculates a HMAC-Based One-Time Password (HOTP) based on RFC 4226.</span>
<a name="l1015"><span class="linenum">1015</span></a>  <span class="comment"> *</span>
<a name="l1016"><span class="linenum">1016</span></a>  <span class="comment"> * This function returns an integer calculated from the HOTP algorithm.</span>
<a name="l1017"><span class="linenum">1017</span></a>  <span class="comment"> * The returned integer may need to be zero-padded to return a string</span>
<a name="l1018"><span class="linenum">1018</span></a>  <span class="comment"> * with the required number of digits</span>
<a name="l1019"><span class="linenum">1019</span></a>  <span class="comment"> *</span>
<a name="l1020"><span class="linenum">1020</span></a>  <span class="comment"> * @param string $secret the shared secret as a binary string</span>
<a name="l1021"><span class="linenum">1021</span></a>  <span class="comment"> * @param string $data the counter value as a 64 bit in</span>
<a name="l1022"><span class="linenum">1022</span></a>  <span class="comment"> * big endian encoding</span>
<a name="l1023"><span class="linenum">1023</span></a>  <span class="comment"> * @param string $algorithm the hashing algorithm as supported by</span>
<a name="l1024"><span class="linenum">1024</span></a>  <span class="comment"> * the hash_hmac() function</span>
<a name="l1025"><span class="linenum">1025</span></a>  <span class="comment"> * @param int $digits the number of digits in the one-time password</span>
<a name="l1026"><span class="linenum">1026</span></a>  <span class="comment"> * @return int the one-time password</span>
<a name="l1027"><span class="linenum">1027</span></a>  <span class="comment"> * @link http://tools.ietf.org/html/rfc4226</span>
<a name="l1028"><span class="linenum">1028</span></a>  <span class="comment"> */</span>
<a name="l1029"><span class="linenum">1029</span></a>  function <a class="function" onClick="logFunction('user_hotp')" href="../_functions/user_hotp.html" onMouseOver="funcPopup(event,'user_hotp')">user_hotp</a>(<a class="var it124" onMouseOver="hilite(124)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../_variables/secret.html">$secret</a>, <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('algorithm')" href="../_variables/algorithm.html">$algorithm</a> = 'sha1', <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('digits')" href="../_variables/digits.html">$digits</a> = 6) {
<a name="l1030"><span class="linenum">1030</span></a>  <span class="comment">    // unpack produces a 1-based array, we use array_merge to convert it to 0-based</span>
<a name="l1031"><span class="linenum">1031</span></a>      <a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('hmac')" href="../_variables/hmac.html">$hmac</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="phpfunction" onClick="logFunction('unpack')" href="../_functions/unpack.html" onMouseOver="phpfuncPopup(event,'unpack')">unpack</a>('C*', <a class="phpfunction" onClick="logFunction('hash_hmac')" href="../_functions/hash_hmac.html" onMouseOver="phpfuncPopup(event,'hash_hmac')">hash_hmac</a>(<a class="phpfunction" onClick="logFunction('strtolower')" href="../_functions/strtolower.html" onMouseOver="phpfuncPopup(event,'strtolower')">strtolower</a>(<a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('algorithm')" href="../_variables/algorithm.html">$algorithm</a>), <a class="var it15" onMouseOver="hilite(15)" onMouseOut="lolite()" onClick="logVariable('data')" href="../_variables/data.html">$data</a>, <a class="var it124" onMouseOver="hilite(124)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../_variables/secret.html">$secret</a>, true)));
<a name="l1032"><span class="linenum">1032</span></a>      <a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('offset')" href="../_variables/offset.html">$offset</a> = <a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('hmac')" href="../_variables/hmac.html">$hmac</a>[19] &amp; 0xf;
<a name="l1033"><span class="linenum">1033</span></a>      <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('code')" href="../_variables/code.html">$code</a> = (<a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('hmac')" href="../_variables/hmac.html">$hmac</a>[<a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('offset')" href="../_variables/offset.html">$offset</a> + 0] &amp; 0x7F) &lt;&lt; 24 |
<a name="l1034"><span class="linenum">1034</span></a>          (<a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('hmac')" href="../_variables/hmac.html">$hmac</a>[<a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('offset')" href="../_variables/offset.html">$offset</a> + 1] &amp; 0xFF) &lt;&lt; 16 |
<a name="l1035"><span class="linenum">1035</span></a>          (<a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('hmac')" href="../_variables/hmac.html">$hmac</a>[<a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('offset')" href="../_variables/offset.html">$offset</a> + 2] &amp; 0xFF) &lt;&lt; 8 |
<a name="l1036"><span class="linenum">1036</span></a>          (<a class="var it129" onMouseOver="hilite(129)" onMouseOut="lolite()" onClick="logVariable('hmac')" href="../_variables/hmac.html">$hmac</a>[<a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('offset')" href="../_variables/offset.html">$offset</a> + 3] &amp; 0xFF);
<a name="l1037"><span class="linenum">1037</span></a>      return <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('code')" href="../_variables/code.html">$code</a> % <a class="phpfunction" onClick="logFunction('pow')" href="../_functions/pow.html" onMouseOver="phpfuncPopup(event,'pow')">pow</a>(10, <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('digits')" href="../_variables/digits.html">$digits</a>);
<a name="l1038"><span class="linenum">1038</span></a>  }
<a name="l1039"><span class="linenum">1039</span></a>  
<a name="l1040"><span class="linenum">1040</span></a>  
<a name="l1041"><span class="linenum">1041</span></a>  if (!<a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('hash_pbkdf2') &amp;&amp; <a class="phpfunction" onClick="logFunction('function_exists')" href="../_functions/function_exists.html" onMouseOver="phpfuncPopup(event,'function_exists')">function_exists</a>('hash_hmac')) {
<a name="l1042"><span class="linenum">1042</span></a>      function <a class="function" onClick="logFunction('hash_pbkdf2')" href="../_functions/hash_pbkdf2.html" onMouseOver="funcPopup(event,'hash_pbkdf2')">hash_pbkdf2</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('algo')" href="../_variables/algo.html">$algo</a>, <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, <a class="var it194" onMouseOver="hilite(194)" onMouseOut="lolite()" onClick="logVariable('salt')" href="../_variables/salt.html">$salt</a>, <a class="var it193" onMouseOver="hilite(193)" onMouseOut="lolite()" onClick="logVariable('iterations')" href="../_variables/iterations.html">$iterations</a>, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a> = 0, <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('raw_output')" href="../_variables/raw_output.html">$raw_output</a> = false) {
<a name="l1043"><span class="linenum">1043</span></a>          <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> = '';
<a name="l1044"><span class="linenum">1044</span></a>          <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('hLen')" href="../_variables/hLen.html">$hLen</a> = <a class="phpfunction" onClick="logFunction('strlen')" href="../_functions/strlen.html" onMouseOver="phpfuncPopup(event,'strlen')">strlen</a>(<a class="phpfunction" onClick="logFunction('hash')" href="../_functions/hash.html" onMouseOver="phpfuncPopup(event,'hash')">hash</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('algo')" href="../_variables/algo.html">$algo</a>, '', true));
<a name="l1045"><span class="linenum">1045</span></a>          if (<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a> == 0) {
<a name="l1046"><span class="linenum">1046</span></a>              <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a> = <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('hLen')" href="../_variables/hLen.html">$hLen</a>;
<a name="l1047"><span class="linenum">1047</span></a>              if (!<a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('raw_output')" href="../_variables/raw_output.html">$raw_output</a>) <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a> *= 2;
<a name="l1048"><span class="linenum">1048</span></a>          }
<a name="l1049"><span class="linenum">1049</span></a>          <a class="var it214" onMouseOver="hilite(214)" onMouseOut="lolite()" onClick="logVariable('l')" href="../_variables/l.html">$l</a> = <a class="phpfunction" onClick="logFunction('ceil')" href="../_functions/ceil.html" onMouseOver="phpfuncPopup(event,'ceil')">ceil</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a> / <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('hLen')" href="../_variables/hLen.html">$hLen</a>);
<a name="l1050"><span class="linenum">1050</span></a>  
<a name="l1051"><span class="linenum">1051</span></a>          for (<a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> = 1; <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a> &lt;= <a class="var it214" onMouseOver="hilite(214)" onMouseOut="lolite()" onClick="logVariable('l')" href="../_variables/l.html">$l</a>; <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>++) {
<a name="l1052"><span class="linenum">1052</span></a>              <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('U')" href="../_variables/U.html">$U</a> = <a class="phpfunction" onClick="logFunction('hash_hmac')" href="../_functions/hash_hmac.html" onMouseOver="phpfuncPopup(event,'hash_hmac')">hash_hmac</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('algo')" href="../_variables/algo.html">$algo</a>, <a class="var it194" onMouseOver="hilite(194)" onMouseOut="lolite()" onClick="logVariable('salt')" href="../_variables/salt.html">$salt</a> . <a class="phpfunction" onClick="logFunction('pack')" href="../_functions/pack.html" onMouseOver="phpfuncPopup(event,'pack')">pack</a>('N', <a class="var it83" onMouseOver="hilite(83)" onMouseOut="lolite()" onClick="logVariable('i')" href="../_variables/i.html">$i</a>), <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, true);
<a name="l1053"><span class="linenum">1053</span></a>              <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('T')" href="../_variables/T.html">$T</a> = <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('U')" href="../_variables/U.html">$U</a>;
<a name="l1054"><span class="linenum">1054</span></a>              for (<a class="var it217" onMouseOver="hilite(217)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a> = 1; <a class="var it217" onMouseOver="hilite(217)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a> &lt; <a class="var it193" onMouseOver="hilite(193)" onMouseOut="lolite()" onClick="logVariable('iterations')" href="../_variables/iterations.html">$iterations</a>; <a class="var it217" onMouseOver="hilite(217)" onMouseOut="lolite()" onClick="logVariable('j')" href="../_variables/j.html">$j</a>++) {
<a name="l1055"><span class="linenum">1055</span></a>                  <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('T')" href="../_variables/T.html">$T</a> ^= (<a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('U')" href="../_variables/U.html">$U</a> = <a class="phpfunction" onClick="logFunction('hash_hmac')" href="../_functions/hash_hmac.html" onMouseOver="phpfuncPopup(event,'hash_hmac')">hash_hmac</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('algo')" href="../_variables/algo.html">$algo</a>, <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('U')" href="../_variables/U.html">$U</a>, <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('password')" href="../_variables/password.html">$password</a>, true));
<a name="l1056"><span class="linenum">1056</span></a>              }
<a name="l1057"><span class="linenum">1057</span></a>              <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> .= <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('T')" href="../_variables/T.html">$T</a>;
<a name="l1058"><span class="linenum">1058</span></a>          }
<a name="l1059"><span class="linenum">1059</span></a>  
<a name="l1060"><span class="linenum">1060</span></a>          return <a class="phpfunction" onClick="logFunction('substr')" href="../_functions/substr.html" onMouseOver="phpfuncPopup(event,'substr')">substr</a>((<a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('raw_output')" href="../_variables/raw_output.html">$raw_output</a>) ? <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a> : <a class="phpfunction" onClick="logFunction('bin2hex')" href="../_functions/bin2hex.html" onMouseOver="phpfuncPopup(event,'bin2hex')">bin2hex</a>(<a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('result')" href="../_variables/result.html">$result</a>), 0, <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('length')" href="../_variables/length.html">$length</a>);
<a name="l1061"><span class="linenum">1061</span></a>      }
<a name="l1062"><span class="linenum">1062</span></a>  }
<a name="l1063"><span class="linenum">1063</span></a>  
<a name="l1064"><span class="linenum">1064</span></a>  
<a name="l1065"><span class="linenum">1065</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'extension_invoke_all': ['extension_invoke_all', 'Invokes a hook in all the loaded extensions. ', [['www','common.inc',343],['www','common.inc.php',606]], 17],
'unpickle': ['unpickle', 'Deserialises data specified in a URL parameter as a variable. ', [['www','common.inc',184],['www','common.inc.php',338]], 6],
'openid_get_version': ['openid_get_version', 'Detects the OpenID version of the current request ', [['www','openid.inc',91],['www','openid.inc.php',91]], 4],
'user_cookieauth_user_auto_login': ['user_cookieauth_user_auto_login', 'Verifies a auto login cookie.  If valid, log in the user automatically. ', [['www','user.inc.php',911]], 0],
'user_init': ['user_init', 'Initialises the user system.  Loads data for the currently logged-in user, if any. ', [['www','user.inc.php',56],['www','user.inc',56]], 2],
'cache_expire': ['cache_expire', 'Garbage collects data stored the cache.  Data is deleted if it was stored for longer than the specified expiry. ', [['www','cache.inc.php',142]], 7],
'user_login': ['user_login', 'Attempts to log in a user, using the user name and password specified in the HTTP request. ', [['www','user.inc.php',166],['www','user.inc',140]], 0],
'indirect_fatal_error': ['indirect_fatal_error', 'Displays a fatal error message and exits. ', [['www','common.inc',49],['www','common.inc.php',49]], 32],
'get_form_token': ['get_form_token', 'Obtains a form token given a form ID. ', [['www','common.inc',272],['www','common.inc.php',518]], 14],
'cache_get': ['cache_get', 'Obtains data from the cache. ', [['www','cache.inc.php',58],['www','cache.inc',57]], 17],
'is_https': ['is_https', 'Determines whether the current connection with the user agent is via HTTPS. ', [['www','common.inc',82],['www','common.inc.php',82]], 9],
'user_ppid_page': ['user_ppid_page', 'Returns the public page for a private personal ID. ', [['www','user.inc.php',700],['www','user.inc',399]], 0],
'get_user_agent_id': ['get_user_agent_id', 'Assigns and returns a unique ID for the user agent (UAID). ', [['www','common.inc.php',231]], 3],
'user_cookieauth_create_cookie': ['user_cookieauth_create_cookie', 'Creates a auto login cookie.  The login cookie will be based on the current log in user. ', [['www','user.inc.php',871]], 2],
't': ['t', 'Translates a string. ', [['www','locale.inc.php',49]], 183],
'random_id': ['random_id', 'Generates a relatively unique identifier which can be used as, among other things, an OpenID association handle or an OAuth client identifier.  The identifier returned is at least 24 characters long and contains only hexadecimal characters. ', [['www','random.inc.php',91],['www','random.inc',91]], 3],
'log_info': ['log_info', 'Logs an INFO message. ', [['www','log.inc',81],['www','log.inc.php',94]], 28],
'user_passauth_user_verify_credentials': ['user_passauth_user_verify_credentials', 'Verifies a set of credentials using the default user name-password authentication method. ', [['www','user.inc.php',829]], 0],
'cache_delete': ['cache_delete', 'Deletes data from the cache. ', [['www','cache.inc.php',99],['www','cache.inc',98]], 12],
'check_https': ['check_https', 'Ensure the current connection with the user agent is secure with HTTPS. ', [['www','common.inc.php',101]], 8],
'user_xrds': ['user_xrds', 'Returns the user\'s public XRDS page. ', [['www','user.inc.php',733],['www','user.inc',430]], 2],
'store_user_save': ['store_user_save', 'Saves user data for a specific user name. ', [['www','filesystem.store.php',224],['www','filesystem.store.inc',176]], 2],
'bignum_val': ['bignum_val', 'Converts a bignum into a string representation (base 10) or a byte stream (base 256) ', [['www','bignum.inc',82],['www','bignum.inc.php',96]], 8],
'log_debug': ['log_debug', 'Logs a DEBUG message. ', [['www','log.inc',71],['www','log.inc.php',84]], 23],
'random_bytes': ['random_bytes', 'Obtains a number of random bytes.  This function uses an entropy source specified in SIMPLEID_RAND_SOURCE.  If SIMPLEID_RAND_SOURCE is not available, the mt_rand() PHP function is used ', [['www','random.inc.php',40],['www','random.inc',40]], 10],
'_user_login': ['_user_login', 'Sets the user specified by the parameter as the active user. ', [['www','user.inc.php',387],['www','user.inc',244]], 4],
'page_dashboard': ['page_dashboard', 'Displays the dashboard page. ', [['www','page.inc.php',32],['www','page.inc',32]], 7],
'user_auto_login': ['user_auto_login', 'Attempts to automatically login using credentials presented by the user agent. ', [['www','user.inc.php',92]], 1],
'openid_nonce': ['openid_nonce', 'Generates a nonce for use in OpenID responses ', [['www','openid.inc',691],['www','openid.inc.php',623]], 3],
'user_verify_otp': ['user_verify_otp', 'Verifies a one time password (OTP) specified by the user. ', [['www','user.inc.php',337]], 2],
'user_load_from_identity': ['user_load_from_identity', 'Loads user data for a specified OpenID Identity URI. ', [['www','user.inc.php',141],['www','user.inc',115]], 1],
'user_load': ['user_load', 'Loads user data for a specified user name. ', [['www','user.inc.php',115],['www','user.inc',89]], 18],
'_user_page_profile': ['_user_page_profile', 'Returns a block containing OpenID Connect user information. ', [['www','user.inc.php',770]], 1],
'header_response_code': ['header_response_code', 'Send a HTTP response code to the user agent. ', [['www','common.inc',64],['www','common.inc.php',64]], 10],
'simpleid_assertion_response': ['simpleid_assertion_response', 'Sends an OpenID assertion response. ', [['www','index.php',1152]], 9],
'store_user_load': ['store_user_load', 'Loads user data for a specified user name. ', [['www','filesystem.store.php',73],['www','filesystem.store.inc',73]], 5],
'user_cookieauth_invalidate': ['user_cookieauth_invalidate', 'Removes the auto login cookie from the user agent and the SimpleID cache. ', [['www','user.inc.php',971]], 3],
'validate_form_token': ['validate_form_token', 'Checks whether a form token is valid ', [['www','common.inc',298],['www','common.inc.php',541]], 7],
'store_get_uid': ['store_get_uid', 'Finds the user name from a specified OpenID Identity URI. ', [['www','filesystem.store.php',137],['www','filesystem.store.inc',141]], 2],
'user_save': ['user_save', 'Stores user data for a specified user name. ', [['www','user.inc.php',156],['www','user.inc',130]], 9],
'extension_invoke': ['extension_invoke', 'Invokes a hook in a specified extension. ', [['www','common.inc',372],['www','common.inc.php',635]], 2],
'hash_pbkdf2': ['hash_pbkdf2', '', [['www','user.inc.php',1042]], 1],
'log_warn': ['log_warn', 'Logs a WARN message. ', [['www','log.inc',101],['www','log.inc.php',114]], 12],
'cache_set': ['cache_set', 'Stores data into the cache. ', [['www','cache.inc.php',37],['www','cache.inc',37]], 15],
'simpleid_url': ['simpleid_url', 'Obtains a SimpleID URL.  URLs produced by SimpleID should use this function. ', [['www','common.inc',241],['www','common.inc.php',422]], 44],
'secure_compare': ['secure_compare', 'Compares two strings using the same time whether they\'re equal or not. This function should be used to mitigate timing attacks when, for example, comparing password hashes ', [['www','common.inc.php',349]], 1],
'user_header': ['user_header', 'Set up the user section in the header, showing the currently logged in user. ', [['www','user.inc.php',804],['www','user.inc',463]], 7],
'bignum_new': ['bignum_new', 'Creates a bignum. ', [['www','bignum.inc',54],['www','bignum.inc.php',54]], 19],
'user_otp_page': ['user_otp_page', 'Displays the page used to set up login verification using one-time passwords. ', [['www','user.inc.php',556]], 0],
'out': ['out', 'prints the parsed text ', [['www/lib','xtemplate.class.php',777],['www/lib','xtemplate-php4.class.php',761]], 28],
'user_totp': ['user_totp', 'Calculates a Time-Based One-Time Password (TOTP) based on RFC 6238. ', [['www','user.inc.php',987]], 2],
'assign': ['assign', 'assign a variable ', [['www/lib','xtemplate.class.php',438],['www/lib','xtemplate-php4.class.php',422]], 245],
'store_user_exists': ['store_user_exists', 'Returns whether the user name exists in the user store. ', [['www','filesystem.store.php',58],['www','filesystem.store.inc',58]], 2],
'openid_indirect_response': ['openid_indirect_response', 'Sends an indirect response to a URL. ', [['www','openid.inc',187],['www','openid.inc.php',173]], 7],
'parse': ['parse', 'Parses an XRDS document. ', [['www','discovery.inc',552],['www/lib','xtemplate.class.php',511],['www/lib','xtemplate-php4.class.php',495],['www','discovery.inc.php',462]], 122],
'simpleid_checkid_error': ['simpleid_checkid_error', 'Returns an OpenID response indicating a generic negative assertion. ', [['www','index.php',807]], 6],
'user_hotp': ['user_hotp', 'Calculates a HMAC-Based One-Time Password (HOTP) based on RFC 4226. ', [['www','user.inc.php',1013]], 1],
'get_base_path': ['get_base_path', 'Returns the base URL path, relative to the current host, of the SimpleID installation. ', [['www','common.inc',213],['www','common.inc.php',384]], 20],
'user_logout': ['user_logout', 'Attempts to log out a user and returns to the login form. ', [['www','user.inc.php',420],['www','user.inc',258]], 0],
'user_verify_credentials': ['user_verify_credentials', 'Verifies a set of credentials for a specified user. ', [['www','user.inc.php',293]], 1],
'_user_logout': ['_user_logout', 'Logs out the user by deleting the relevant session information. ', [['www','user.inc.php',448],['www','user.inc',283]], 4],
'log_notice': ['log_notice', 'Logs a NOTICE message. ', [['www','log.inc',91],['www','log.inc.php',104]], 11],
'random_secret': ['random_secret', 'Obtains a random string of a specified number of bytes of entropy. ', [['www','random.inc.php',70],['www','random.inc',70]], 1],
'simpleid_cookie_name': ['simpleid_cookie_name', 'Returns a relatively unique cookie name based on a specified suffix and SIMPLEID_BASE_URL. ', [['www','common.inc.php',502]], 10],
'user_public_page': ['user_public_page', 'Returns the user\'s public page. ', [['www','user.inc.php',653],['www','user.inc',352]], 0],
'user_login_form': ['user_login_form', 'Displays a user login or a login verification form. ', [['www','user.inc.php',466],['www','user.inc',297]], 26],
'negotiate_content_type': ['negotiate_content_type', 'Content type negotiation using the Accept Header. ', [['www','common.inc',100],['www','common.inc.php',254]], 5],
'set_message': ['set_message', 'Sets a message to display to the user on the rendered SimpleID page. ', [['www','common.inc',37],['www','common.inc.php',37]], 46],
'session_start': ['session_start', '', [], 2],
'ini_get': ['ini_get', '', [], 18],
'list': ['list', '', [], 28],
'strlen': ['strlen', '', [], 34],
'substr': ['substr', '', [], 92],
'intval': ['intval', '', [], 3],
'pow': ['pow', '', [], 1],
'pack': ['pack', '', [], 11],
'time': ['time', '', [], 27],
'session_id': ['session_id', '', [], 9],
'unpack': ['unpack', '', [], 7],
'explode': ['explode', '', [], 53],
'isset': ['isset', '', [], 405],
'setcookie': ['setcookie', '', [], 5],
'ceil': ['ceil', '', [], 1],
'unset': ['unset', '', [], 30],
'array_merge': ['array_merge', '', [], 47],
'rawurlencode': ['rawurlencode', '', [], 26],
'function_exists': ['function_exists', '', [], 49],
'strtr': ['strtr', '', [], 11],
'addslashes': ['addslashes', '', [], 6],
'session_name': ['session_name', '', [], 2],
'session_set_cookie_params': ['session_set_cookie_params', '', [], 2],
'hash_hmac': ['hash_hmac', '', [], 8],
'implode': ['implode', '', [], 26],
'in_array': ['in_array', '', [], 38],
'hash': ['hash', '', [], 6],
'header': ['header', '', [], 63],
'array': ['array', '', [], 390],
'gmstrftime': ['gmstrftime', '', [], 6],
'bin2hex': ['bin2hex', '', [], 7],
'strtotime': ['strtotime', '', [], 4],
'session_destroy': ['session_destroy', '', [], 2],
'is_array': ['is_array', '', [], 36],
'htmlspecialchars': ['htmlspecialchars', '', [], 87],
'floor': ['floor', '', [], 3],
'call_user_func': ['call_user_func', '', [], 7],
'strtolower': ['strtolower', '', [], 35],
'define': ['define', '', [], 95],
'hash_algos': ['hash_algos', '', [], 7]};
CLASS_DATA={
};
CONST_DATA={
'SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN': ['SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN', '', [['www','user.inc.php',46],['www','user.inc',46]], 6],
'SIMPLEID_LOGIN_NONCE_EXPIRES_IN': ['SIMPLEID_LOGIN_NONCE_EXPIRES_IN', '', [['www','user.inc.php',40],['www','user.inc',40]], 6]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Mon Apr  6 15:06:20 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
