<!DOCTYPE html>
<html>
<head>
    <title>PHPXRef 0.7.1 : SimpleID : Detail view of openid.inc</title>
    <link rel="stylesheet" href="../xref.css" type="text/css">
    <link rel="stylesheet" href="../xref-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
</head>
<body>
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of SimpleID</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7.1 at Mon Apr  6 15:06:20 2015 -->
<!-- PHPXref (c) 2000-2010 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../';
subdir='www';
filename='openid.inc.html';
cookiekey='simpleid';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="details-heading"><a href="./index.html">/www/</a> -> <a href="openid.inc.source.html">openid.inc</a> (summary)</h2>
<div class="details-summary">
<p class="viewlinks">[<a href="openid.inc.source.html">Source view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="../_stats.html">Project Stats</a>]</p>
<p><b>OpenID related functions.</b></p>
<table>
<tr><td align="right">File Size: </td><td>1128 lines (39 kb)</td></tr>
<tr><td align="right">Included or required:</td><td>0 times</td></tr>
<tr><td align="right" valign="top">Referenced: </td><td>0 times</td></tr>
<tr><td align="right" valign="top">Includes or requires: </td><td>2 files<br>&nbsp;<a href="../www/bignum.inc.html">www/bignum.inc</a>
<br>&nbsp;<a href="../www/random.inc.html">www/random.inc</a>
</td></tr>
</table>
<h3>Defines 40 functions</h3>
<div class="inset">
&nbsp;&nbsp;<a href="#openid_get_version">openid_get_version</a>()<br>
&nbsp;&nbsp;<a href="#openid_direct_message">openid_direct_message</a>()<br>
&nbsp;&nbsp;<a href="#openid_direct_response">openid_direct_response</a>()<br>
&nbsp;&nbsp;<a href="#openid_indirect_message">openid_indirect_message</a>()<br>
&nbsp;&nbsp;<a href="#openid_indirect_response">openid_indirect_response</a>()<br>
&nbsp;&nbsp;<a href="#openid_indirect_response_url">openid_indirect_response_url</a>()<br>
&nbsp;&nbsp;<a href="#openid_urlencode_message">openid_urlencode_message</a>()<br>
&nbsp;&nbsp;<a href="#openid_direct_error">openid_direct_error</a>()<br>
&nbsp;&nbsp;<a href="#openid_indirect_error">openid_indirect_error</a>()<br>
&nbsp;&nbsp;<a href="#openid_get_realm">openid_get_realm</a>()<br>
&nbsp;&nbsp;<a href="#openid_parse_direct_message">openid_parse_direct_message</a>()<br>
&nbsp;&nbsp;<a href="#openid_parse_query">openid_parse_query</a>()<br>
&nbsp;&nbsp;<a href="#openid_fix_request">openid_fix_request</a>()<br>
&nbsp;&nbsp;<a href="#openid_parse_request">openid_parse_request</a>()<br>
&nbsp;&nbsp;<a href="#openid_url_matches_realm">openid_url_matches_realm</a>()<br>
&nbsp;&nbsp;<a href="#openid_realm_discovery_url">openid_realm_discovery_url</a>()<br>
&nbsp;&nbsp;<a href="#openid_verify_return_to">openid_verify_return_to</a>()<br>
&nbsp;&nbsp;<a href="#openid_extension_filter_request">openid_extension_filter_request</a>()<br>
&nbsp;&nbsp;<a href="#openid_extension_requested">openid_extension_requested</a>()<br>
&nbsp;&nbsp;<a href="#openid_extension_alias">openid_extension_alias</a>()<br>
&nbsp;&nbsp;<a href="#openid_nonce">openid_nonce</a>()<br>
&nbsp;&nbsp;<a href="#openid_association_types">openid_association_types</a>()<br>
&nbsp;&nbsp;<a href="#openid_session_types">openid_session_types</a>()<br>
&nbsp;&nbsp;<a href="#openid_dh_server_assoc">openid_dh_server_assoc</a>()<br>
&nbsp;&nbsp;<a href="#openid_dh_consumer_assoc">openid_dh_consumer_assoc</a>()<br>
&nbsp;&nbsp;<a href="#openid_dh_shared_secret">openid_dh_shared_secret</a>()<br>
&nbsp;&nbsp;<a href="#openid_dh_generate_key_pair">openid_dh_generate_key_pair</a>()<br>
&nbsp;&nbsp;<a href="#openid_encrypt_mac_key">openid_encrypt_mac_key</a>()<br>
&nbsp;&nbsp;<a href="#_openid_xor">_openid_xor</a>()<br>
&nbsp;&nbsp;<a href="#_openid_dh_rand">_openid_dh_rand</a>()<br>
&nbsp;&nbsp;<a href="#_openid_base64_to_bignum">_openid_base64_to_bignum</a>()<br>
&nbsp;&nbsp;<a href="#_openid_bignum_to_base64">_openid_bignum_to_base64</a>()<br>
&nbsp;&nbsp;<a href="#_openid_btwoc">_openid_btwoc</a>()<br>
&nbsp;&nbsp;<a href="#openid_sign">openid_sign</a>()<br>
&nbsp;&nbsp;<a href="#_openid_signature_base_string">_openid_signature_base_string</a>()<br>
&nbsp;&nbsp;<a href="#_openid_sha1">_openid_sha1</a>()<br>
&nbsp;&nbsp;<a href="#_openid_hmac_sha1">_openid_hmac_sha1</a>()<br>
&nbsp;&nbsp;<a href="#_openid_sha256">_openid_sha256</a>()<br>
&nbsp;&nbsp;<a href="#_openid_hmac_sha256">_openid_hmac_sha256</a>()<br>
&nbsp;&nbsp;<a href="#rfc3986_urlencode">rfc3986_urlencode</a>()<br>
</div>
</div>
<br><div class="details-funclist">
<div class="details-classtitle"><a name="functions"><b>Functions</b></a></div>
<div class="details-classinfo">
Functions that are not part of a class:<br><br>
<div class="inset"><table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_get_version" onClick="logFunction('openid_get_version', 'openid.inc.source.html#l91')" href="openid.inc.source.html#l91">openid_get_version</a>(<a href="../_variables/request.html">$request</a>, <a href="../_variables/key.html">$key</a> = 'openid.ns')&nbsp;&nbsp;
<a href="../_functions/openid_get_version.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Detects the OpenID version of the current request<BR>
</b><BR><b>return:</b> float either OPENID_VERSION_2 or OPENID_VERSION_1_1<br>
<b>param:</b> mixed $request the OpenID request<br>
<b>param:</b> string $key the key to look for to determine the OpenID<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_direct_message" onClick="logFunction('openid_direct_message', 'openid.inc.source.html#l107')" href="openid.inc.source.html#l107">openid_direct_message</a>(<a href="../_variables/data.html">$data</a>, <a href="../_variables/version.html">$version</a> = OPENID_VERSION_2)&nbsp;&nbsp;
<a href="../_functions/openid_direct_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Creates a OpenID message for direct response.<BR>
</b><BR>The response will be encoded using Key-Value Form Encoding.<BR>
<BR>
<b>return:</b> string the message in key-value form encoding<br>
<b>param:</b> array $data the data in the response<br>
<b>param:</b> float $version the message version<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_direct_response" onClick="logFunction('openid_direct_response', 'openid.inc.source.html#l146')" href="openid.inc.source.html#l146">openid_direct_response</a>(<a href="../_variables/message.html">$message</a>, <a href="../_variables/status.html">$status</a> = '200 OK')&nbsp;&nbsp;
<a href="../_functions/openid_direct_response.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Sends a direct response.<BR>
</b><BR><b>param:</b> string $message an OpenID message encoded using Key-Value Form<br>
<b>param:</b> string $status the HTTP status to send<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_indirect_message" onClick="logFunction('openid_indirect_message', 'openid.inc.source.html#l163')" href="openid.inc.source.html#l163">openid_indirect_message</a>(<a href="../_variables/data.html">$data</a>, <a href="../_variables/version.html">$version</a> = OPENID_VERSION_2)&nbsp;&nbsp;
<a href="../_functions/openid_indirect_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Creates a OpenID message for indirect response.<BR>
</b><BR>The response will be encoded using HTTP Encoding.<BR>
<BR>
<b>return:</b> array the message<br>
<b>param:</b> array $data the data in the response<br>
<b>param:</b> float $version the message version<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_indirect_response" onClick="logFunction('openid_indirect_response', 'openid.inc.source.html#l187')" href="openid.inc.source.html#l187">openid_indirect_response</a>(<a href="../_variables/url.html">$url</a>, <a href="../_variables/message.html">$message</a>, <a href="../_variables/component.html">$component</a> = OPENID_RESPONSE_QUERY)&nbsp;&nbsp;
<a href="../_functions/openid_indirect_response.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Sends an indirect response to a URL.<BR>
</b><BR>The indirect message is encoded in the URL and returned to the user agent using<BR>
a HTTP redirect response.&nbsp;&nbsp;The message can be encoded in either the query component<BR>
or the fragment component of the URL.<BR>
<BR>
<b>param:</b> string $url the URL to which the response is to be sent<br>
<b>param:</b> array|string $message an OpenID message, which can either be an array of keys<br>
<b>param:</b> int $component the component of the URL in which the indirect message is<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_indirect_response_url" onClick="logFunction('openid_indirect_response_url', 'openid.inc.source.html#l211')" href="openid.inc.source.html#l211">openid_indirect_response_url</a>(<a href="../_variables/url.html">$url</a>, <a href="../_variables/message.html">$message</a>, <a href="../_variables/component.html">$component</a> = OPENID_RESPONSE_QUERY)&nbsp;&nbsp;
<a href="../_functions/openid_indirect_response_url.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Encodes an indirect message into a URL<BR>
</b><BR><b>return:</b> string the URL to which the response is to be sent, with the<br>
<b>param:</b> string $url the URL to which the response is to be sent<br>
<b>param:</b> array|string $message an OpenID message, which can either be an array of keys<br>
<b>param:</b> int $component the component of the URL in which the indirect message is<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_urlencode_message" onClick="logFunction('openid_urlencode_message', 'openid.inc.source.html#l267')" href="openid.inc.source.html#l267">openid_urlencode_message</a>(<a href="../_variables/message.html">$message</a>)&nbsp;&nbsp;
<a href="../_functions/openid_urlencode_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Encodes a message in application/x-www-form-urlencoded format.<BR>
</b><BR><b>return:</b> string the encoded message<br>
<b>param:</b> array $message the OpenID message to encode<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_direct_error" onClick="logFunction('openid_direct_error', 'openid.inc.source.html#l284')" href="openid.inc.source.html#l284">openid_direct_error</a>(<a href="../_variables/error.html">$error</a>, <a href="../_variables/additional.html">$additional</a> = array()&nbsp;&nbsp;
<a href="../_functions/openid_direct_error.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Sends a direct message indicating an error.&nbsp;&nbsp;This is a convenience function<BR>
for {@link openid_direct_response()}.<BR>
</b><BR><b>param:</b> string $error the error message<br>
<b>param:</b> array $additional any additional data to be sent with the error<br>
<b>param:</b> float $version the message version<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_indirect_error" onClick="logFunction('openid_indirect_error', 'openid.inc.source.html#l298')" href="openid.inc.source.html#l298">openid_indirect_error</a>(<a href="../_variables/url.html">$url</a>, <a href="../_variables/error.html">$error</a>, <a href="../_variables/additional.html">$additional</a> = array()&nbsp;&nbsp;
<a href="../_functions/openid_indirect_error.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Sends an indirect message indicating an error.&nbsp;&nbsp;This is a convenience function<BR>
for {@link openid_indirect_response()}.<BR>
</b><BR><b>param:</b> string $url the URL to which the error message is to be sent<br>
<b>param:</b> string $error the error message<br>
<b>param:</b> array $additional any additional data to be sent with the error<br>
<b>param:</b> float $version the message version<br>
<b>param:</b> int $component the component of the URL in which the indirect message is<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_get_realm" onClick="logFunction('openid_get_realm', 'openid.inc.source.html#l315')" href="openid.inc.source.html#l315">openid_get_realm</a>(<a href="../_variables/request.html">$request</a>, <a href="../_variables/version.html">$version</a>)&nbsp;&nbsp;
<a href="../_functions/openid_get_realm.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Gets the realm from the OpenID request.&nbsp;&nbsp;This is specified differently<BR>
depending on the OpenID version.<BR>
</b><BR><b>return:</b> string the realm URI<br>
<b>param:</b> mixed $request the OpenID request<br>
<b>param:</b> float $version the OpenID version for the message<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_parse_direct_message" onClick="logFunction('openid_parse_direct_message', 'openid.inc.source.html#l339')" href="openid.inc.source.html#l339">openid_parse_direct_message</a>(<a href="../_variables/message.html">$message</a>)&nbsp;&nbsp;
<a href="../_functions/openid_parse_direct_message.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Parses a direct message.<BR>
</b><BR><b>return:</b> array an array containing the parsed key-value pairs<br>
<b>param:</b> string $message the direct message to parse<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_parse_query" onClick="logFunction('openid_parse_query', 'openid.inc.source.html#l359')" href="openid.inc.source.html#l359">openid_parse_query</a>(<a href="../_variables/query.html">$query</a>)&nbsp;&nbsp;
<a href="../_functions/openid_parse_query.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Parses a query string.<BR>
</b><BR>Query strings can be used to receive OpenID indirect messages.<BR>
<BR>
<b>return:</b> array an array containing the parsed key-value pairs<br>
<b>param:</b> string $query the query string to parse<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_fix_request" onClick="logFunction('openid_fix_request', 'openid.inc.source.html#l385')" href="openid.inc.source.html#l385">openid_fix_request</a>()&nbsp;&nbsp;
<a href="../_functions/openid_fix_request.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Fix PHP's handling of request data.&nbsp;&nbsp;PHP changes dots in all request parameters<BR>
to underscores when creating the $_GET, $_POST and $_REQUEST arrays.<BR>
</b><BR>This function scans the original query string and POST parameters and fixes<BR>
them.<BR>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_parse_request" onClick="logFunction('openid_parse_request', 'openid.inc.source.html#l439')" href="openid.inc.source.html#l439">openid_parse_request</a>(<a href="../_variables/request.html">$request</a>)&nbsp;&nbsp;
<a href="../_functions/openid_parse_request.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Parses the OpenID request to extract namespace information.<BR>
</b><BR>This function builds a map between namespace aliases and their Type URIs.<BR>
<BR>
<b>param:</b> array $request the OpenID request<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_url_matches_realm" onClick="logFunction('openid_url_matches_realm', 'openid.inc.source.html#l457')" href="openid.inc.source.html#l457">openid_url_matches_realm</a>(<a href="../_variables/url.html">$url</a>, <a href="../_variables/realm.html">$realm</a>)&nbsp;&nbsp;
<a href="../_functions/openid_url_matches_realm.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Determines whether a URL matches a realm.<BR>
</b><BR>A URL matches a realm if:<BR>
<BR>
1. The URL scheme and port of the URL are identical to those in the realm.<BR>
See RFC 3986, section 3.1 for rules about URI matching.<BR>
2. The URL's path is equal to or a sub-directory of the realm's path.<BR>
3. Either:<BR>
(a) The realm's domain contains the wild-card characters &quot;*.&quot;, and the<BR>
trailing part of the URL's domain is identical to the part of the<BR>
realm following the &quot;*.&quot; wildcard, or<BR>
(b) The URL's domain is identical to the realm's domain<BR>
<BR>
<b>return:</b> bool true if the URL matches the realm<br>
<b>param:</b> string $url to URL to test<br>
<b>param:</b> string $realm the realm<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_realm_discovery_url" onClick="logFunction('openid_realm_discovery_url', 'openid.inc.source.html#l512')" href="openid.inc.source.html#l512">openid_realm_discovery_url</a>(<a href="../_variables/realm.html">$realm</a>)&nbsp;&nbsp;
<a href="../_functions/openid_realm_discovery_url.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Returns the URL of a relying party endpoint for a specified realm.&nbsp;&nbsp;This URL<BR>
is used to discover services associated with the realm.<BR>
</b><BR>If the realm's domain contains the wild-card characters &quot;*.&quot;, this is substituted<BR>
with &quot;www.&quot;.<BR>
<BR>
<b>param:</b> string $realm the realm<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_verify_return_to" onClick="logFunction('openid_verify_return_to', 'openid.inc.source.html#l542')" href="openid.inc.source.html#l542">openid_verify_return_to</a>(<a href="../_variables/return_to.html">$return_to</a>, <a href="../_variables/actual_url.html">$actual_url</a>)&nbsp;&nbsp;
<a href="../_functions/openid_verify_return_to.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Verifies a return_to URL against the actual URL of the HTTP request.<BR>
</b><BR>The return_to URL matches if:<BR>
<BR>
- The URL scheme, authority, and path are the same; and<BR>
- Any query parameters that are present in the return_to URL are also present<BR>
with the same values in the actual request.<BR>
<BR>
<b>return:</b> bool true if the URLs match<br>
<b>param:</b> string $return_to the URL specified in the openid.return_to parameter<br>
<b>param:</b> string $actual_url the actual URL requested<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_extension_filter_request" onClick="logFunction('openid_extension_filter_request', 'openid.inc.source.html#l592')" href="openid.inc.source.html#l592">openid_extension_filter_request</a>(<a href="../_variables/ns.html">$ns</a>, <a href="../_variables/request.html">$request</a>)&nbsp;&nbsp;
<a href="../_functions/openid_extension_filter_request.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Filters an OpenID request to find keys specific to an extension, as specified<BR>
by the Type URI.<BR>
</b><BR>For exmaple, if the extension has the Type URI http://example.com/ and the<BR>
alias example, this function will return an array of all the keys in the<BR>
OpenID request which starts with openid.example<BR>
<BR>
<b>return:</b> array the filtered request, with the prefix (in the example above,<br>
<b>param:</b> string $ns the Type URI of the extension<br>
<b>param:</b> array $request the OpenID request<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_extension_requested" onClick="logFunction('openid_extension_requested', 'openid.inc.source.html#l627')" href="openid.inc.source.html#l627">openid_extension_requested</a>(<a href="../_variables/ns.html">$ns</a>, <a href="../_variables/request.html">$request</a>)&nbsp;&nbsp;
<a href="../_functions/openid_extension_requested.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Determines whether an extension is present in an OpenID request.<BR>
</b><BR><b>return:</b> bool true if the extension is present in the request<br>
<b>param:</b> string $ns the Type URI of the extension<br>
<b>param:</b> array $request the OpenID request<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_extension_alias" onClick="logFunction('openid_extension_alias', 'openid.inc.source.html#l651')" href="openid.inc.source.html#l651">openid_extension_alias</a>(<a href="../_variables/ns.html">$ns</a>, <a href="../_variables/create.html">$create</a> = FALSE)&nbsp;&nbsp;
<a href="../_functions/openid_extension_alias.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Returns the OpenID alias for an extension, given a Type URI, based on the<BR>
alias definitions in the current OpenID request.<BR>
</b><BR><b>return:</b> string the alias, or NULL if the Type URI does not already<br>
<b>param:</b> string $ns the Type URI<br>
<b>param:</b> bool|string $create whether to create an alias if the Type URI does not already<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_nonce" onClick="logFunction('openid_nonce', 'openid.inc.source.html#l691')" href="openid.inc.source.html#l691">openid_nonce</a>()&nbsp;&nbsp;
<a href="../_functions/openid_nonce.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Generates a nonce for use in OpenID responses<BR>
</b><BR><b>return:</b> string an OpenID nonce<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_association_types" onClick="logFunction('openid_association_types', 'openid.inc.source.html#l703')" href="openid.inc.source.html#l703">openid_association_types</a>()&nbsp;&nbsp;
<a href="../_functions/openid_association_types.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Returns the association types supported by this server.<BR>
</b><BR><b>return:</b> array an array containing the association types supported by this server as keys<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_session_types" onClick="logFunction('openid_session_types', 'openid.inc.source.html#l716')" href="openid.inc.source.html#l716">openid_session_types</a>(<a href="../_variables/is_https.html">$is_https</a> = FALSE, <a href="../_variables/version.html">$version</a> = OPENID_VERSION_2)&nbsp;&nbsp;
<a href="../_functions/openid_session_types.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Returns the association types supported by this server and the version of<BR>
OpenID.<BR>
</b><BR>OpenID version 1 supports an empty string as the session type.&nbsp;&nbsp;OpenID version 2<BR>
reqires a session type to be sent.<BR>
<BR>
<b>return:</b> array an array containing the session types supported by this server as keys<br>
<b>param:</b> bool $is_https whether the transport layer encryption is used for the current<br>
<b>param:</b> float $version the OpenID version, either OPENID_VERSION_1_1 and OPENID_VERSION_2<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_dh_server_assoc" onClick="logFunction('openid_dh_server_assoc', 'openid.inc.source.html#l743')" href="openid.inc.source.html#l743">openid_dh_server_assoc</a>(<a href="../_variables/mac_key.html">$mac_key</a>, <a href="../_variables/dh_consumer_public.html">$dh_consumer_public</a>, <a href="../_variables/dh_modulus.html">$dh_modulus</a> = NULL, <a href="../_variables/dh_gen.html">$dh_gen</a> = NULL, <a href="../_variables/hash_func.html">$hash_func</a> = '_openid_sha1')&nbsp;&nbsp;
<a href="../_functions/openid_dh_server_assoc.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Generates the cryptographic values required for responding to association<BR>
requests<BR>
</b><BR>This involves generating a key pair for the OpenID provider, then calculating<BR>
the shared secret.&nbsp;&nbsp;The shared secret is then used to encrypt the MAC key.<BR>
<BR>
<b>return:</b> array an array containing (a) dh_server_public - the server's public key (in Base64), and (b)<br>
<b>param:</b> string $mac_key the MAC key, in binary representation<br>
<b>param:</b> string $dh_consumer_public the consumer's public key, in Base64 representation<br>
<b>param:</b> string $dh_modulus modulus - a large prime number<br>
<b>param:</b> string $dh_gen generator - a primitive root modulo<br>
<b>param:</b> string $hash_func the hash function<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_dh_consumer_assoc" onClick="logFunction('openid_dh_consumer_assoc', 'openid.inc.source.html#l772')" href="openid.inc.source.html#l772">openid_dh_consumer_assoc</a>(<a href="../_variables/enc_mac_key.html">$enc_mac_key</a>, <a href="../_variables/dh_server_public.html">$dh_server_public</a>, <a href="../_variables/dh_consumer_private.html">$dh_consumer_private</a>, <a href="../_variables/dh_modulus.html">$dh_modulus</a> = NULL, <a href="../_variables/hash_func.html">$hash_func</a> = '_openid_sha1')&nbsp;&nbsp;
<a href="../_functions/openid_dh_consumer_assoc.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Complete association by obtaining the session MAC key from the key obtained<BR>
from the Diffie-Hellman key exchange<BR>
</b><BR><b>return:</b> string the decrypted session MAC key, in Base64 representation<br>
<b>param:</b> string $enc_mac_key the encrypted session MAC key, in Base64 represnetation<br>
<b>param:</b> string $dh_server_public the server's public key, in Base64 representation<br>
<b>param:</b> string $dh_consumer_private the consumer's private key, in Base64 representation<br>
<b>param:</b> string $dh_modulus modulus, in Base64 representation<br>
<b>param:</b> string $hash_func the hash function<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_dh_shared_secret" onClick="logFunction('openid_dh_shared_secret', 'openid.inc.source.html#l793')" href="openid.inc.source.html#l793">openid_dh_shared_secret</a>(<a href="../_variables/their_public.html">$their_public</a>, <a href="../_variables/my_private.html">$my_private</a>, <a href="../_variables/dh_modulus.html">$dh_modulus</a> = NULL)&nbsp;&nbsp;
<a href="../_functions/openid_dh_shared_secret.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Calculates the shared secret for Diffie-Hellman key exchange.<BR>
</b><BR>This is the second step in the Diffle-Hellman key exchange process.&nbsp;&nbsp;The other<BR>
party (in OpenID 1.0 terms, the consumer) has already generated the public<BR>
key ($dh_consumer_public) and sent it to this party (the server).&nbsp;&nbsp;The Diffie-Hellman<BR>
modulus ($dh_modulus) and generator ($dh_gen) have either been sent or previously agreed.<BR>
<BR>
<b>return:</b> resource the shared secret (as a bignum)<br>
<b>param:</b> string $their_public the other party's public key, in Base64 representation<br>
<b>param:</b> string $my_private this party's private key, in Base64 representation<br>
<b>param:</b> string $dh_modulus modulus, in Base64 representation<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_dh_generate_key_pair" onClick="logFunction('openid_dh_generate_key_pair', 'openid.inc.source.html#l826')" href="openid.inc.source.html#l826">openid_dh_generate_key_pair</a>(<a href="../_variables/dh_modulus.html">$dh_modulus</a> = NULL, <a href="../_variables/dh_gen.html">$dh_gen</a> = NULL)&nbsp;&nbsp;
<a href="../_functions/openid_dh_generate_key_pair.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Generates a key pair for Diffie-Hellman key exchange.<BR>
</b><BR><b>return:</b> array an array containing: (a) private - the private key, in Base64<br>
<b>param:</b> string $dh_modulus modulus, in Base64 representation<br>
<b>param:</b> string $dh_gen generator, in Base64 representation<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_encrypt_mac_key" onClick="logFunction('openid_encrypt_mac_key', 'openid.inc.source.html#l858')" href="openid.inc.source.html#l858">openid_encrypt_mac_key</a>(<a href="../_variables/ZZ.html">$ZZ</a>, <a href="../_variables/mac_key.html">$mac_key</a>, <a href="../_variables/hash_func.html">$hash_func</a> = '_openid_sha1')&nbsp;&nbsp;
<a href="../_functions/openid_encrypt_mac_key.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Encrypts/decrypts and encodes the MAC key.<BR>
</b><BR><b>return:</b> string the encrypted MAC key in Base64 representation<br>
<b>param:</b> resource $ZZ the Diffie-Hellman key exchange shared secret as a bignum<br>
<b>param:</b> string $mac_key a byte stream containing the MAC key<br>
<b>param:</b> string $hash_func the hash function<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_xor" onClick="logFunction('_openid_xor', 'openid.inc.source.html#l876')" href="openid.inc.source.html#l876">_openid_xor</a>(<a href="../_variables/key.html">$key</a>, <a href="../_variables/plain_cipher.html">$plain_cipher</a>, <a href="../_variables/hash_func.html">$hash_func</a> = '_openid_sha1')&nbsp;&nbsp;
<a href="../_functions/_openid_xor.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Encrypts/decrypts using XOR.<BR>
</b><BR><b>return:</b> string the ciphertext or plaintext<br>
<b>param:</b> string $key the encryption key as a bignum.&nbsp;&nbsp;This is usually<br>
<b>param:</b> string $plain_cipher the plaintext or ciphertext<br>
<b>param:</b> string $hash_func the hash function<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_dh_rand" onClick="logFunction('_openid_dh_rand', 'openid.inc.source.html#l897')" href="openid.inc.source.html#l897">_openid_dh_rand</a>(<a href="../_variables/stop.html">$stop</a>)&nbsp;&nbsp;
<a href="../_functions/_openid_dh_rand.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Generates a random integer, which will be used to derive a private key<BR>
for Diffie-Hellman key exchange.&nbsp;&nbsp;The integer must be less than $stop<BR>
</b><BR><b>return:</b> resource the random integer as a bignum<br>
<b>param:</b> resource $stop a prime number as a bignum<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_base64_to_bignum" onClick="logFunction('_openid_base64_to_bignum', 'openid.inc.source.html#l942')" href="openid.inc.source.html#l942">_openid_base64_to_bignum</a>(<a href="../_variables/str.html">$str</a>)&nbsp;&nbsp;
<a href="../_functions/_openid_base64_to_bignum.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Converts an arbitary precision integer, encoded in Base64, to a bignum<BR>
</b><BR><b>return:</b> resource the string representation<br>
<b>param:</b> string $str arbitary precision integer, encoded in Base64<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_bignum_to_base64" onClick="logFunction('_openid_bignum_to_base64', 'openid.inc.source.html#l952')" href="openid.inc.source.html#l952">_openid_bignum_to_base64</a>(<a href="../_variables/str.html">$str</a>)&nbsp;&nbsp;
<a href="../_functions/_openid_bignum_to_base64.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Converts a string representation of an integer to an arbitary precision<BR>
integer, then converts it to Base64 encoding.<BR>
</b><BR><b>return:</b> string the Base64 encoded arbitary precision integer<br>
<b>param:</b> string $str the string representation<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_btwoc" onClick="logFunction('_openid_btwoc', 'openid.inc.source.html#l963')" href="openid.inc.source.html#l963">_openid_btwoc</a>(<a href="../_variables/num.html">$num</a>)&nbsp;&nbsp;
<a href="../_functions/_openid_btwoc.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Encode an integer as big-endian signed two's complement binary string.<BR>
</b><BR><b>return:</b> string the signed two's complement binary string<br>
<b>param:</b> string $num the binary integer<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="openid_sign" onClick="logFunction('openid_sign', 'openid.inc.source.html#l975')" href="openid.inc.source.html#l975">openid_sign</a>(<a href="../_variables/data.html">$data</a>, <a href="../_variables/keys.html">$keys</a>, <a href="../_variables/mac_key.html">$mac_key</a>, <a href="../_variables/hmac_func.html">$hmac_func</a> = '_openid_hmac_sha1', <a href="../_variables/version.html">$version</a> = OPENID_VERSION_2)&nbsp;&nbsp;
<a href="../_functions/openid_sign.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Calculates a signature of an OpenID message<BR>
</b><BR><b>return:</b> string the signature encoded in Base64<br>
<b>param:</b> array $data the data in the message<br>
<b>param:</b> array $keys a list of keys in the message to be signed (without the<br>
<b>param:</b> string $mac_key the MAC key used to sign the message, in Base64 representation<br>
<b>param:</b> string $hmac_func the HMAC function used in the signing process<br>
<b>param:</b> float $version the OpenID version<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_signature_base_string" onClick="logFunction('_openid_signature_base_string', 'openid.inc.source.html#l1003')" href="openid.inc.source.html#l1003">_openid_signature_base_string</a>(<a href="../_variables/data.html">$data</a>, <a href="../_variables/version.html">$version</a>)&nbsp;&nbsp;
<a href="../_functions/_openid_signature_base_string.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Calculates the base string from which an OpenID signature is generated.<BR>
</b><BR>OpenID versions 1 and 2 specify that messages are to be encoded using Key-Value<BR>
Encoding when generating signatures.&nbsp;&nbsp;However, future OpenID version may<BR>
specify different ways of encoding the message, such as OAuth.<BR>
<BR>
<b>return:</b> string the signature base string<br>
<b>param:</b> array $data the data to sign<br>
<b>param:</b> float $version the OpenID version<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_sha1" onClick="logFunction('_openid_sha1', 'openid.inc.source.html#l1029')" href="openid.inc.source.html#l1029">_openid_sha1</a>(<a href="../_variables/text.html">$text</a>)&nbsp;&nbsp;
<a href="../_functions/_openid_sha1.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Obtains the SHA1 hash of a string in binary representation.<BR>
</b><BR><b>return:</b> string the hash in binary representation<br>
<b>param:</b> string $text the text to be hashed<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_hmac_sha1" onClick="logFunction('_openid_hmac_sha1', 'openid.inc.source.html#l1045')" href="openid.inc.source.html#l1045">_openid_hmac_sha1</a>(<a href="../_variables/key.html">$key</a>, <a href="../_variables/text.html">$text</a>)&nbsp;&nbsp;
<a href="../_functions/_openid_hmac_sha1.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Obtains the keyed hash value using the HMAC method and the SHA1 algorithm<BR>
</b><BR><b>return:</b> string the hash in binary representation<br>
<b>param:</b> string $key the key in binary representation<br>
<b>param:</b> string $text the text to be hashed<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_sha256" onClick="logFunction('_openid_sha256', 'openid.inc.source.html#l1080')" href="openid.inc.source.html#l1080">_openid_sha256</a>(<a href="../_variables/text.html">$text</a>)&nbsp;&nbsp;
<a href="../_functions/_openid_sha256.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Obtains the SHA256 hash of a string in binary representation.<BR>
</b><BR><b>return:</b> string $hash the hash in binary representation<br>
<b>param:</b> string $text the text to be hashed<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="_openid_hmac_sha256" onClick="logFunction('_openid_hmac_sha256', 'openid.inc.source.html#l1090')" href="openid.inc.source.html#l1090">_openid_hmac_sha256</a>(<a href="../_variables/key.html">$key</a>, <a href="../_variables/text.html">$text</a>)&nbsp;&nbsp;
<a href="../_functions/_openid_hmac_sha256.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Obtains the keyed hash value using the HMAC method and the SHA256 algorithm<BR>
</b><BR><b>return:</b> string the hash in binary representation<br>
<b>param:</b> string $key the key in binary representation<br>
<b>param:</b> string $text the text to be hashed<br>
</td></tr></table>

<br>
<table border="0" width="80%" class="funcinfo"><tr class="funcinfo-title"><td>
<a name="rfc3986_urlencode" onClick="logFunction('rfc3986_urlencode', 'openid.inc.source.html#l1106')" href="openid.inc.source.html#l1106">rfc3986_urlencode</a>(<a href="../_variables/s.html">$s</a>)&nbsp;&nbsp;
<a href="../_functions/rfc3986_urlencode.html"><small>X-Ref</small></a>
</td></tr><tr class="funcinfo-body"><td><b>Encodes a URL using RFC 3986.<BR>
</b><BR>PHP's rfc3986_urlencode function encodes a URL using RFC 1738 for PHP versions<BR>
prior to 5.3.&nbsp;&nbsp;RFC 1738 has been<BR>
updated by RFC 3986, which change the list of characters which needs to be<BR>
encoded.<BR>
<BR>
Strictly correct encoding is required for various purposes, such as OAuth<BR>
signature base strings.<BR>
<BR>
<b>return:</b> string the encoded URL<br>
<b>param:</b> string $s the URL to encode<br>
</td></tr></table>

<br>
</div></div>

</div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Mon Apr  6 15:06:20 2015</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7.1</a></i></td>
	</tr>
</table>
</body></html>
