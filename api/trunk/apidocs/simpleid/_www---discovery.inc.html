<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs for page discovery.inc</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="file-name">/www/discovery.inc</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
							<a href="#sec-classes">Classes</a>
			|							<a href="#sec-includes">Includes</a>
			|							<a href="#sec-constants">Constants</a>
			|									<a href="#sec-functions">Functions</a>
			</div>
	<div class="info-box-body">	
		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Support for XRDS and XRD based discovery.</p>
<p class="description"><p>The functions for this file supports HTTP-based identifiers.  For XRIs, the  resolution service xri.net is used to resolve to HTTP-based URLs.</p></p>
	<ul class="tags">
				<li><span class="field">since:</span> 0.7</li>
				<li><span class="field">filesource:</span> <a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html">Source Code for this file</a></li>
			</ul>
		
			</div>
</div>
		
	<a name="sec-classes"></a>	
	<div class="info-box">
		<div class="info-box-title">Classes</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
			<span class="disabled">Classes</span>
			|							<a href="#sec-includes">Includes</a>
				|										<a href="#sec-constants">Constants</a>
				|													<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<table cellpadding="2" cellspacing="0" class="class-table">
				<tr>
					<th class="class-table-header">Class</th>
					<th class="class-table-header">Description</th>
				</tr>
								<tr>
					<td style="padding-right: 2em; vertical-align: top">
						
					</td>
					<td>
											A simple XRDS parser.
										</td>
				</tr>
							</table>
		</div>
	</div>

	<a name="sec-includes"></a>	
	<div class="info-box">
		<div class="info-box-title">Includes</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
							<a href="#sec-classes">Classes</a>
				|						<span class="disabled">Includes</span>
			|							<a href="#sec-constants">Constants</a>
				|													<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<a name="_http_inc"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="include-title">
			<span class="include-type">include_once</span>
			(<span class="include-name"><a href="../simpleid/_www---http.inc.html">"http.inc"</a></span>)
			(line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a35">35</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
		</div>
	</div>
	
	<a name="sec-constants"></a>	
	<div class="info-box">
		<div class="info-box-title">Constants</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
							<a href="#sec-classes">Classes</a>
				|										<a href="#sec-includes">Includes</a>
				|						<span class="disabled">Constants</span>
			|										<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<a name="defineHOST_META_NS"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="const-title">
			<span class="const-name">HOST_META_NS</span> = 'http://host-meta.net/ns/1.0'
			(line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a65">65</a></span>)
		</span>
	</div>
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">The namespace identifier for an host metadata.</p>
	
		
</div>
<a name="defineXRD_NS"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="const-title">
			<span class="const-name">XRD_NS</span> = 'http://docs.oasis-open.org/ns/xri/xrd-1.0'
			(line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a60">60</a></span>)
		</span>
	</div>
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">The namespace identifier for an XRD document.</p>
	
		
</div>
		</div>
	</div>
	
	
	<a name="sec-functions"></a>	
	<div class="info-box">
		<div class="info-box-title">Functions</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
							<a href="#sec-classes">Classes</a>
				|										<a href="#sec-includes">Includes</a>
				|										<a href="#sec-constants">Constants</a>
				|									<span class="disabled">Functions</span>
		</div>
		<div class="info-box-body">	
			<a name="functiondiscovery_get_openid_services" id="functiondiscovery_get_openid_services"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">discovery_get_openid_services</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a311">311</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Obtains the OpenID services for particular identifier by scanning for link  elements in the returned document.</p>
<p class="description"><p>Note that this function does not use the YADIS protocol to scan for services.  To use the YADIS protocol, use <a href="../simpleid/_www---discovery.inc.html#functiondiscovery_get_services">discovery_get_services()</a>.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> an array of discovered services, or an empty array if no services  are found</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			discovery_get_openid_services
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$url</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$url</span><span class="var-description">: the URL</span>			</li>
				</ul>
		
	
</div>
<a name="functiondiscovery_get_services" id="functiondiscovery_get_services"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">discovery_get_services</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a89">89</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Obtains the services for particular identifier.</p>
<p class="description"><p>This function attempts to discover and obtain the XRDS document associated  with the identifier, parses the XRDS document and returns an array of  services.</p><p>If an XRDS document is not found, and $openid is set to true, this function  will also attempt to discover OpenID services by looking for link elements  with rel of openid.server or openid2.provider in the discovered HTML document.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> an array of discovered services, or an empty array if no services  are found</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			discovery_get_services
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$identifier</span>, [<span class="var-type">bool</span>&nbsp;<span class="var-name">$openid</span> = <span class="var-default">FALSE</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$identifier</span><span class="var-description">: the identifier</span>			</li>
					<li>
				<span class="var-type">bool</span>
				<span class="var-name">$openid</span><span class="var-description">: if true, performs additional discovery of OpenID services  by looking for link elements within the discovered document</span>			</li>
				</ul>
		
	
</div>
<a name="functiondiscovery_get_service_by_id" id="functiondiscovery_get_service_by_id"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">discovery_get_service_by_id</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a132">132</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Given an array of discovered services, obtains information on the service of  a specified ID.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the matching service, or NULL of no services  are found</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			discovery_get_service_by_id
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">$services</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$id</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$services</span><span class="var-description">: the discovered services</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$id</span><span class="var-description">: the XML ID of the service in the XRDS document</span>			</li>
				</ul>
		
	
</div>
<a name="functiondiscovery_get_service_by_type" id="functiondiscovery_get_service_by_type"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">discovery_get_service_by_type</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a112">112</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Given an array of discovered services, obtains information on services of  a particular type.</p>
	<ul class="tags">
				<li><span class="field">return:</span> an array of matching services, or an empty array of no services  match</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			discovery_get_service_by_type
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">$services</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$type</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$services</span><span class="var-description">: the discovered services</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$type</span><span class="var-description">: the URI of the type of service to obtain</span>			</li>
				</ul>
		
	
</div>
<a name="functiondiscovery_get_url" id="functiondiscovery_get_url"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">discovery_get_url</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a201">201</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Obtains a URL for an identifier.  If the identifier is a XRI, the XRI resolution  service is used to convert the identifier to a URL.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the URL</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			discovery_get_url
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$identifier</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$identifier</span><span class="var-description">: the identifier</span>			</li>
				</ul>
		
	
</div>
<a name="functiondiscovery_get_xrds" id="functiondiscovery_get_xrds"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">discovery_get_xrds</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a149">149</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Obtains a XRDS document at a particular URL.  Performs Yadis discovery if  the URL does not produce a XRDS document.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the contents of the XRDS document</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			discovery_get_xrds
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$url</span>, [<span class="var-type">bool</span>&nbsp;<span class="var-name">$check</span> = <span class="var-default">TRUE</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$retries</span> = <span class="var-default">5</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$url</span><span class="var-description">: the URL</span>			</li>
					<li>
				<span class="var-type">bool</span>
				<span class="var-name">$check</span><span class="var-description">: whether to check the content type of the response is  application/xrds+xml</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$retries</span><span class="var-description">: the number of tries to make</span>			</li>
				</ul>
		
	
</div>
<a name="functiondiscovery_normalize" id="functiondiscovery_normalize"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">discovery_normalize</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a178">178</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Normalises an identifier for discovery.</p>
<p class="description"><p>If the identifier begins with xri://, acct: or mailto:, this is stripped out.  If the identifier  does not begin with a valid URI scheme, http:// is assumed and added to the  identifier.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> the normalised identifier</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			discovery_normalize
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$identifier</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$identifier</span><span class="var-description">: the identifier to normalise</span>			</li>
				</ul>
		
	
</div>
<a name="functiondiscovery_parse_xrds" id="functiondiscovery_parse_xrds"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">discovery_parse_xrds</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a290">290</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Parses an XRDS document to return services available.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the parsed structure</li>
				<li><span class="field">see:</span> <a href="../simpleid/XRDSParser.html">XRDSParser</a></li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			discovery_parse_xrds
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$xrds</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$xrds</span><span class="var-description">: the XRDS document</span>			</li>
				</ul>
		
	
</div>
<a name="functiondiscovery_priority_sort" id="functiondiscovery_priority_sort"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">discovery_priority_sort</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a271">271</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Callback function to sort service and URI elements based on priorities  specified in the XRDS document.</p>
<p class="description"><p>The XRDS specification allows multiple instances of certain elements, such  as Service and URI.  The specification allows an attribute called priority  so that the document creator can specify the order the elements should be used.</p></p>
	
	<div class="method-signature">
		<span class="method-result">int</span>
		<span class="method-name">
			discovery_priority_sort
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">$a</span>, <span class="var-type">array</span>&nbsp;<span class="var-name">$b</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$a</span>			</li>
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$b</span>			</li>
				</ul>
		
	
</div>
<a name="functiondiscovery_uri_template" id="functiondiscovery_uri_template"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">discovery_uri_template</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwdiscovery.inc.html#a354">354</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Generates a URI from a URI template and another URI.</p>
<p class="description"><p>The URI must be able to be parsed by PHP's parse_url function.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> the generated URI</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			discovery_uri_template
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$template</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$uri</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$template</span><span class="var-description">: the URI template</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$uri</span><span class="var-description">: the input URI</span>			</li>
				</ul>
		
	
</div>
		</div>
	</div>
	
	<p class="notes" id="credit">
		Documentation generated on Mon, 06 Apr 2015 15:08:56 +1000 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.1</a>
	</p>
	</div></body>
</html>