<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs for page user.inc.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="file-name">/www/user.inc.php</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
											<a href="#sec-constants">Constants</a>
			|							<a href="#sec-variables">Variables</a>
			|							<a href="#sec-functions">Functions</a>
			</div>
	<div class="info-box-body">	
		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">User functions.</p>
	<ul class="tags">
				<li><span class="field">filesource:</span> <a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html">Source Code for this file</a></li>
			</ul>
		
			</div>
</div>
		

	
	<a name="sec-constants"></a>	
	<div class="info-box">
		<div class="info-box-title">Constants</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
									<span class="disabled">Constants</span>
			|							<a href="#sec-variables">Variables</a>
				|										<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<a name="defineSIMPLEID_LOGIN_NONCE_EXPIRES_IN"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="const-title">
			<span class="const-name">SIMPLEID_LOGIN_NONCE_EXPIRES_IN</span> = 3600
			(line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a40">40</a></span>)
		</span>
	</div>
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">The time the nonce used in the login process will last.</p>
	
		
</div>
<a name="defineSIMPLEID_USER_AUTOLOGIN_EXPIRES_IN"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="const-title">
			<span class="const-name">SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN</span> = 1209600
			(line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a46">46</a></span>)
		</span>
	</div>
	
	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">The time (in seconds) the auto login cookie will last.  This is currently  set as 2 weeks.</p>
	
		
</div>
		</div>
	</div>
	
	<a name="sec-variables"></a>	
	<div class="info-box">
		<div class="info-box-title">Variables</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
													<a href="#sec-constants">Constants</a>
				|						<span class="disabled">Variables</span>
			|							<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<a name="global$user" id="global$user"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="var-title">
			<span class="var-type">array</span>
			<span class="var-name">$user</span>
						(line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a54">54</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This variable holds data on the currently logged-in user.  If the user is  not logged in, this variable is NULL.</p>
	
		
</div>
		</div>
	</div>
	
	<a name="sec-functions"></a>	
	<div class="info-box">
		<div class="info-box-title">Functions</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
													<a href="#sec-constants">Constants</a>
				|										<a href="#sec-variables">Variables</a>
				|						<span class="disabled">Functions</span>
		</div>
		<div class="info-box-body">	
			<a name="functionhash_pbkdf2" id="functionhash_pbkdf2"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">hash_pbkdf2</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a1042">1042</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			hash_pbkdf2
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$algo</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$password</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$salt</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$iterations</span>, [<span class="var-type"></span>&nbsp;<span class="var-name">$length</span> = <span class="var-default">0</span>], [<span class="var-type"></span>&nbsp;<span class="var-name">$raw_output</span> = <span class="var-default">false</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type"></span>
				<span class="var-name">$algo</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$password</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$salt</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$iterations</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$length</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$raw_output</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_auto_login" id="functionuser_auto_login"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_auto_login</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a100">100</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Attempts to automatically login using credentials presented by the user agent.</p>
<p class="description"><p>The user agent may present various credentials as part of its request.  These  may include cookies and SSL client certificates.  This function calls the  <a href="../extensions/_extensions---hooks.php.html#functionhook_user_auto_login">hook_user_auto_login()</a> hook of enabled extensions to see if any  of these credentials can be used to automatically login a user.</p></p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_auto_login
		</span>
				()
			</div>

		
	
</div>
<a name="functionuser_cookieauth_create_cookie" id="functionuser_cookieauth_create_cookie"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_cookieauth_create_cookie</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a883">883</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Creates a auto login cookie.  The login cookie will be based on the  current log in user.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_cookieauth_create_cookie
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$id</span> = <span class="var-default">NULL</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$expires</span> = <span class="var-default">NULL</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$id</span><span class="var-description">: the ID of the series of auto login cookies,  Cookies  belonging to the same user and computer have the same ID.  If none is specified,  one will be generated</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$expires</span><span class="var-description">: the time at which the cookie will expire.  If none is specified  the time specified in <a href="../simpleid/_www---user.inc.php.html#defineSIMPLEID_USER_AUTOLOGIN_EXPIRES_IN">SIMPLEID_USER_AUTOLOGIN_EXPIRES_IN</a> will be  used</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_cookieauth_invalidate" id="functionuser_cookieauth_invalidate"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_cookieauth_invalidate</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a975">975</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Removes the auto login cookie from the user agent and the SimpleID  cache.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_cookieauth_invalidate
		</span>
				()
			</div>

		
	
</div>
<a name="functionuser_cookieauth_user_auto_login" id="functionuser_cookieauth_user_auto_login"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_cookieauth_user_auto_login</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a914">914</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Verifies a auto login cookie.  If valid, log in the user automatically.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_cookieauth_user_auto_login
		</span>
				()
			</div>

		
	
</div>
<a name="functionuser_header" id="functionuser_header"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_header</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a810">810</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Set up the user section in the header, showing the currently logged in user.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_header
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$state</span> = <span class="var-default">NULL</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$state</span><span class="var-description">: the SimpleID state to retain once the user has logged out,  if required.</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_hotp" id="functionuser_hotp"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_hotp</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a1029">1029</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Calculates a HMAC-Based One-Time Password (HOTP) based on RFC 4226.</p>
<p class="description"><p>This function returns an integer calculated from the HOTP algorithm.  The returned integer may need to be zero-padded to return a string  with the required number of digits</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> the one-time password</li>
				<li><span class="field">link:</span> <a href="http://tools.ietf.org/html/rfc4226">http://tools.ietf.org/html/rfc4226</a></li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">int</span>
		<span class="method-name">
			user_hotp
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$secret</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$data</span>, [<span class="var-type">string</span>&nbsp;<span class="var-name">$algorithm</span> = <span class="var-default">&#039;sha1&#039;</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$digits</span> = <span class="var-default">6</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$secret</span><span class="var-description">: the shared secret as a binary string</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$data</span><span class="var-description">: the counter value as a 64 bit in  big endian encoding</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$algorithm</span><span class="var-description">: the hashing algorithm as supported by  the hash_hmac() function</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$digits</span><span class="var-description">: the number of digits in the one-time password</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_init" id="functionuser_init"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_init</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a62">62</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Initialises the user system.  Loads data for the currently logged-in user,  if any.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_init
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$q</span> = <span class="var-default">NULL</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$q</span><span class="var-description">: the SimpleID command, if any</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_load" id="functionuser_load"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_load</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a123">123</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Loads user data for a specified user name.</p>
	<ul class="tags">
				<li><span class="field">return:</span> data for the specified user, or NULL if the user name does not  exist</li>
				<li><span class="field">see:</span> <a href="../simpleid/_www---user.inc.php.html#functionuser_load_from_identity">user_load_from_identity()</a></li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">mixed</span>
		<span class="method-name">
			user_load
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$uid</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$uid</span><span class="var-description">: the name of the user to load</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_load_from_identity" id="functionuser_load_from_identity"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_load_from_identity</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a149">149</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Loads user data for a specified OpenID Identity URI.</p>
	<ul class="tags">
				<li><span class="field">return:</span> data for the specified user, or NULL if the user name does not  exist</li>
				<li><span class="field">see:</span> <a href="../simpleid/_www---user.inc.php.html#functionuser_load">user_load()</a></li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">mixed</span>
		<span class="method-name">
			user_load_from_identity
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$identity</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$identity</span><span class="var-description">: the Identity URI of the user to load</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_login" id="functionuser_login"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_login</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a170">170</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Attempts to log in a user, using the user name and password specified in the  HTTP request.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_login
		</span>
				()
			</div>

		
	
</div>
<a name="functionuser_login_form" id="functionuser_login_form"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_login_form</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a477">477</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Displays a user login or a login verification form.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_login_form
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$destination</span> = <span class="var-default">&#039;&#039;</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$state</span> = <span class="var-default">NULL</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$fixed_uid</span> = <span class="var-default">NULL</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$mode</span> = <span class="var-default">&#039;credentials&#039;</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$destination</span><span class="var-description">: the SimpleID location to which the user is directed  if login is successful</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$state</span><span class="var-description">: the current SimpleID state, if required by the location</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$fixed_uid</span><span class="var-description">: the user name to be included in the login form; if NULL, the user  is asked to supply the user name.  If $mode is otp this cannot be null</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$mode</span><span class="var-description">: either credentials (login form) or otp (login verification  form)</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_logout" id="functionuser_logout"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_logout</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a426">426</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Attempts to log out a user and returns to the login form.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_logout
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$destination</span> = <span class="var-default">NULL</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$destination</span><span class="var-description">: the destination value to be included in the  login form</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_otp_page" id="functionuser_otp_page"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_otp_page</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a560">560</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Displays the page used to set up login verification using one-time  passwords.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_otp_page
		</span>
				()
			</div>

		
	
</div>
<a name="functionuser_passauth_user_verify_credentials" id="functionuser_passauth_user_verify_credentials"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_passauth_user_verify_credentials</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a838">838</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Verifies a set of credentials using the default user name-password authentication  method.</p>
	<ul class="tags">
				<li><span class="field">return:</span> whether the credentials supplied matches those for the specified  user</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			user_passauth_user_verify_credentials
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$uid</span>, <span class="var-type">array</span>&nbsp;<span class="var-name">$credentials</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$uid</span><span class="var-description">: the name of the user to verify</span>			</li>
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$credentials</span><span class="var-description">: the credentials supplied by the browser</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_ppid_page" id="functionuser_ppid_page"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_ppid_page</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a705">705</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns the public page for a private personal ID.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_ppid_page
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$ppid</span> = <span class="var-default">NULL</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$ppid</span><span class="var-description">: the PPID</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_public_page" id="functionuser_public_page"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_public_page</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a658">658</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns the user's public page.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_public_page
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$uid</span> = <span class="var-default">NULL</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$uid</span><span class="var-description">: the user ID</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_save" id="functionuser_save"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_save</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a161">161</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Stores user data for a specified user name.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_save
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">$user</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$user</span><span class="var-description">: the user to save</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_totp" id="functionuser_totp"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_totp</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a1006">1006</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Calculates a Time-Based One-Time Password (TOTP) based on RFC 6238.</p>
<p class="description"><p>This function returns an integer calculated from the TOTP algorithm.  The returned integer may need to be zero-padded to return a string  with the required number of digits</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> the one-time password</li>
				<li><span class="field">link:</span> <a href="http://tools.ietf.org/html/rfc6238">http://tools.ietf.org/html/rfc6238</a></li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">int</span>
		<span class="method-name">
			user_totp
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$secret</span>, [<span class="var-type">int</span>&nbsp;<span class="var-name">$time</span> = <span class="var-default">NULL</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$period</span> = <span class="var-default">30</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$drift</span> = <span class="var-default">0</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$algorithm</span> = <span class="var-default">&#039;sha1&#039;</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$digits</span> = <span class="var-default">6</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$secret</span><span class="var-description">: the shared secret as a binary string</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$time</span><span class="var-description">: the time to use in the HOTP algorithm.  If NULL, the  current time is used</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$period</span><span class="var-description">: the time step in seconds</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$drift</span><span class="var-description">: the number of time steps to be added to the time to  adjust for transmission delay</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$algorithm</span><span class="var-description">: the hashing algorithm as supported by  the hash_hmac() function</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$digits</span><span class="var-description">: the number of digits in the one-time password</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_verify_credentials" id="functionuser_verify_credentials"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_verify_credentials</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a320">320</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Verifies a set of credentials for a specified user.</p>
<p class="description"><p>A set of credentials comprises:</p><p><ul><li>A user name</li><li>Some kind of verifying information, such as a plaintext password, a hashed
   password (e.g. digest) or some other kind of identifying information.</li></ul>  The user name is passed to this function using the $uid parameter.  The user  name may or may not exist.  If the user name does not exist, this function  &lt;strong&gt;must&lt;/strong&gt; return false.</p><p>The credentials are supplied as an array using the $credentials parameter.  Typically this array will be a subset of the $_POST superglobal passed to the  <a href="../simpleid/_www---user.inc.php.html#functionuser_login">user_login()</a> function.  Thus it will generally contain the keys 'pass' and  'digest'.</p><p>This function calls the <a href="../extensions/_extensions---hooks.php.html#functionhook_user_verify_credentials">hook_user_verify_credentials()</a> hook to  check whether the credentials supplied matches the credentials  for the specified user in the store.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> whether the credentials supplied matches those for the specified  user</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			user_verify_credentials
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$uid</span>, <span class="var-type">array</span>&nbsp;<span class="var-name">$credentials</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$uid</span><span class="var-description">: the name of the user to verify</span>			</li>
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$credentials</span><span class="var-description">: the credentials supplied by the browser</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_verify_otp" id="functionuser_verify_otp"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">user_verify_otp</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a363">363</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Verifies a one time password (OTP) specified by the user.</p>
<p class="description"><p>This function compares an OTP supplied by a user with the OTP  calculated based on the current time and the parameters of the  algorithm.  The parameters, such as the secret key, are supplied  using in $params.  These parameters are typically stored for each  user in the user store.</p><p>To allow for clocks going out of sync, the current time will be  by a number (in time steps) specified in $params['drift'].  If  the OTP supplied by the user is accepted, $params['drift'] will  be also be updated with the latest difference.</p><p>To allow for network delay, the function will accepts OTPs which  is a number of time steps away from the OTP calculated from the  adjusted time.  The maximum number of time steps is specified in  the $max_drift parameter.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> whether the OTP supplied matches the OTP generated based on  the specified parameters, within the maximum drift</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			user_verify_otp
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">&$params</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$code</span>, [<span class="var-type">int</span>&nbsp;<span class="var-name">$max_drift</span> = <span class="var-default">1</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">&$params</span><span class="var-description">: the OTP parameters stored</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$code</span><span class="var-description">: the OTP supplied by the user</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$max_drift</span><span class="var-description">: the maximum drift allowed for network delay, in  time steps</span>			</li>
				</ul>
		
	
</div>
<a name="functionuser_xrds" id="functionuser_xrds"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">user_xrds</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a738">738</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns the user's public XRDS page.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			user_xrds
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$uid</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$uid</span><span class="var-description">: the user ID</span>			</li>
				</ul>
		
	
</div>
<a name="function_user_login" id="function_user_login"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">_user_login</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a395">395</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Sets the user specified by the parameter as the active user.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			_user_login
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">$login_user</span>, [<span class="var-type">bool</span>&nbsp;<span class="var-name">$auth_active</span> = <span class="var-default">false</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$login_user</span><span class="var-description">: the user to log in</span>			</li>
					<li>
				<span class="var-type">bool</span>
				<span class="var-name">$auth_active</span><span class="var-description">: whether the user has been actively authenticated  in this session</span>			</li>
				</ul>
		
	
</div>
<a name="function_user_logout" id="function_user_logout"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">_user_logout</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a451">451</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Logs out the user by deleting the relevant session information.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			_user_logout
		</span>
				()
			</div>

		
	
</div>
<a name="function_user_page_profile" id="function_user_page_profile"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">_user_page_profile</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwuser.inc.php.html#a775">775</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns a block containing OpenID Connect user information.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the OpenID Connect user information block</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			_user_page_profile
		</span>
				()
			</div>

		
	
</div>
		</div>
	</div>
	
	<p class="notes" id="credit">
		Documentation generated on Mon, 06 Apr 2015 15:24:45 +1000 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.1</a>
	</p>
	</div></body>
</html>