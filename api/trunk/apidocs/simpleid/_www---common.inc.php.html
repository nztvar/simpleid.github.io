<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs for page common.inc.php</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="file-name">/www/common.inc.php</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
													<a href="#sec-variables">Variables</a>
			|							<a href="#sec-functions">Functions</a>
			</div>
	<div class="info-box-body">	
		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Common functions used by SimpleID, and the implementation of extensions.</p>
	<ul class="tags">
				<li><span class="field">filesource:</span> <a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html">Source Code for this file</a></li>
			</ul>
		
			</div>
</div>
		

	
	
	<a name="sec-variables"></a>	
	<div class="info-box">
		<div class="info-box-title">Variables</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
												<span class="disabled">Variables</span>
			|							<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<a name="global$simpleid_extensions" id="global$simpleid_extensions"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="var-title">
			<span class="var-type">array</span>
			<span class="var-name">$simpleid_extensions</span>
						(line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a589">589</a></span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This variable holds an array of extensions specified by the user</p>
	<ul class="tags">
				<li><span class="field">see:</span> <a href="../simpleid/_www---config.php.dist.html#defineSIMPLEID_EXTENSIONS">SIMPLEID_EXTENSIONS</a></li>
			</ul>
	
		
</div>
		</div>
	</div>
	
	<a name="sec-functions"></a>	
	<div class="info-box">
		<div class="info-box-title">Functions</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
																<a href="#sec-variables">Variables</a>
				|						<span class="disabled">Functions</span>
		</div>
		<div class="info-box-body">	
			<a name="functioncheck_https" id="functioncheck_https"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">check_https</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a123">123</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Ensure the current connection with the user agent is secure with HTTPS.</p>
<p class="description"><p>This function uses <a href="../simpleid/_www---common.inc.php.html#functionis_https">is_https()</a> to determine whether the connection  is via HTTPS.  If it is, this function will return successfully.</p><p>If it is not, what happens next is determined by the following steps.</p><p><ol><li>If $allow_override is true and <a href="../simpleid/_www---config.php.dist.html#defineSIMPLEID_ALLOW_PLAINTEXT">SIMPLEID_ALLOW_PLAINTEXT</a> is also true,</li></ol> then the function will return successfully  2. Otherwise, then it will either redirect (if $action is  redirect) or return an error (if $action is error)</p></p>
	<ul class="tags">
				<li><span class="field">see:</span> <a href="../simpleid/_www---config.php.dist.html#defineSIMPLEID_ALLOW_PLAINTEXT">SIMPLEID_ALLOW_PLAINTEXT</a></li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			check_https
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$action</span> = <span class="var-default">&#039;redirect&#039;</span>], [<span class="var-type">boolean</span>&nbsp;<span class="var-name">$allow_override</span> = <span class="var-default">false</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$redirect_url</span> = <span class="var-default">null</span>], [<span class="var-type">boolean</span>&nbsp;<span class="var-name">$strict</span> = <span class="var-default">true</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$action</span><span class="var-description">: what to do if connection is not secure - either  'redirect' or 'error'</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$allow_override</span><span class="var-description">: whether SIMPLEID_ALLOW_PLAINTEXT is checked  to see if an unencrypted connection is allowed</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$redirect_url</span><span class="var-description">: if $action is redirect, what URL to redirect to.  If null, this will redirect to the same page (albeit with an HTTPS connection)</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$strict</span><span class="var-description">: whether HTTP Strict Transport Security is active</span>			</li>
				</ul>
		
	
</div>
<a name="functionextension_init" id="functionextension_init"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">extension_init</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a596">596</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Initialises the extension mechanism.  This function looks up the extensions  to load in the <a href="../simpleid/_www---config.php.dist.html#defineSIMPLEID_EXTENSIONS">SIMPLEID_EXTENSIONS</a> constants, loads them, then  calls the ns hook.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			extension_init
		</span>
				()
			</div>

		
	
</div>
<a name="functionextension_invoke" id="functionextension_invoke"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">extension_invoke</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a643">643</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Invokes a hook in a specified extension.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the return value from the hook</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">mixed</span>
		<span class="method-name">
			extension_invoke
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$extension</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$function</span>, <span class="var-type">mixed</span>&nbsp;<span class="var-name">$args</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$extension</span><span class="var-description">: the extension to call</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$function</span><span class="var-description">: the name of the hook to call</span>			</li>
					<li>
				<span class="var-type">mixed</span>
				<span class="var-name">$args</span><span class="var-description">: the arguments to the hook</span>			</li>
				</ul>
		
	
</div>
<a name="functionextension_invoke_all" id="functionextension_invoke_all"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">extension_invoke_all</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a613">613</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Invokes a hook in all the loaded extensions.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the return values from the hook</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			extension_invoke_all
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$function</span>, <span class="var-type">mixed</span>&nbsp;<span class="var-name">$args</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$function</span><span class="var-description">: the name of the hook to call</span>			</li>
					<li>
				<span class="var-type">mixed</span>
				<span class="var-name">$args</span><span class="var-description">: the arguments to the hook</span>			</li>
				</ul>
		
	
</div>
<a name="functionfix_http_request" id="functionfix_http_request"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">fix_http_request</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a162">162</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Fix PHP's handling of request data.  PHP changes dots in all request parameters  to underscores when creating the $_GET, $_POST and $_REQUEST arrays.</p>
<p class="description"><p>This function scans the original query string and POST parameters and fixes  them.</p></p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			fix_http_request
		</span>
				()
			</div>

		
	
</div>
<a name="functionget_base_path" id="functionget_base_path"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">get_base_path</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a395">395</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns the base URL path, relative to the current host, of the SimpleID  installation.</p>
<p class="description"><p>This is worked out from <a href="../simpleid/_www---config.php.dist.html#defineSIMPLEID_BASE_URL">SIMPLEID_BASE_URL</a>.  It will always contain  a trailing slash.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> the base URL path</li>
				<li><span class="field">see:</span> <a href="../simpleid/_www---config.php.dist.html#defineSIMPLEID_BASE_URL">SIMPLEID_BASE_URL</a></li>
				<li><span class="field">since:</span> 0.8</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			get_base_path
		</span>
				()
			</div>

		
	
</div>
<a name="functionget_extensions" id="functionget_extensions"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">get_extensions</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a659">659</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns an array of currently loaded extensions.</p>
	<ul class="tags">
				<li><span class="field">return:</span> a list of the names of the currently loaded extensions.</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			get_extensions
		</span>
				()
			</div>

		
	
</div>
<a name="functionget_form_token" id="functionget_form_token"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">get_form_token</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a528">528</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Obtains a form token given a form ID.</p>
<p class="description"><p>Form tokens are used in SimpleID forms to guard against cross-site forgery  attacks.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> a form token</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			get_form_token
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$id</span>, [<span class="var-type">bool</span>&nbsp;<span class="var-name">$bind_session</span> = <span class="var-default">TRUE</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$id</span><span class="var-description">: the form ID</span>			</li>
					<li>
				<span class="var-type">bool</span>
				<span class="var-name">$bind_session</span><span class="var-description">: whether to bind the form token to the current session</span>			</li>
				</ul>
		
	
</div>
<a name="functionget_request_uri" id="functionget_request_uri"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">get_request_uri</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a373">373</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Obtains the URI of the current request, given a base URI.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the request URI</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			get_request_uri
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$base</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$base</span><span class="var-description">: the base URI</span>			</li>
				</ul>
		
	
</div>
<a name="functionget_user_agent_id" id="functionget_user_agent_id"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">get_user_agent_id</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a246">246</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Assigns and returns a unique ID for the user agent (UAID).</p>
<p class="description"><p>A UAID uniquely identifies the user agent (e.g. browser) used to  make the HTTP request.  The UAID is stored in a long-dated  cookie.  Therefore, the UAID may be useful for security purposes.</p><p>This function will look for a cookie sent by the user agent with  the name returned by <a href="../simpleid/_www---common.inc.php.html#functionsimpleid_cookie_name">simpleid_cookie_name()</a> with a suffix  of uaid.  If the cookie does not exist, it will generate a  random UAID and return it to the user agent with a Set-Cookie  response header.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> the UAID</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			get_user_agent_id
		</span>
				()
			</div>

		
	
</div>
<a name="functionheader_response_code" id="functionheader_response_code"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">header_response_code</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a74">74</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Send a HTTP response code to the user agent.</p>
<p class="description"><p>The format of the HTTP response code depends on the way PHP is run.  When run as an Apache module, a properly formatted HTTP response  string is sent.  When run via CGI, the response code is sent via the  Status response header.</p></p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			header_response_code
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$code</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$code</span><span class="var-description">: the response code along</span>			</li>
				</ul>
		
	
</div>
<a name="functionindirect_fatal_error" id="functionindirect_fatal_error"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">indirect_fatal_error</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a54">54</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Displays a fatal error message and exits.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			indirect_fatal_error
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$error</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$error</span><span class="var-description">: the message to set</span>			</li>
				</ul>
		
	
</div>
<a name="functionis_base_https" id="functionis_base_https"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">is_base_https</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a418">418</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Determines whether the <a href="../simpleid/_www---config.php.dist.html#defineSIMPLEID_BASE_URL">SIMPLEID_BASE_URL</a> configuration option is a  HTTPS URL.</p>
	<ul class="tags">
				<li><span class="field">return:</span> if SIMPLEID_BASE_URL is a HTTPS URL</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">true</span>
		<span class="method-name">
			is_base_https
		</span>
				()
			</div>

		
	
</div>
<a name="functionis_https" id="functionis_https"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">is_https</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a94">94</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Determines whether the current connection with the user agent is via  HTTPS.</p>
<p class="description"><p>HTTPS is detected if one of the following occurs:</p><p><ul><li>$_SERVER['HTTPS'] is set to 'on' (Apache installations)</li><li>$_SERVER['HTTP_X_FORWARDED_PROTO'] is set to 'https' (reverse proxies)</li><li>$_SERVER['HTTP_FRONT_END_HTTPS'] is set to 'on'</li></ul></p></p>
	<ul class="tags">
				<li><span class="field">return:</span> true if the connection is via HTTPS</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			is_https
		</span>
				()
			</div>

		
	
</div>
<a name="functionnegotiate_content_type" id="functionnegotiate_content_type"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">negotiate_content_type</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a277">277</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Content type negotiation using the Accept Header.</p>
<p class="description"><p>Under HTTP, the user agent is able to negoatiate the content type returned with  the server using HTTP Accept header.  This header contains a comma-delimited  list of items (e.g. content types) which the user agent is able to  accept, ranked by a quality parameter.</p><p>This function takes the header from the user agent, compares it against the  content types which the server can provide, then returns the item which the highest  quality which the server can provide.</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> the negotiated content type, FALSE if $accept_header is NULL and  the user agent did not provide an Accept header, or NULL if the negotiation is  unsuccessful</li>
				<li><span class="field">since:</span> 0.8</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			negotiate_content_type
		</span>
					(<span class="var-type">array</span>&nbsp;<span class="var-name">$content_types</span>, [<span class="var-type">string</span>&nbsp;<span class="var-name">$accept_header</span> = <span class="var-default">NULL</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">array</span>
				<span class="var-name">$content_types</span><span class="var-description">: an array of content types which the server can  provide</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$accept_header</span><span class="var-description">: the header string provided by the user agent.  If NULL, this defaults to $_SERVER['HTTP_ACCEPT'] if available</span>			</li>
				</ul>
		
	
</div>
<a name="functionparse_http_query" id="functionparse_http_query"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">parse_http_query</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a215">215</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Parses a query string.</p>
	<ul class="tags">
				<li><span class="field">return:</span> an array containing the parsed key-value pairs</li>
				<li><span class="field">since:</span> 0.7</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">array</span>
		<span class="method-name">
			parse_http_query
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$query</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$query</span><span class="var-description">: the query string to parse</span>			</li>
				</ul>
		
	
</div>
<a name="functionpickle" id="functionpickle"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">pickle</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a334">334</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Serialises a variable for inclusion as a URL parameter.</p>
	<ul class="tags">
				<li><span class="field">return:</span> serialised data</li>
				<li><span class="field">see:</span> <a href="../simpleid/_www---common.inc.php.html#functionunpickle">unpickle()</a></li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			pickle
		</span>
					(<span class="var-type">mixed</span>&nbsp;<span class="var-name">$data</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">mixed</span>
				<span class="var-name">$data</span><span class="var-description">: the data to serialise</span>			</li>
				</ul>
		
	
</div>
<a name="functionsecure_compare" id="functionsecure_compare"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">secure_compare</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a358">358</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Compares two strings using the same time whether they're equal or not.</p>
<p class="description"><p>This function should be used to mitigate timing attacks when, for  example, comparing password hashes</p></p>
	<ul class="tags">
				<li><span class="field">return:</span> true if the two strings are equal</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			secure_compare
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$str1</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$str2</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$str1</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$str2</span>			</li>
				</ul>
		
	
</div>
<a name="functionset_message" id="functionset_message"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">set_message</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a42">42</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Sets a message to display to the user on the rendered SimpleID page.</p>
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			set_message
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$msg</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$msg</span><span class="var-description">: the message to set</span>			</li>
				</ul>
		
	
</div>
<a name="functionsimpleid_cookie_name" id="functionsimpleid_cookie_name"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">simpleid_cookie_name</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a509">509</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Returns a relatively unique cookie name based on a specified suffix and  SIMPLEID_BASE_URL.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the cookie name</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			simpleid_cookie_name
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$suffix</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$suffix</span><span class="var-description">: the cookie name suffix</span>			</li>
				</ul>
		
	
</div>
<a name="functionsimpleid_host_url" id="functionsimpleid_host_url"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">simpleid_host_url</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a479">479</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Obtains the URL of the host of the SimpleID's installation.  The host is worked  out based on SIMPLEID_BASE_URL</p>
	<ul class="tags">
				<li><span class="field">return:</span> the url</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			simpleid_host_url
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$secure</span> = <span class="var-default">null</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$secure</span><span class="var-description">: if $relative is false, either 'https' to force an HTTPS connection, 'http' to force  an unencrypted HTTP connection, or NULL to vary based on SIMPLEID_BASE_URL</span>			</li>
				</ul>
		
	
</div>
<a name="functionsimpleid_url" id="functionsimpleid_url"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">simpleid_url</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a434">434</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Obtains a SimpleID URL.  URLs produced by SimpleID should use this function.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the url</li>
				<li><span class="field">since:</span> 0.7</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">string</span>
		<span class="method-name">
			simpleid_url
		</span>
					([<span class="var-type">string</span>&nbsp;<span class="var-name">$q</span> = <span class="var-default">&#039;&#039;</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$params</span> = <span class="var-default">&#039;&#039;</span>], [<span class="var-type">bool</span>&nbsp;<span class="var-name">$relative</span> = <span class="var-default">false</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$secure</span> = <span class="var-default">null</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$q</span><span class="var-description">: the q parameter</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$params</span><span class="var-description">: a properly encoded query string</span>			</li>
					<li>
				<span class="var-type">bool</span>
				<span class="var-name">$relative</span><span class="var-description">: whether a relative URL should be returned</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$secure</span><span class="var-description">: if $relative is false, either 'https' to force an HTTPS connection, 'http' to force  an unencrypted HTTP connection, 'detect' to base on the current connection, or NULL to vary based on SIMPLEID_BASE_URL</span>			</li>
				</ul>
		
	
</div>
<a name="functionunpickle" id="functionunpickle"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">unpickle</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a345">345</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Deserialises data specified in a URL parameter as a variable.</p>
	<ul class="tags">
				<li><span class="field">return:</span> the deserialised data</li>
				<li><span class="field">see:</span> <a href="../simpleid/_www---common.inc.php.html#functionpickle">pickle()</a></li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">mixed</span>
		<span class="method-name">
			unpickle
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$pickle</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$pickle</span><span class="var-description">: the serialised data</span>			</li>
				</ul>
		
	
</div>
<a name="functionvalidate_form_token" id="functionvalidate_form_token"><!-- --></a>
<div class="oddrow">
	
	<div>
		<span class="method-title">validate_form_token</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a549">549</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Checks whether a form token is valid</p>
	<ul class="tags">
				<li><span class="field">return:</span> true if the form token is valid</li>
			</ul>
	
	<div class="method-signature">
		<span class="method-result">bool</span>
		<span class="method-name">
			validate_form_token
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$token</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$id</span>, [<span class="var-type">bool</span>&nbsp;<span class="var-name">$bind_session</span> = <span class="var-default">TRUE</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$token</span><span class="var-description">: the token returned by the user agent</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$id</span><span class="var-description">: the form ID</span>			</li>
					<li>
				<span class="var-type">bool</span>
				<span class="var-name">$bind_session</span><span class="var-description">: whether the token has been bound to the current session</span>			</li>
				</ul>
		
	
</div>
<a name="function_get_form_token" id="function_get_form_token"><!-- --></a>
<div class="evenrow">
	
	<div>
		<span class="method-title">_get_form_token</span> (line <span class="line-number"><a href="../__filesource/fsource_simpleid__wwwcommon.inc.php.html#a557">557</a></span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
	
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			_get_form_token
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">$site_token</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$id</span>, [<span class="var-type"></span>&nbsp;<span class="var-name">$bind_session</span> = <span class="var-default">TRUE</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type"></span>
				<span class="var-name">$site_token</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$id</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$bind_session</span>			</li>
				</ul>
		
	
</div>
		</div>
	</div>
	
	<p class="notes" id="credit">
		Documentation generated on Mon, 06 Apr 2015 15:24:38 +1000 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.1</a>
	</p>
	</div></body>
</html>